{
  "hash": "ee4c9cb626ee0cff941a050d2a8d2e8f",
  "result": {
    "markdown": "# Reshaping with **tidyr** {#sec-tidyrreshape}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyr)\n```\n:::\n\n\n## Long to wide with `pivot_wider()`\n\nUsing the same example seen in @sec-dfreshape:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_long <- data.frame(\n    Account_ID = c(8001, 8002, 8003, 8004, 8001, 8002, 8003, 8004, \n            8001, 8002, 8003, 8004, 8001, 8002, 8003, 8004), \n    Age = c(67.8017038366664, 42.9198507293701, 46.2301756642422, \n            39.665983196671, 67.8017038366664, 42.9198507293701, \n            46.2301756642422, 39.665983196671, 67.8017038366664, \n            42.9198507293701, 46.2301756642422, 39.665983196671, \n            67.8017038366664, 42.9198507293701, 46.2301756642422, \n            39.665983196671), \n    Admission = c(\"ED\", \"Planned\", \"Planned\", \"ED\", \"ED\", \"Planned\", \n            \"Planned\", \"ED\", \"ED\", \"Planned\", \"Planned\", \"ED\", \"ED\", \"Planned\", \n            \"Planned\", \"ED\"), \n    Lab_key = c(\"RBC\", \"RBC\", \"RBC\", \"RBC\", \"WBC\", \"WBC\", \"WBC\", \"WBC\", \n            \"Hematocrit\", \"Hematocrit\", \"Hematocrit\", \"Hematocrit\", \n            \"Hemoglobin\", \"Hemoglobin\", \"Hemoglobin\", \"Hemoglobin\"), \n    Lab_value = c(4.63449321082268, 3.34968550627897, 4.27037213597765, \n            4.93897736897793, 8374.22887757195, 7612.37380499927, \n            8759.27855519425, 6972.28096216548, 36.272693147236, \n            40.5716317809522, 39.9888624177955, 39.8786884058422, \n            12.6188444991545, 12.1739747363806, 15.1293426442183, \n            14.8885696185238)\n)\ndat_long\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Account_ID      Age Admission    Lab_key   Lab_value\n1        8001 67.80170        ED        RBC    4.634493\n2        8002 42.91985   Planned        RBC    3.349686\n3        8003 46.23018   Planned        RBC    4.270372\n4        8004 39.66598        ED        RBC    4.938977\n5        8001 67.80170        ED        WBC 8374.228878\n6        8002 42.91985   Planned        WBC 7612.373805\n7        8003 46.23018   Planned        WBC 8759.278555\n8        8004 39.66598        ED        WBC 6972.280962\n9        8001 67.80170        ED Hematocrit   36.272693\n10       8002 42.91985   Planned Hematocrit   40.571632\n11       8003 46.23018   Planned Hematocrit   39.988862\n12       8004 39.66598        ED Hematocrit   39.878688\n13       8001 67.80170        ED Hemoglobin   12.618844\n14       8002 42.91985   Planned Hemoglobin   12.173975\n15       8003 46.23018   Planned Hemoglobin   15.129343\n16       8004 39.66598        ED Hemoglobin   14.888570\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_long2wide <- pivot_wider(dat_long,\n                                id_cols = c(\"Account_ID\", \"Age\", \"Admission\"),\n                                names_from = \"Lab_key\",\n                                values_from = \"Lab_value\")\ndat_long2wide\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 7\n  Account_ID   Age Admission   RBC   WBC Hematocrit Hemoglobin\n       <dbl> <dbl> <chr>     <dbl> <dbl>      <dbl>      <dbl>\n1       8001  67.8 ED         4.63 8374.       36.3       12.6\n2       8002  42.9 Planned    3.35 7612.       40.6       12.2\n3       8003  46.2 Planned    4.27 8759.       40.0       15.1\n4       8004  39.7 ED         4.94 6972.       39.9       14.9\n```\n\n\n:::\n:::\n\n\n## Wide to long with `pivot_longer()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2022)\ndat_wide <- data.frame(Account_ID = c(8001, 8002, 8003, 8004),\n                       Age = rnorm(4, 57, 12),\n                       RBC = rnorm(4, 4.8, .5),\n                       WBC = rnorm(4, 7250, 1500),\n                       Hematocrit = rnorm(4, 40.2, 4),\n                       Hemoglobin = rnorm(4, 13.6, 1.5),\n                       Admission = sample(c(\"ED\", \"Planned\"), 4, replace = TRUE))\ndat_wide\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Account_ID      Age      RBC      WBC Hematocrit Hemoglobin Admission\n1       8001 67.80170 4.634493 8374.229   36.27269   12.61884        ED\n2       8002 42.91985 3.349686 7612.374   40.57163   12.17397   Planned\n3       8003 46.23018 4.270372 8759.279   39.98886   15.12934   Planned\n4       8004 39.66598 4.938977 6972.281   39.87869   14.88857   Planned\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_wide2long <- pivot_longer(dat_wide,\n                              cols = 3:6,\n                              names_to = \"Lab_key\",\n                              values_to = \"Lab_value\")\ndat_wide2long\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 16 × 5\n   Account_ID   Age Admission Lab_key    Lab_value\n        <dbl> <dbl> <chr>     <chr>          <dbl>\n 1       8001  67.8 ED        RBC             4.63\n 2       8001  67.8 ED        WBC          8374.  \n 3       8001  67.8 ED        Hematocrit     36.3 \n 4       8001  67.8 ED        Hemoglobin     12.6 \n 5       8002  42.9 Planned   RBC             3.35\n 6       8002  42.9 Planned   WBC          7612.  \n 7       8002  42.9 Planned   Hematocrit     40.6 \n 8       8002  42.9 Planned   Hemoglobin     12.2 \n 9       8003  46.2 Planned   RBC             4.27\n10       8003  46.2 Planned   WBC          8759.  \n11       8003  46.2 Planned   Hematocrit     40.0 \n12       8003  46.2 Planned   Hemoglobin     15.1 \n13       8004  39.7 Planned   RBC             4.94\n14       8004  39.7 Planned   WBC          6972.  \n15       8004  39.7 Planned   Hematocrit     39.9 \n16       8004  39.7 Planned   Hemoglobin     14.9 \n```\n\n\n:::\n:::\n\n\nNote that the \"Age\" and \"Admission\" columns were also reshaped correctly.\n\n## See also\n\n- [data.frame Reshape](#sec-dfreshape)\n- [data.table Reshape](#sec-dtreshape)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}