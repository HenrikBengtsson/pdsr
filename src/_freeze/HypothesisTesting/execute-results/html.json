{
  "hash": "252f8a475669dd913ef30e6f35134206",
  "result": {
    "markdown": "# Common Statistical Tests {#stats}\n\n\n::: {.cell}\n\n:::\n\n\nR includes a large number of functions to perform statistical hypothesis testing in the built-in `stats` package. This chapter includes a brief overview of the syntax for some common tests along with code to produce relevant plots of your data.\n\n## Correlation test\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-2_5cc96d1c59936deca40ad2dd731d9bcb'}\n\n```{.r .cell-code}\nset.seed(2020)\nx <- rnorm(100)\ny1 <- .1 * x + rnorm(100)\ny2 <- .3 * x + rnorm(100)\ny3 <- x + rnorm(100)/5\ny4 <- x^2 + rnorm(100)\n```\n:::\n\n\nScatterplot with linear fit:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-3_6f39a7999d8e3ce98ee23c20eb1b911f'}\n\n```{.r .cell-code}\nplot(x, y1,\n     col = \"#00000077\",\n     pch = 16, bty = \"none\")\nabline(lm(y1 ~ x), col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-3-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-4_1d8ee6767d12bb1ac1d3eff99d1c66bf'}\n\n```{.r .cell-code}\nplot(x, y2,\n     col = \"#00000077\",\n     pch = 16, bty = \"none\")\nabline(lm(y3 ~ x), col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-4-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-5_4fa735c5fe46fe3238bd42f6b02a53b8'}\n\n```{.r .cell-code}\nplot(x, y3,\n     col = \"#00000077\",\n     pch = 16, bty = \"none\")\nabline(lm(y3 ~ x), col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-5-1.png){width=480}\n:::\n:::\n\n\nScatterplot with a LOESS fit\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-6_6b66b897c661555b0b1eec42546e6c7e'}\n\n```{.r .cell-code}\nscatter.smooth(x, y4,\n               col = \"#00000077\",\n               pch = 16, bty = \"none\",\n               lpars = list(col = \"red\", lwd = 2))\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-6-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-7_893506daa7358831081d43ef0805569f'}\n\n```{.r .cell-code}\ncor.test(x, y1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  x and y1\nt = 0.66018, df = 98, p-value = 0.5107\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.1315978  0.2595659\nsample estimates:\n       cor \n0.06654026 \n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(x, y2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  x and y2\nt = 3.3854, df = 98, p-value = 0.001024\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.1357938 0.4889247\nsample estimates:\n      cor \n0.3235813 \n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(x, y3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  x and y3\nt = 53.689, df = 98, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9754180 0.9888352\nsample estimates:\n      cor \n0.9834225 \n```\n\n\n:::\n\n```{.r .cell-code}\ncor.test(x, y4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  x and y4\nt = 0.66339, df = 98, p-value = 0.5086\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.1312793  0.2598681\nsample estimates:\n       cor \n0.06686289 \n```\n\n\n:::\n:::\n\n## Student's t-test\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-8_d481d3533abd3afe893cd7ae160abf7b'}\n\n```{.r .cell-code}\nset.seed(2021)\nx0 <- rnorm(500)\nx1 <- rnorm(500, mean = .7)\n```\n:::\n\n\nFor all tests of differences in means, a boxplot is a good way to visualize. It accepts individual vectors, list or data.frame of vectors, or a formula to split a vector into groups by a factor.\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-9_ce8f6de10bdbc2261cc9a3c1d5aaf2a1'}\n\n```{.r .cell-code}\nboxplot(x0, x1,\n        col = \"#05204999\", border = \"#052049\",\n        boxwex = .3, names = c(\"x0\", \"x1\"))\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-9-1.png){width=480}\n:::\n:::\n\n\n### One sample t-test\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-10_05b0e15cfc0432a99004ea655d0baa31'}\n\n```{.r .cell-code}\nt.test(x0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  x0\nt = 0.093509, df = 499, p-value = 0.9255\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n -0.08596896  0.09456106\nsample estimates:\n  mean of x \n0.004296046 \n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-11_52c9e431ba5a4aaa69fc9200198754eb'}\n\n```{.r .cell-code}\nt.test(x1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  x1\nt = 15.935, df = 499, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.6322846 0.8101311\nsample estimates:\nmean of x \n0.7212079 \n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-12_a364807c3782d1865b1fad8f2207cd23'}\n\n```{.r .cell-code}\nboxplot(extra ~ group, sleep,\n        col = \"#05204999\", border = \"#052049\",\n        boxwex = .3)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-12-1.png){width=480}\n:::\n:::\n\n\n### Two-sample T-test\n\nBoth `t.test()` and `wilcox.test()` (below) either accept input as two vectors, \n`t.test(x, y)` or a formula of the form `t.test(x ~ group)`. The `paired` argument allows us to define a paired test. Since the `sleep` dataset includes measurements on the same cases in two conditions, we set `paired = TRUE`.\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-13_4017833e15b810ab8b5076b3cd4d8ba8'}\n\n```{.r .cell-code}\nt.test(extra ~ group, sleep, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  extra by group\nt = -4.0621, df = 9, p-value = 0.002833\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -2.4598858 -0.7001142\nsample estimates:\nmean difference \n          -1.58 \n```\n\n\n:::\n:::\n\n\n## Wilcoxon test\n\nData from R Documentation:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-14_0ba2b91a36b7768bbceb0058a4db8910'}\n\n```{.r .cell-code}\n## Hollander & Wolfe (1973), 29f.\n## Hamilton depression scale factor measurements in 9 patients with\n##  mixed anxiety and depression, taken at the first (x) and second\n##  (y) visit after initiation of a therapy (administration of a\n##  tranquilizer).\nx <- c(1.83,  0.50,  1.62,  2.48, 1.68, 1.88, 1.55, 3.06, 1.30)\ny <- c(0.878, 0.647, 0.598, 2.05, 1.06, 1.29, 1.06, 3.14, 1.29)\ndepression <- data.frame(first = x, second = y, change = y - x)\n```\n:::\n\n\n### One-sample Wilcoxon \n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-15_53b55dd96dceecbd111c44d28c15761b'}\n\n```{.r .cell-code}\nwilcox.test(depression$change)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  depression$change\nV = 5, p-value = 0.03906\nalternative hypothesis: true location is not equal to 0\n```\n\n\n:::\n:::\n\n\n### Two-sample Wilcoxon rank sum test (unpaired)\n\na.k.a Mann-Whitney U test a.k.a. Mann–Whitney–Wilcoxon (MWW) a.k.a. Wilcoxon–Mann–Whitney test\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-16_626b53152576a427e7a7aa0dfd76a11a'}\n\n```{.r .cell-code}\nx1 <- rnorm(500, 3, 1.5)\nx2 <- rnorm(500, 5, 2)\nwilcox.test(x1, x2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  x1 and x2\nW = 47594, p-value < 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n### Two-sample Wilcoxon signed-rank test (paired)\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-17_6776e2d382a4fa6a329626094daa198d'}\n\n```{.r .cell-code}\nwilcox.test(x, y, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  x and y\nV = 40, p-value = 0.03906\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-18_83382640cfd8391438e55c645b0c0a81'}\n\n```{.r .cell-code}\nwilcox.test(x, y, paired = TRUE, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  x and y\nV = 40, p-value = 0.01953\nalternative hypothesis: true location shift is greater than 0\n```\n\n\n:::\n:::\n\n\n## Analysis of Variance\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-19_f9568959fb603760f3ec90f5a040e954'}\n\n```{.r .cell-code}\nset.seed(20)\nBP_drug <- data.frame(Group = factor(rep(c(\"Placebo\", \"Drug_A\", \"Drug_B\"), each = 20),\n                                     levels = c(\"Placebo\", \"Drug_A\", \"Drug_B\")),\n                  SBP = c(rnorm(20, 140, 2.2), rnorm(20, 132, 2.1), rnorm(20, 138, 2)))\n```\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-20_e0f9de4afe478364d6be122654f6c5af'}\n\n```{.r .cell-code}\nboxplot(SBP ~ Group, BP_drug,\n        col = \"#05204999\", border = \"#052049\",\n        boxwex = .3)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-20-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-21_8397c0539c23dab820784586545bbb4f'}\n\n```{.r .cell-code}\nSBP_aov <- aov(SBP ~ Group, BP_drug)\nSBP_aov\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = SBP ~ Group, data = BP_drug)\n\nTerms:\n                   Group Residuals\nSum of Squares  728.2841  264.4843\nDeg. of Freedom        2        57\n\nResidual standard error: 2.154084\nEstimated effects may be unbalanced\n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-22_80c7afa712e146275782e2b194450d04'}\n\n```{.r .cell-code}\nsummary(SBP_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value Pr(>F)    \nGroup        2  728.3   364.1   78.48 <2e-16 ***\nResiduals   57  264.5     4.6                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nThe analysis of variance p-value is highly significant, but doesn't tell us which levels of the Group factor are significantly different from each other. The boxplot already gives us a pretty good idea, but we can follow up with a pairwise t-test \n\n### Pot-hoc pairwise t-tests\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-23_3da052639f96b82cec71ac251c38661c'}\n\n```{.r .cell-code}\npairwise.t.test(BP_drug$SBP, BP_drug$Group,\n                p.adj = \"holm\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  BP_drug$SBP and BP_drug$Group \n\n       Placebo Drug_A \nDrug_A 2.9e-16 -      \nDrug_B 0.065   1.7e-13\n\nP value adjustment method: holm \n```\n\n\n:::\n:::\n\n\nThe pairwise tests suggest that the difference between Placebo and Drug_A and between Drug_a and Drug_b are highly significant, while difference between Placebo and Drub_B is not (p = 0.065).\n\n## Kruskal-Wallis test\n\nKruskal-Wallis rank sum test of the null that the location parameters of the distribution of x are the same in each group (sample). The alternative is that they differ in at least one. It is a generalization of the Wilcoxon test to multiple independent samples.\n\nFrom the R Documentation:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-24_20180f967340fbaab086a1b6b72a4b63'}\n\n```{.r .cell-code}\n## Hollander & Wolfe (1973), 116.\n## Mucociliary efficiency from the rate of removal of dust in normal\n##  subjects, subjects with obstructive airway disease, and subjects\n##  with asbestosis.\nx <- c(2.9, 3.0, 2.5, 2.6, 3.2) # normal subjects\ny <- c(3.8, 2.7, 4.0, 2.4)      # with obstructive airway disease\nz <- c(2.8, 3.4, 3.7, 2.2, 2.0) # with asbestosis\nkruskal.test(list(x, y, z))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  list(x, y, z)\nKruskal-Wallis chi-squared = 0.77143, df = 2, p-value = 0.68\n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-25_77ac433f24264323755e42bc69e880c8'}\n\n```{.r .cell-code}\nboxplot(Ozone ~ Month, data = airquality,\n        col = \"#05204999\", border = \"#052049\",\n        boxwex = .3)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-25-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-26_a22e7abb8103d66a986581300a6f9bda'}\n\n```{.r .cell-code}\nkruskal.test(Ozone ~ Month, data = airquality)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  Ozone by Month\nKruskal-Wallis chi-squared = 29.267, df = 4, p-value = 6.901e-06\n```\n\n\n:::\n:::\n\n\n## Chi-squared Test\n\nPearson's chi-squared test for count data\n\nSome synthetic data:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-27_082052d48f52bff2bd319fb52e256537'}\n\n```{.r .cell-code}\nset.seed(2021)\nset.seed(2021)\nCohort <- factor(sample(c(\"Control\", \"Case\"), 500, TRUE),\n                 levels = c(\"Control\", \"Case\"))\nSex <- factor(\n  sapply(seq(Cohort), \\(i) sample(c(\"Male\", \"Female\"), 1,\n                                  prob = if (Cohort[i] == \"Control\") c(1, 1) else c(2, 1))))\ndat <- data.frame(Cohort, Sex)\nhead(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Cohort    Sex\n1 Control   Male\n2    Case   Male\n3    Case   Male\n4    Case Female\n5 Control Female\n6    Case   Male\n```\n\n\n:::\n:::\n\n\nYou can lot count data using a [mosaic plot](#mosaicplot), with either a table or formula input:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-28_51cc4a963105e8980c10eff05afbcfb6'}\n\n```{.r .cell-code}\nmosaicplot(table(Cohort, Sex),\n           color = c(\"orchid\", \"skyblue\"),\n           border = NA,\n           main = \"Cohort x Sex\")\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-28-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-29_6aabbda8135f9a1e8e8a1f47cb454ae4'}\n\n```{.r .cell-code}\nmosaicplot(Cohort ~ Sex, dat,\n           color = c(\"orchid\", \"skyblue\"),\n           border = NA,\n           main = \"Cohort x Sex\")\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-29-1.png){width=480}\n:::\n:::\n\n\n`chisq.test()` accepts either two factors, or a table:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-30_ee22fe82e0eb73b03d47c10726c90ef7'}\n\n```{.r .cell-code}\ncohort_sex_chisq <- chisq.test(dat$Cohort, dat$Sex)\ncohort_sex_chisq\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  dat$Cohort and dat$Sex\nX-squared = 18.015, df = 1, p-value = 2.192e-05\n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-31_218676f3609b6f525ff128a27922fcc4'}\n\n```{.r .cell-code}\ncohort_sex_chisq <- chisq.test(table(dat$Cohort, dat$Sex))\ncohort_sex_chisq\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(dat$Cohort, dat$Sex)\nX-squared = 18.015, df = 1, p-value = 2.192e-05\n```\n\n\n:::\n:::\n\n\n\n## Fisher's exact test\n\nFisher's exact test for count data\n\nWorking on the same data as above, `fisher.test()` also accepts either two factors or a table as input:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-32_9bee59908bdd9524cdff9746ff193370'}\n\n```{.r .cell-code}\ncohort_sex_fisher <- fisher.test(dat$Cohort, dat$Sex)\ncohort_sex_fisher\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  dat$Cohort and dat$Sex\np-value = 1.512e-05\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 1.516528 3.227691\nsample estimates:\nodds ratio \n  2.207866 \n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-33_ff310b7f902b76a05bb554e38f758b3e'}\n\n```{.r .cell-code}\ncohort_sex_fisher <- fisher.test(table(dat$Cohort, dat$Sex))\ncohort_sex_fisher\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  table(dat$Cohort, dat$Sex)\np-value = 1.512e-05\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 1.516528 3.227691\nsample estimates:\nodds ratio \n  2.207866 \n```\n\n\n:::\n:::\n\n\n## F Test to compare two variances\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-34_8abff55580cd7c1812609be84b823dfb'}\n\n```{.r .cell-code}\nx1 <- rnorm(500, sd = 1)\nx2 <- rnorm(400, sd = 1.5)\nvar.test(x1, x2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  x1 and x2\nF = 0.43354, num df = 499, denom df = 399, p-value < 2.2e-16\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3594600 0.5218539\nsample estimates:\nratio of variances \n         0.4335363 \n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-35_2e4bb6ab02a8175016ecc969fc949502'}\n\n```{.r .cell-code}\nboxplot(x1, x2,\n        col = \"#05204999\", border = \"#052049\",\n        boxwex = .3)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-35-1.png){width=480}\n:::\n:::\n\n\nFrom R Documentation:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-36_f9efb19425fb2522a2f6d4050ac6fdb8'}\n\n```{.r .cell-code}\nx <- rnorm(50, mean = 0, sd = 2)\ny <- rnorm(30, mean = 1, sd = 1)\nvar.test(x, y)                  # Do x and y have the same variance?\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  x and y\nF = 5.4776, num df = 49, denom df = 29, p-value = 5.817e-06\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  2.752059 10.305597\nsample estimates:\nratio of variances \n          5.477573 \n```\n\n\n:::\n\n```{.r .cell-code}\nvar.test(lm(x ~ 1), lm(y ~ 1))  # same\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  lm(x ~ 1) and lm(y ~ 1)\nF = 5.4776, num df = 49, denom df = 29, p-value = 5.817e-06\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  2.752059 10.305597\nsample estimates:\nratio of variances \n          5.477573 \n```\n\n\n:::\n:::\n\n\n## Bartlett test of homogeneity of variances\n\nPerforms Bartlett's test of the null that the variances in each of the groups (samples) are the same.\n\nFrom the R Documentation:\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-37_753f3eb18e63244a18f3753a6c94ef2e'}\n\n```{.r .cell-code}\nplot(count ~ spray, data = InsectSprays)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-37-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-38_7603bbdae1fa5d30210763e66c012ef9'}\n\n```{.r .cell-code}\nbartlett.test(InsectSprays$count, InsectSprays$spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  InsectSprays$count and InsectSprays$spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-39_54a27147997129fd7ff6e59cb12f1e33'}\n\n```{.r .cell-code}\nbartlett.test(count ~ spray, data = InsectSprays)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n\n\n:::\n:::\n\n\n## Fligner-Killeen test of homogeneity of variances\n\nPerforms a Fligner-Killeen (median) test of the \nnull that the variances in each of the groups (samples) are the same.\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-40_857752f2e9764cdc08589c18a994e023'}\n\n```{.r .cell-code}\nboxplot(count ~ spray, data = InsectSprays)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-40-1.png){width=480}\n:::\n\n```{.r .cell-code}\n# works the same if you do plot(count ~ spray, data = InsectSprays)\nfligner.test(InsectSprays$count, InsectSprays$spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFligner-Killeen test of homogeneity of variances\n\ndata:  InsectSprays$count and InsectSprays$spray\nFligner-Killeen:med chi-squared = 14.483, df = 5, p-value = 0.01282\n```\n\n\n:::\n\n```{.r .cell-code}\nfligner.test(count ~ spray, data = InsectSprays)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFligner-Killeen test of homogeneity of variances\n\ndata:  count by spray\nFligner-Killeen:med chi-squared = 14.483, df = 5, p-value = 0.01282\n```\n\n\n:::\n:::\n\n\n## Ansari-Bradley test\n\nPerforms the Ansari-Bradley two-sample test for a difference in scale parameters.\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-41_bd0508a45283ef8ea53ab6367cc89527'}\n\n```{.r .cell-code}\nramsay <- c(111, 107, 100, 99, 102, 106, 109, 108, 104, 99,\n            101, 96, 97, 102, 107, 113, 116, 113, 110, 98)\njung.parekh <- c(107, 108, 106, 98, 105, 103, 110, 105, 104,\n            100, 96, 108, 103, 104, 114, 114, 113, 108, 106, 99)\nansari.test(ramsay, jung.parekh)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in ansari.test.default(ramsay, jung.parekh): cannot compute exact\np-value with ties\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAnsari-Bradley test\n\ndata:  ramsay and jung.parekh\nAB = 185.5, p-value = 0.1815\nalternative hypothesis: true ratio of scales is not equal to 1\n```\n\n\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-42_2ae3173cbd9f6231c6253b4cd4bb04e8'}\n\n```{.r .cell-code}\nx <- rnorm(40, sd = 1.5)\ny <- rnorm(40, sd = 2.5)\nansari.test(x, y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAnsari-Bradley test\n\ndata:  x and y\nAB = 963, p-value = 0.005644\nalternative hypothesis: true ratio of scales is not equal to 1\n```\n\n\n:::\n:::\n\n\n## Mood two-sample test of scale\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-43_9b3809cf7449f02a11c37cef8a9d3688'}\n\n```{.r .cell-code}\nmood.test(x, y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMood two-sample test of scale\n\ndata:  x and y\nZ = -2.7363, p-value = 0.006213\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n## Kolmogorov-Smirnoff test\n\nPerform a one- or two-sample Kolmogorov-Smirnov test\nNull: x and y were drawn from the same continuous distribution.\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-44_b7afa7c3f868d74c9acd7fbb645a59eb'}\n\n```{.r .cell-code}\nx1 <- rnorm(200, 0, 1)\nx2 <- rnorm(200, -.5, 1.5)\nks.test(x1, x2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic two-sample Kolmogorov-Smirnov test\n\ndata:  x1 and x2\nD = 0.35, p-value = 4.579e-11\nalternative hypothesis: two-sided\n```\n\n\n:::\n:::\n\n\n## Shapiro-Wilk test of normality\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-45_f9feadc0cf7ff18a35a39c78d97fb11b'}\n\n```{.r .cell-code}\nset.seed(2021)\nx <- rnorm(2000)\ny1 <- .7 * x\ny2 <- x + x^3\n```\n:::\n\n\n### Q-Q Plot\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-46_81c59d9b3188c80d966dad3676cba614'}\n\n```{.r .cell-code}\nqqplot(rnorm(300), y1, pch = 16, col = \"#00000077\")\nqqline(y1, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-46-1.png){width=480}\n:::\n:::\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-47_510a0af9f156684700cfc135a36126d7'}\n\n```{.r .cell-code}\nqqplot(rnorm(300), y2, pch = 16, col = \"#00000077\")\nqqline(y2, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](HypothesisTesting_files/figure-html/unnamed-chunk-47-1.png){width=480}\n:::\n:::\n\n\n## Shapiro-Wilk test\n\n\n::: {.cell hash='HypothesisTesting_cache/html/unnamed-chunk-48_0e05b6b8e5c588acf94fd42406cb5f11'}\n\n```{.r .cell-code}\nshapiro.test(y1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  y1\nW = 0.99952, p-value = 0.9218\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(y2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  y2\nW = 0.72936, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Resources {#statsresources}\n\n- [Regression Methods in Biostatistics: Linear, Logistic, Survival, and Repeated Measures Models](https://regression.ucsf.edu/)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}