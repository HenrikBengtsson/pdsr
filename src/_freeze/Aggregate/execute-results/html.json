{
  "hash": "89d65bdb2a4d14921171ec32e08f419b",
  "result": {
    "markdown": "---\nexecute:\n  cache: true\nknitr:\n  opts_chunk: \n    comment: ''\n---\n\n# Aggregate {#sec-aggregate}\n\nR includes a number of commands to apply functions on splits of your data.\n`aggregate()` is a powerful tools to perform such \"group-by\" operations.\n<br><br>\nThe function accepts either:\n\n- a formula as the first argument and a data.frame passed to the `data` argument\n- an R objects (vector, data.frame, list) as the first argument and one or more factors passed to the `by` argument \n\nWe shall see how to perform each operation below with \neach approach. \n<br><br>\nThe formula interface might be easier to work with \ninteractively on the console. \nNote that while you *can* programmatically create a formula, it is easier to use\nvector inputs when calling `aggregate()` programmatically. \n<br><br>\nFor this example, we shall use the penguin data from the **palmerpenguins**\npackage:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-1_c0e6c98a77bd8a62d39ca6a49c9424de'}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nstr(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [344 Ã— 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...\n $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...\n $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...\n $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 NA 1 2 1 2 NA NA ...\n $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n```\n\n\n:::\n:::\n\n\nSee example below for 1 or multiple variables by 1 or more groups using either \nthe formula interface, or working directly on objects with `$`-indexing or \nusing `with()`:\n\n## Single variable by single grouping\n\nNote that the formula method defaults to na.action = na.omit\n\nUsing the formula interface:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-2_bf9db1a79476e9836b1ba9c9ebeca2be'}\n\n```{.r .cell-code}\naggregate(bill_length_mm ~ species,\n          penguins, mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    species bill_length_mm\n1    Adelie       38.79139\n2 Chinstrap       48.83382\n3    Gentoo       47.50488\n```\n\n\n:::\n:::\n\n\nUsing R objects directly:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-3_f451d74bb04b52fd6ccd6222f9ff19dd'}\n\n```{.r .cell-code}\naggregate(penguins$bill_length_mm,\n          by = list(penguins$species),\n          mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Group.1        x\n1    Adelie 38.79139\n2 Chinstrap 48.83382\n3    Gentoo 47.50488\n```\n\n\n:::\n:::\n\n\nNote that, unlike the formula notation, if your input is a vector which is\nunnamed, the output columns are also unnamed.\n\nIf instead of passing a vector, you pass a data.frame or list with one or more\nnamed elements, the output includes the names:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-4_40025221f5ffffe6ff7bcef8598b7c50'}\n\n```{.r .cell-code}\naggregate(penguins[\"bill_length_mm\"],\n          by = penguins[\"species\"],\n          mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    species bill_length_mm\n1    Adelie       38.79139\n2 Chinstrap       48.83382\n3    Gentoo       47.50488\n```\n\n\n:::\n:::\n\n\nBy creating a list instead of indexing the given data.frame also allows you to \nset custom names:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-5_2e6b994433ca6fb663b093ecc71875be'}\n\n```{.r .cell-code}\naggregate(list(`Bill length` = penguins$bill_length_mm),\n          by = list(Species = penguins$species),\n          mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Species Bill.length\n1    Adelie    38.79139\n2 Chinstrap    48.83382\n3    Gentoo    47.50488\n```\n\n\n:::\n:::\n\n\n## Multiple variables by single grouping\n\nFormula notation:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-6_88b05d2e12e2423e1b3675e104a3269e'}\n\n```{.r .cell-code}\naggregate(cbind(bill_length_mm, flipper_length_mm) ~ species,\n          penguins, mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    species bill_length_mm flipper_length_mm\n1    Adelie       38.79139          189.9536\n2 Chinstrap       48.83382          195.8235\n3    Gentoo       47.50488          217.1870\n```\n\n\n:::\n:::\n\n\nObjects:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-7_f24a10e04fd5b030530f784cb62e5d9b'}\n\n```{.r .cell-code}\naggregate(penguins[, c(\"bill_length_mm\", \"flipper_length_mm\")],\n          by = list(Species = penguins$species),\n          mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Species bill_length_mm flipper_length_mm\n1    Adelie       38.79139          189.9536\n2 Chinstrap       48.83382          195.8235\n3    Gentoo       47.50488          217.1870\n```\n\n\n:::\n:::\n\n\n## Single variable by multiple groups\n\nFormula notation:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-8_5404719472c24724cdb918b7e8a636e2'}\n\n```{.r .cell-code}\naggregate(bill_length_mm ~ species + island, penguins, mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    species    island bill_length_mm\n1    Adelie    Biscoe       38.97500\n2    Gentoo    Biscoe       47.50488\n3    Adelie     Dream       38.50179\n4 Chinstrap     Dream       48.83382\n5    Adelie Torgersen       38.95098\n```\n\n\n:::\n:::\n\n\nObjects:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-9_28ef5257c23d08eaa3f3bca09fe68e9d'}\n\n```{.r .cell-code}\naggregate(penguins[\"bill_length_mm\"],\n          by = list(Species = penguins$species, \n                    Island = penguins$island),\n          mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Species    Island bill_length_mm\n1    Adelie    Biscoe       38.97500\n2    Gentoo    Biscoe       47.50488\n3    Adelie     Dream       38.50179\n4 Chinstrap     Dream       48.83382\n5    Adelie Torgersen       38.95098\n```\n\n\n:::\n:::\n\n\n## Multiple variables by multiple groupings\n\nFormula notation:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-10_ff847b180a49d627386dd8db1e840be5'}\n\n```{.r .cell-code}\naggregate(cbind(bill_length_mm, flipper_length_mm) ~ species + island,\n          penguins, mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    species    island bill_length_mm flipper_length_mm\n1    Adelie    Biscoe       38.97500          188.7955\n2    Gentoo    Biscoe       47.50488          217.1870\n3    Adelie     Dream       38.50179          189.7321\n4 Chinstrap     Dream       48.83382          195.8235\n5    Adelie Torgersen       38.95098          191.1961\n```\n\n\n:::\n:::\n\n\nObjects:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-11_58a09877d1cccabbbbfaefa7df07a639'}\n\n```{.r .cell-code}\naggregate(penguins[, c(\"bill_length_mm\", \"flipper_length_mm\")],\n          by = list(Species = penguins$species, \n                    Island = penguins$island),\n          mean, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Species    Island bill_length_mm flipper_length_mm\n1    Adelie    Biscoe       38.97500          188.7955\n2    Gentoo    Biscoe       47.50488          217.1870\n3    Adelie     Dream       38.50179          189.7321\n4 Chinstrap     Dream       48.83382          195.8235\n5    Adelie Torgersen       38.95098          191.1961\n```\n\n\n:::\n:::\n\n\n## Using `with()`\n\nR allows you to use `with(data, expression)`, where data can be a data.frame,\nlist or environment, and within the expression refer to any elements of `data`\nby their name, without the need to index `data` each time.\n\nFor example, `with(df, expression)` means you can use the data.frame's\ncolumn names directly within the expression without the need to use `df$column`:\n\n\n::: {.cell hash='Aggregate_cache/html/unnamed-chunk-12_0c4affffe7f58757dcd8871bd969333d'}\n\n```{.r .cell-code}\nwith(penguins,\n     aggregate(list(`Bill length` = bill_length_mm),\n               by = list(Species = species),\n               mean, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Species Bill.length\n1    Adelie    38.79139\n2 Chinstrap    48.83382\n3    Gentoo    47.50488\n```\n\n\n:::\n:::\n\n\n## See also\n\n- [`tapply()`](LoopFunctions.qmd#tapply) for an alternative methods of applying function on \nsubsets of a single variable (probably faster).\n- For large datasets, it is recommended to use [data.table](DataTable.qmd) for \nfast group-by data summarization.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}