<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>PDSR - 38&nbsp; Base Graphics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Colors.html" rel="next">
<link href="./Graphics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-163213745-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><link rel="stylesheet" href="bootstrap.lambdamd.css">
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Base Graphics</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PDSR</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/egenn/pdsr/tree/master/src/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IDEs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">IDEs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Rlang.html" class="sidebar-item-text sidebar-link">The R language</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BasicOps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basic operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataTypes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Types &amp; Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataStructures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Indexing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Indexing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Factors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Factors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataIO.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Input/Output</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Vectorization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Vectorized Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ControlFlow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Control flow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Summarize.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summarizing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Aggregate.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Aggregate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LoopFunctions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Loop Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataFrames.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TableJoins.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Table joins</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reshaping.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Reshaping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataTrans.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Data Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MissingData.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Handling Missing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./StringOps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">String Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DateTime.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Date and Time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ClassesAndOOP.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Classes and Object-Oriented Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Profiling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Benchmarking &amp; Profiling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HypothesisTesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Common statistical tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GLM.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Introduction to the GLM</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./DataTable.html" class="sidebar-item-text sidebar-link">Data Table</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataTableI.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Efficient data analysis with <strong>data.table</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dtRefSem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Reference semantics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dtDataIO.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Data I/O</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dtMerge.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Merge tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dtReshape.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Reshape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataTableII.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Advanced usage examples</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Tidyverse.html" class="sidebar-item-text sidebar-link">Tidyverse</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dplyr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Introduction to dplyr</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Reshaping with <strong>tidyr</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lubridate.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Handling dates with <strong>lubridate</strong></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Graphics.html" class="sidebar-item-text sidebar-link">Graphics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BaseGraphics.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Base Graphics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Colors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Colors in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3xGraphics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">3x Graphics</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./IntroML.html" class="sidebar-item-text sidebar-link">Introduction to Machine Learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Resampling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Resampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Supervised.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Supervised Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Unsupervised.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./System.html" class="sidebar-item-text sidebar-link">System</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TerminalIntro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Introduction to the system shell</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GitHubIntro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Git &amp; GitHub: the basics</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Resources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CrashCourse.html" class="sidebar-item-text sidebar-link">Crash Course</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#scatter-plot" id="toc-scatter-plot" class="nav-link active" data-scroll-target="#scatter-plot"><span class="toc-section-number">38.1</span>  Scatter plot</a>
  <ul class="collapse">
<li><a href="#col-point-color" id="toc-col-point-color" class="nav-link" data-scroll-target="#col-point-color"><span class="toc-section-number">38.1.1</span>  <strong><code>col</code></strong>: point color</a></li>
  <li><a href="#bty-box-type" id="toc-bty-box-type" class="nav-link" data-scroll-target="#bty-box-type"><span class="toc-section-number">38.1.2</span>  <strong><code>bty</code></strong>: box type</a></li>
  <li><a href="#pch-point-character" id="toc-pch-point-character" class="nav-link" data-scroll-target="#pch-point-character"><span class="toc-section-number">38.1.3</span>  <strong><code>pch</code></strong>: point character</a></li>
  <li><a href="#grid" id="toc-grid" class="nav-link" data-scroll-target="#grid"><span class="toc-section-number">38.1.4</span>  grid</a></li>
  <li><a href="#main-xlab-ylab-title-and-axes-labels" id="toc-main-xlab-ylab-title-and-axes-labels" class="nav-link" data-scroll-target="#main-xlab-ylab-title-and-axes-labels"><span class="toc-section-number">38.1.5</span>  <strong><code>main</code></strong>, <strong><code>xlab</code></strong>, <strong><code>ylab</code></strong>: Title and axes labels</a></li>
  </ul>
</li>
  <li>
<a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"><span class="toc-section-number">38.2</span>  Histogram</a>
  <ul class="collapse">
<li><a href="#col-bar-color" id="toc-col-bar-color" class="nav-link" data-scroll-target="#col-bar-color"><span class="toc-section-number">38.2.1</span>  <strong><code>col</code></strong>: bar color</a></li>
  <li><a href="#border-border-color" id="toc-border-border-color" class="nav-link" data-scroll-target="#border-border-color"><span class="toc-section-number">38.2.2</span>  <strong><code>border</code></strong>: border color</a></li>
  <li><a href="#breaks-number-or-value-of-breakpoints" id="toc-breaks-number-or-value-of-breakpoints" class="nav-link" data-scroll-target="#breaks-number-or-value-of-breakpoints"><span class="toc-section-number">38.2.3</span>  <code>breaks</code>: number or value of breakpoints</a></li>
  </ul>
</li>
  <li><a href="#density-plot" id="toc-density-plot" class="nav-link" data-scroll-target="#density-plot"><span class="toc-section-number">38.3</span>  Density plot</a></li>
  <li>
<a href="#barplot" id="toc-barplot" class="nav-link" data-scroll-target="#barplot"><span class="toc-section-number">38.4</span>  Barplot</a>
  <ul class="collapse">
<li><a href="#single-vector" id="toc-single-vector" class="nav-link" data-scroll-target="#single-vector"><span class="toc-section-number">38.4.1</span>  Single vector</a></li>
  <li><a href="#matrix" id="toc-matrix" class="nav-link" data-scroll-target="#matrix"><span class="toc-section-number">38.4.2</span>  Matrix</a></li>
  <li><a href="#formula-interface" id="toc-formula-interface" class="nav-link" data-scroll-target="#formula-interface"><span class="toc-section-number">38.4.3</span>  Formula interface</a></li>
  </ul>
</li>
  <li>
<a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="toc-section-number">38.5</span>  Boxplot</a>
  <ul class="collapse">
<li><a href="#single-vector-1" id="toc-single-vector-1" class="nav-link" data-scroll-target="#single-vector-1"><span class="toc-section-number">38.5.1</span>  Single vector</a></li>
  <li><a href="#anatomy-of-a-boxplot" id="toc-anatomy-of-a-boxplot" class="nav-link" data-scroll-target="#anatomy-of-a-boxplot"><span class="toc-section-number">38.5.2</span>  Anatomy of a boxplot</a></li>
  <li><a href="#multiple-vectors" id="toc-multiple-vectors" class="nav-link" data-scroll-target="#multiple-vectors"><span class="toc-section-number">38.5.3</span>  Multiple vectors</a></li>
  <li><a href="#list" id="toc-list" class="nav-link" data-scroll-target="#list"><span class="toc-section-number">38.5.4</span>  List</a></li>
  <li><a href="#matrix-1" id="toc-matrix-1" class="nav-link" data-scroll-target="#matrix-1"><span class="toc-section-number">38.5.5</span>  Matrix</a></li>
  <li><a href="#formula-interface-1" id="toc-formula-interface-1" class="nav-link" data-scroll-target="#formula-interface-1"><span class="toc-section-number">38.5.6</span>  Formula interface</a></li>
  <li><a href="#names-group-labels" id="toc-names-group-labels" class="nav-link" data-scroll-target="#names-group-labels"><span class="toc-section-number">38.5.7</span>  <strong><code>names</code></strong>: group labels</a></li>
  </ul>
</li>
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap"><span class="toc-section-number">38.6</span>  Heatmap</a></li>
  <li><a href="#mosaicplot" id="toc-mosaicplot" class="nav-link" data-scroll-target="#mosaicplot"><span class="toc-section-number">38.7</span>  Mosaic plot</a></li>
  <li>
<a href="#graphical-parameters" id="toc-graphical-parameters" class="nav-link" data-scroll-target="#graphical-parameters"><span class="toc-section-number">38.8</span>  Graphical parameters</a>
  <ul class="collapse">
<li><a href="#save-and-reload-graphical-parameters" id="toc-save-and-reload-graphical-parameters" class="nav-link" data-scroll-target="#save-and-reload-graphical-parameters"><span class="toc-section-number">38.8.1</span>  Save and reload graphical parameters</a></li>
  </ul>
</li>
  <li><a href="#multipanel-plots" id="toc-multipanel-plots" class="nav-link" data-scroll-target="#multipanel-plots"><span class="toc-section-number">38.9</span>  Multipanel plots</a></li>
  <li><a href="#saveplots" id="toc-saveplots" class="nav-link" data-scroll-target="#saveplots"><span class="toc-section-number">38.10</span>  Saving plots to file</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/egenn/pdsr/edit/master/src/BaseGraphics.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/egenn/pdsr/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-basegraphics" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Base Graphics</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="cell">

</div>
<p>This chapter is an introduction to what is known as base graphics, which is provided by the built-in <strong>graphics</strong> package. This includes a large number of functions to create plots, add graphical elements to existing plots, and control plotting parameters. Default argument values or base graphics functions produce minimalist-looking plots, but they can be customized extensively. In this chapter we shall begin with these simple plots and demonstrate some of the more common/useful ways to customize them. The extensive documentation of base graphics functions details all the ways the can be further customized. <br><br> Some of the most common and important types of plots can be built with the following functions:</p>
<table class="table">
<thead><tr class="header">
<th style="text-align: right;">Plot type</th>
<th style="text-align: left;">Command</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Scatterplot</td>
<td style="text-align: left;"><code>plot(x, y)</code></td>
</tr>
<tr class="even">
<td style="text-align: right;">Line plot</td>
<td style="text-align: left;"><code>plot(x, y, type = 'l')</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;">Histogram</td>
<td style="text-align: left;"><code>hist(x)</code></td>
</tr>
<tr class="even">
<td style="text-align: right;">Density plot</td>
<td style="text-align: left;"><code>plot(density(x))</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;">Barplot</td>
<td style="text-align: left;"><code>barplot(x)</code></td>
</tr>
<tr class="even">
<td style="text-align: right;">Boxplot</td>
<td style="text-align: left;"><code>boxplot(x)</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;">Heatmap</td>
<td style="text-align: left;"><code>heatmap(x)</code></td>
</tr>
<tr class="even">
<td style="text-align: right;">Mosaic plot</td>
<td style="text-align: left;"><code>mosaicplot(table(x))</code></td>
</tr>
</tbody>
</table>
<p>R documentation for each of the above commands provides extensive coverage of graphical parameters. <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> gives the main documentation file for a long list of graphical parameters. These can be set either with the <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> command <em>before</em> using any plotting command.</p>
<div class="cell" type="rmdcaution">
<div class="rmdcaution">
<p>
If you your plots are missing all text and you get warnings that fonts were not found, it may be that the current R installation cannot find some of the fonts installed on your system.
</p>
<p>
One possible workaround is to download a font from Google fonts, a good one would be <a href="https://fonts.google.com/specimen/Inter">Inter</a>, install it on your system (clicking on the file will usually ask you if you want to install it), and then setting it as the default in R by running:
</p>
<p>
<code>par(family = “Inter”)</code>
</p>
<p>
Alternatively, you can install the <strong>sysfonts</strong> packages and have it get the font(s) from Google:
</p>
<p>
<code>install.packages(systemfonts) sysfonts::font_add_google(“Inter”) par(family = “Inter”)</code>
</p>
</div>
</div>
<p>Let’s create some synthetic data:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">y_true</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span><span class="op">*</span><span class="fl">1.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="scatter-plot" class="level2" data-number="38.1"><h2 data-number="38.1" class="anchored" data-anchor-id="scatter-plot">
<span class="header-section-number">38.1</span> Scatter plot</h2>
<p>Input: 2 <strong>numeric vectors</strong></p>
<p>A 2D scatterplot displays points using two numeric vectors as X and Y coordinates.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<section id="col-point-color" class="level3" data-number="38.1.1"><h3 data-number="38.1.1" class="anchored" data-anchor-id="col-point-color">
<span class="header-section-number">38.1.1</span> <strong><code>col</code></strong>: point color</h3>
<p>See <a href="Colors.html">Colors in R</a> to learn about the different ways to define colors in R.</p>
<p>Some common ways include:</p>
<ul>
<li>By name, using one of 657 names given by <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code>, e.g.&nbsp;“magenta”, “navy”, “cyan”</li>
<li>By RGB code in hexadecimal format, e.g.&nbsp;“#ff0000” is red</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="bty-box-type" class="level3" data-number="38.1.2"><h3 data-number="38.1.2" class="anchored" data-anchor-id="bty-box-type">
<span class="header-section-number">38.1.2</span> <strong><code>bty</code></strong>: box type</h3>
<p>There are 7 bty options: “o” “l”, “7”, “c”, “u”, or “]” and “none”. They produce a box that resembles the corresponding symbol. “none” draws no box but allows the axes to show:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="pch-point-character" class="level3" data-number="38.1.3"><h3 data-number="38.1.3" class="anchored" data-anchor-id="pch-point-character">
<span class="header-section-number">38.1.3</span> <strong><code>pch</code></strong>: point character</h3>
<p>The default point character is a circle as seen above. This helps visualize overlapping points (especially for devices that do not support transparency).</p>
<p>There are 25 point characters, designated by integers 1 through 25.</p>
<p>Here’s a preview of all 25 <code>pch</code> options. <code>pch</code> types 21 through 25 can be filled by a color specified by <code>bg</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">25</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, bg <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Let’s use a solid disc:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We cannot tell how many points are overlapping in the middle and therefore it’s a good idea to make the points a little transparent.</p>
<p>There are different ways to add transparency (see <a href="#colors">Colors</a>). The easiest way is probably to use <code><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor()</a></code>. In the context of colors, <code>alpha</code> refers to transparency: <code>a = 1</code> is opaque and <code>a = 0</code> is completely transparent (therefore use a value greater than 0).</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,</span>
<span>     bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"skyblue"</span>, alpha.f <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="grid" class="level3" data-number="38.1.4"><h3 data-number="38.1.4" class="anchored" data-anchor-id="grid">
<span class="header-section-number">38.1.4</span> grid</h3>
<p>We can add a grid behind the plot area using the <code>panel.first</code> argument, which accepts a graphical expression (a function that draws something), which will be evaluated before plotting the points on the graph (therefore appears behind the points).</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,</span>
<span>     bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"skyblue"</span>, alpha.f <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>     panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">'gray90'</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="main-xlab-ylab-title-and-axes-labels" class="level3" data-number="38.1.5"><h3 data-number="38.1.5" class="anchored" data-anchor-id="main-xlab-ylab-title-and-axes-labels">
<span class="header-section-number">38.1.5</span> <strong><code>main</code></strong>, <strong><code>xlab</code></strong>, <strong><code>ylab</code></strong>: Title and axes labels</h3>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,</span>
<span>     bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"skyblue"</span>, alpha.f <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>     panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">'gray90'</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"y vs. x"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Variable x (xunits)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Variable y (yunits)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Note that depending on where you intend to display the plot, you may leave the title blank and instead place it in the figure caption along with an explanation of the data (e.g.&nbsp;in a journal article).</p>
</section></section><section id="histogram" class="level2" data-number="38.2"><h2 data-number="38.2" class="anchored" data-anchor-id="histogram">
<span class="header-section-number">38.2</span> Histogram</h2>
<p>Input: <strong>numeric vector</strong></p>
<p>A histogram displays an approximation of the distribution of a numeric vector. First the data is binned and then the number of elements that falls in each bin is counted. The histogram plot draws bars for each bin whose heights corresponds to the count of elements in the corresponding interval.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<section id="col-bar-color" class="level3" data-number="38.2.1"><h3 data-number="38.2.1" class="anchored" data-anchor-id="col-bar-color">
<span class="header-section-number">38.2.1</span> <strong><code>col</code></strong>: bar color</h3>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"slategrey"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="border-border-color" class="level3" data-number="38.2.2"><h3 data-number="38.2.2" class="anchored" data-anchor-id="border-border-color">
<span class="header-section-number">38.2.2</span> <strong><code>border</code></strong>: border color</h3>
<p>Setting border color to the same as the background gives a clean look:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"slategrey"</span>, border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="breaks-number-or-value-of-breakpoints" class="level3" data-number="38.2.3"><h3 data-number="38.2.3" class="anchored" data-anchor-id="breaks-number-or-value-of-breakpoints">
<span class="header-section-number">38.2.3</span> <code>breaks</code>: number or value of breakpoints</h3>
<p>The <code>breaks</code> argument can be used to define the breakpoints to use for the binning of the values of the input to <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code>. See the documentation in <code><a href="https://rdrr.io/r/graphics/hist.html">?hist</a></code> for the full range of options. An easy way to control the number of bins is to pass an integer to the <code>breaks</code> argument. Depending on the length of x and its distribution, it may or may not be possible to use the exact number requested, but the closest possible number will be automatically chosen.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"slategrey"</span>, border <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section></section><section id="density-plot" class="level2" data-number="38.3"><h2 data-number="38.3" class="anchored" data-anchor-id="density-plot">
<span class="header-section-number">38.3</span> Density plot</h2>
<p>Input: numeric vector</p>
<p>A density plot is a different way to display an approximation of the distribution of a numeric vector. The <code><a href="https://rdrr.io/r/stats/density.html">density()</a></code> function estimates the density of x and can be passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> directly:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>You can use <code>main = NA</code> or <code>main = ""</code> to suppress printing a title.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     main <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="barplot" class="level2" data-number="38.4"><h2 data-number="38.4" class="anchored" data-anchor-id="barplot">
<span class="header-section-number">38.4</span> Barplot</h2>
<p>Input: <strong>vector</strong> or <strong>matrix</strong></p>
<p>Let’s look at the VADeaths built-in dataset which describes death rater per 1000 population per year broken down by age range and population group.</p>
<section id="single-vector" class="level3" data-number="38.4.1"><h3 data-number="38.4.1" class="anchored" data-anchor-id="single-vector">
<span class="header-section-number">38.4.1</span> Single vector</h3>
<p>We can plot a single column or row. Note how R automatically gets the corresponding dimension names. For this example we use the builtin <code>VADeaths</code> dataset, which is a matrix.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<section id="col-and-border-bar-fill-and-border-color" class="level4" data-number="38.4.1.1"><h4 data-number="38.4.1.1" class="anchored" data-anchor-id="col-and-border-bar-fill-and-border-color">
<span class="header-section-number">38.4.1.1</span> <strong><code>col</code></strong> and <strong><code>border</code></strong>: bar fill and border color</h4>
<p>As in most plotting functions, color is controlled by the <strong><code>col</code></strong> argument. <strong><code>border</code></strong> can be set to any color separately, or to <code>NA</code> to omit, which gives a clean look:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"aquamarine3"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section></section><section id="matrix" class="level3" data-number="38.4.2"><h3 data-number="38.4.2" class="anchored" data-anchor-id="matrix">
<span class="header-section-number">38.4.2</span> Matrix</h3>
<p>We can draw barplots of multiple columns at the same time by passing a matrix input. The grouping on the x-axis is based on the columns. By default, data from different rows is stacked. The argument <code>legend.text</code> can be used to add a legend with the row labels:</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>, legend.text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Alternatively, we can draw groups of bars beside each other with the argument <code>beside = TRUE</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>, beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="cn">TRUE</span>, args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To use custom colors, we pass a vector of length equal to the number of bars within each group. These will get recycled across groups, giving a consistent color coding.</p>
<p>Here, we use the <code><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor()</a></code> function again to produce 5 shades of navy.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"navy"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>,</span>
<span>        col <span class="op">=</span> <span class="va">col</span>,</span>
<span>        border <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="cn">TRUE</span>, args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="formula-interface" class="level3" data-number="38.4.3"><h3 data-number="38.4.3" class="anchored" data-anchor-id="formula-interface">
<span class="header-section-number">38.4.3</span> Formula interface</h3>
</section></section><section id="boxplot" class="level2" data-number="38.5"><h2 data-number="38.5" class="anchored" data-anchor-id="boxplot">
<span class="header-section-number">38.5</span> Boxplot</h2>
<p>Input: One or more <strong>vectors</strong> of any length</p>
<p>A boxplot is another way to visualize the distribution of one or more vectors. Each vector does not need to be of the same length. For example if you are plotting lab results of a patient and control group, they do not have to contain the same number of individuals.</p>
<p><code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> makes it easy to plot your data from different objects. It can accept:</p>
<ul>
<li>individual vectors</li>
<li>columns of a matrix, columns/elements of a data.frame, elements of a list</li>
<li>formula interface of the form <code>variable ~ factor</code>
</li>
</ul>
<section id="single-vector-1" class="level3" data-number="38.5.1"><h3 data-number="38.5.1" class="anchored" data-anchor-id="single-vector-1">
<span class="header-section-number">38.5.1</span> Single vector</h3>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="anatomy-of-a-boxplot" class="level3" data-number="38.5.2"><h3 data-number="38.5.2" class="anchored" data-anchor-id="anatomy-of-a-boxplot">
<span class="header-section-number">38.5.2</span> Anatomy of a boxplot</h3>
<p>A boxplot shows:</p>
<ul>
<li>the median</li>
<li>first and third quartiles</li>
<li>outliers (defined as <code>x &lt; Q1 - 1.5 * IQR | x &gt; Q3 + 1.5 * IQR</code>)</li>
<li>range after excluding outliers</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="BaseGraphics_files/figure-html/boxanat-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Boxplot anatomy</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Some synthetic data:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, gamma <span class="op">=</span> <span class="va">gamma</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="multiple-vectors" class="level3" data-number="38.5.3"><h3 data-number="38.5.3" class="anchored" data-anchor-id="multiple-vectors">
<span class="header-section-number">38.5.3</span> Multiple vectors</h3>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="list" class="level3" data-number="38.5.4"><h3 data-number="38.5.4" class="anchored" data-anchor-id="list">
<span class="header-section-number">38.5.4</span> List</h3>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">dl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="matrix-1" class="level3" data-number="38.5.5"><h3 data-number="38.5.5" class="anchored" data-anchor-id="matrix-1">
<span class="header-section-number">38.5.5</span> Matrix</h3>
<p>Passing a matrix to <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> draws one boxplot per column:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="formula-interface-1" class="level3" data-number="38.5.6"><h3 data-number="38.5.6" class="anchored" data-anchor-id="formula-interface-1">
<span class="header-section-number">38.5.6</span> Formula interface</h3>
<p>The formula interface can be used to group any vector by a factor of the same length.</p>
<p>Let’s use the built-in <code>sleep</code> dataset which shows the effect of two different drugs in increasing hours of sleep compared to a control group.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">sleep</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>The <strong><code>col</code></strong> and <strong><code>border</code></strong> arguments work as expected. Here we define two custom colors using their hexadecimal RGB code and use the solid version for the border and a 50% transparent version for the fill. Note that we do not need two separate colors to produce an unambiguous plot since they are clearly labeled in the y-axis. It is often considered desirable/preferred to use the minimum number of different colors that is necessary. (Color coding like the following could be useful if for example data from the two groups were used on a different plot, like a scatterplot, in a multi-panel figure).</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">border</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#18A3AC"</span>, <span class="st">"#F48024"</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"#18A3AC"</span>, <span class="fl">.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"#F48024"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">sleep</span>,</span>
<span>        col <span class="op">=</span> <span class="va">col</span>, border <span class="op">=</span> <span class="va">border</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="names-group-labels" class="level3" data-number="38.5.7"><h3 data-number="38.5.7" class="anchored" data-anchor-id="names-group-labels">
<span class="header-section-number">38.5.7</span> <strong><code>names</code></strong>: group labels</h3>
<p>The x-axis group names can be defined with the <code>names</code> argument:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">sleep</span>,</span>
<span>        col <span class="op">=</span> <span class="va">col</span>, border <span class="op">=</span> <span class="va">border</span>,</span>
<span>        names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Drug A"</span>, <span class="st">"Drug B"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section></section><section id="heatmap" class="level2" data-number="38.6"><h2 data-number="38.6" class="anchored" data-anchor-id="heatmap">
<span class="header-section-number">38.6</span> Heatmap</h2>
<p>Input: <strong>matrix</strong></p>
<p>A heatmap is a 2D matrix-like plot with x- and y-axis labels and a value in each cell. It can be used to display many different types of data. A common usage in data science is to plot the correlation matrix of a set of numerical features. In many cases, the rows and/or columns of a heatmap can be reordered based on hierarchical clustering.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, the <code><a href="https://rdrr.io/r/stats/heatmap.html">heatmap()</a></code> function draws marginal dendrograms and rearranges rows and columns. We can prevent that by setting <code>Rowv</code> and <code>Colv</code> to <code>NA</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="va">x_cor</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>To allow clustering and row and column reordering, use the defaults:</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="va">x_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="mosaicplot" class="level2" data-number="38.7"><h2 data-number="38.7" class="anchored" data-anchor-id="mosaicplot">
<span class="header-section-number">38.7</span> Mosaic plot</h2>
<p>Mosaic plots are used to visualize contingency tables. They can be informative to look at during data exploration. They are less likely to be included in a research article where the table itself is more likely to be included.</p>
<p>Synthetic data:</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2021</span><span class="op">)</span></span>
<span><span class="va">Cohort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Case"</span><span class="op">)</span>, <span class="fl">500</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Case"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">Cohort</span><span class="op">)</span>, </span>
<span>     \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, <span class="fl">1</span>,</span>
<span>     prob <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">Cohort</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Control"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot()</a></code> on the output of <code><a href="https://rdrr.io/r/base/table.html">table()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Cohort</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Cases vs. Controls"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>We can plot the breakdown of sexes, this time also adding color:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Males vs. Females"</span>,</span>
<span>           col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orchid"</span>, <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Cross-tabulating is usually most informatively. We us the same color for the sexes, which will be recycled. We also remove the border for a cleaner look:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Cohort</span>, <span class="va">Sex</span><span class="op">)</span>,</span>
<span>           color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orchid"</span>, <span class="st">"skyblue"</span><span class="op">)</span>,</span>
<span>           border <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>           main <span class="op">=</span> <span class="st">"Cohort x Sex"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section><section id="graphical-parameters" class="level2" data-number="38.8"><h2 data-number="38.8" class="anchored" data-anchor-id="graphical-parameters">
<span class="header-section-number">38.8</span> Graphical parameters</h2>
<p>The <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> function allows setting or querying graphical parameters of the base graphics system. Have a look at its documentation (<code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code>).<br>
Some graphical parameters can only be set with a call to <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> prior to using a base plotting function. However, many parameters can also be passed using the <code>...</code> construct of each base plotting function.</p>
<p>Some common base graphical parameters:</p>
<ul>
<li>
<strong><em>pch</em></strong>: Point character</li>
<li>
<strong><em>col</em></strong>: Color</li>
<li>
<strong><em>cex</em></strong>: Character expansion, i.e.&nbsp;relative size</li>
<li>
<strong><em>bty</em></strong>: Box type</li>
<li>
<strong><em>xlab</em></strong>: x-axis label</li>
<li>
<strong><em>ylab</em></strong>: y-axis label</li>
<li>
<strong><em>main</em></strong>: Main title</li>
<li>
<strong><em>mar</em></strong>: Plot margins</li>
</ul>
<p>You can see what the current value of these parameters is by calling <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> or directly accessing a specific parameter:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">mar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.1 4.1 4.1 2.1</code></pre>
</div>
</div>
<p><code>mar</code> sets the plot margins. It is a vector of length 4 and each number corresponds to the bottom-left-top-right margin, in that order. Use it to reduce empty white space between plots or add space if labels are getting cropped, for example.</p>
<p>Always make sure that your plotting characters, axis labels and titles are legible. You must avoid, at all costs, ever using a huge graph with tiny letters spread over an entire slide in a presentation.</p>
<ul>
<li>
<strong><em>cex</em></strong>: Character expansion for the plotting characters</li>
<li>
<strong><em>cex.axis</em></strong>: cex for axis annotation</li>
<li>
<strong><em>cex.lab</em></strong>: cex for x and y labels</li>
<li>
<strong><em>cex.main</em></strong>: cex for main title</li>
</ul>
<p>Note: All of these can be set either with a call to <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> prior to plotting or passed as arguments in a plotting command, like <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<p>There is one important distinction: <code>cex</code> set with <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> (which defaults to 1), sets the baseline and all other <code>cex</code> parameters multiply it. However, <code>cex</code> set within <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> still multiplies <code>cex</code> set with <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>, but only affects the plotting character size.</p>
<section id="save-and-reload-graphical-parameters" class="level3" data-number="38.8.1"><h3 data-number="38.8.1" class="anchored" data-anchor-id="save-and-reload-graphical-parameters">
<span class="header-section-number">38.8.1</span> Save and reload graphical parameters</h3>
<p>You can make a copy of all current graphical parameters:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">par_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are a few parameters that you cannot control, those are read-only. You can optionally exclude those since you cannot edit them anyway:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">par_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you make changes to <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> to produce plots and you want to recover the parameters you saved above, you can use reload them by passing them to <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">par_default</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, you can always restart the graphics device using <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.off()</a></code> and then making a new plot.</p>
<p>Note: here “device” does not refere to a physical device but software graphics interfaces that show a plot to screen or <a href="#saveplots">save to file</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># shuts down graphics device</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="multipanel-plots" class="level2" data-number="38.9"><h2 data-number="38.9" class="anchored" data-anchor-id="multipanel-plots">
<span class="header-section-number">38.9</span> Multipanel plots</h2>
<p>There are different ways to create multipanel plots, but probably the most straightforward is to use either the <code>mfrow</code> or the <code>mfcol</code> argument of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Both <code>mfrow</code> and <code>mfcol</code> accept an integer vector of length 2 indicating number of rows and number of columns, respectively. With <code>mfrow</code>, the plots are drawn row-wise and with <code>mfcol</code> they are drawn column-wise. Remember to reset <code>mfrow</code> or <code>mfcol</code> back to <code>c(1, 1)</code></p>
<p>For example, let’s plot a 2-by-3 panel of plots, drawn row-wise:</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Get the current parameters before changing them</span></span>
<span><span class="va">par_og</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"#052049bb"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">y</span>, col <span class="op">=</span> <span class="st">"#052049bb"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">z</span>, col <span class="op">=</span> <span class="st">"#052049bb"</span>, border <span class="op">=</span> <span class="st">"white"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="st">"#05204955"</span>, pch <span class="op">=</span> <span class="fl">16</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span>, col <span class="op">=</span> <span class="st">"#05204955"</span>, pch <span class="op">=</span> <span class="fl">16</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">z</span>, col <span class="op">=</span> <span class="st">"#05204955"</span>, pch <span class="op">=</span> <span class="fl">16</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BaseGraphics_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Restore mfrow to one figure at a time</span></span>
<span><span class="co"># This is not necessary if you are running the line below</span></span>
<span><span class="co"># which restores all parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Restore all parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">par_og</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="saveplots" class="level2" data-number="38.10"><h2 data-number="38.10" class="anchored" data-anchor-id="saveplots">
<span class="header-section-number">38.10</span> Saving plots to file</h2>
<p>You can save base graphics to disk using a number of different file formats. To do this, you have to:</p>
<ul>
<li>Open a graphics device - e.g.&nbsp;<code>pdf("path/to/xy_scatter.pdf")</code>
</li>
<li>Write to it - e.g.&nbsp;<code>plot(x, y)</code>
</li>
<li>Close graphics device - <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.off()</a></code>
</li>
</ul>
<p>The following commands are used to open graphical devices that will save to a file of the corresponding type:</p>
<ul>
<li><code>bmp(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>jpeg(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>png(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>tiff(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>svg(filename = "path/to/file", width = [in inches], height = [in inches]</code></li>
<li><code>pdf(file = "path/to/file", width = [in inches], height = [in inches])</code></li>
</ul>
<p>Notice the difference when writing to PDF: you define a <code>file</code> instead of a <code>filename</code>, and width and height are in <strong><em>inches</em></strong>, not pixels.<br>
It is recommended to save plots in PDF format because it handles vector graphics therefore plots will scale, and it is easy to export to other graphics formats later on if needed.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="st">"~/Desktop/plot.pdf"</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#18A3AC66"</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>     bty <span class="op">=</span> <span class="st">"n"</span>, <span class="co"># also try "l"</span></span>
<span>     xlab <span class="op">=</span> <span class="st">"Sepal Length"</span>, ylab <span class="op">=</span> <span class="st">"Petal Length"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./Graphics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Graphics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Colors.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Colors in R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">© 2022 E.D. Gennatas</div>
  </div>
</footer>


</body></html>