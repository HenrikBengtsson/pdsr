<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 29 Supervised Learning | Programming for Data Science in R</title>
<meta name="author" content="Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><script src="libs/d3-3.5.6/d3.min.js"></script><link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet">
<script src="libs/profvis-0.3.6.9000/profvis.js"></script><script src="libs/profvis-0.3.6.9000/scroll.js"></script><link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet">
<script src="libs/highlight-6.2.0/highlight.js"></script><script src="libs/profvis-binding-0.3.7/profvis.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163213745-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-163213745-1');
    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="bootstrap.lambdamd.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Programming for Data Science in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">PDSR</a></li>
<li><a class="" href="preface.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="Rsetup.html"><span class="header-section-number">3</span> R setup, Packages &amp; Docs</a></li>
<li><a class="" href="basicops.html"><span class="header-section-number">4</span> Basic operations</a></li>
<li><a class="" href="types.html"><span class="header-section-number">5</span> Data Types</a></li>
<li><a class="" href="structures.html"><span class="header-section-number">6</span> Data Structures</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">7</span> Factors</a></li>
<li><a class="" href="indexing.html"><span class="header-section-number">8</span> Indexing - Subsetting - Slicing</a></li>
<li><a class="" href="vectorization.html"><span class="header-section-number">9</span> Vectorized Operations</a></li>
<li><a class="" href="dataio.html"><span class="header-section-number">10</span> Data Input/Output</a></li>
<li><a class="" href="controlflow.html"><span class="header-section-number">11</span> Control flow</a></li>
<li><a class="" href="loopfns.html"><span class="header-section-number">12</span> Loop Functions</a></li>
<li><a class="" href="summarize.html"><span class="header-section-number">13</span> Summarizing Data</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">14</span> Functions</a></li>
<li><a class="" href="dataframes.html"><span class="header-section-number">15</span> Working with data frames</a></li>
<li><a class="" href="datatrans.html"><span class="header-section-number">16</span> Data Transformations</a></li>
<li><a class="" href="stringops.html"><span class="header-section-number">17</span> String Operations</a></li>
<li><a class="" href="datetime.html"><span class="header-section-number">18</span> Date and Time</a></li>
<li><a class="" href="missingdata.html"><span class="header-section-number">19</span> Handling Missing data</a></li>
<li><a class="" href="classes.html"><span class="header-section-number">20</span> Classes and Object-Oriented Programming</a></li>
<li><a class="" href="datatable.html"><span class="header-section-number">21</span> Efficient data analysis with data.table</a></li>
<li><a class="" href="basegraphics.html"><span class="header-section-number">22</span> Base Graphics</a></li>
<li><a class="" href="graphics3x.html"><span class="header-section-number">23</span> 3x Graphics</a></li>
<li><a class="" href="colors.html"><span class="header-section-number">24</span> Colors in R</a></li>
<li><a class="" href="profiling.html"><span class="header-section-number">25</span> Timing &amp; Profiling</a></li>
<li><a class="" href="optim.html"><span class="header-section-number">26</span> Optimization with optim()</a></li>
<li><a class="" href="glm.html"><span class="header-section-number">27</span> Introduction to the GLM</a></li>
<li><a class="" href="resampling.html"><span class="header-section-number">28</span> Resampling</a></li>
<li><a class="active" href="supervised.html"><span class="header-section-number">29</span> Supervised Learning</a></li>
<li><a class="" href="unsupervised.html"><span class="header-section-number">30</span> Unsupervised Learning</a></li>
<li><a class="" href="git.html"><span class="header-section-number">31</span> Git &amp; GitHub: the basics</a></li>
<li><a class="" href="shell.html"><span class="header-section-number">32</span> Introduction to the system shell</a></li>
<li><a class="" href="resources.html"><span class="header-section-number">33</span> Resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="supervised" class="section level1" number="29">
<h1>
<span class="header-section-number">29</span> Supervised Learning<a class="anchor" aria-label="anchor" href="#supervised"><i class="fas fa-link"></i></a>
</h1>
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<p>This is a very brief introduction to machine learning using the <a href="https://rtemis.lambdamd.org"><strong>rtemis</strong></a> package. <strong>rtemis</strong> includes functions for:</p>
<ul>
<li>Visualization: static &amp; interactive plots</li>
<li>Data preprocessing</li>
<li>Unsupervised learning: clustering &amp; dimensionality reduction</li>
<li>Supervised learning: regression &amp; classification</li>
</ul>
<div id="installation-1" class="section level2" number="29.1">
<h2>
<span class="header-section-number">29.1</span> Installation<a class="anchor" aria-label="anchor" href="#installation-1"><i class="fas fa-link"></i></a>
</h2>
<p>install the <strong>remotes</strong> package, if you don’t have it:</p>
<div class="sourceCode" id="cb1783"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></code></pre></div>
<p>Install <strong>rtemis</strong>:</p>
<div class="sourceCode" id="cb1784"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"egenn/rtemis"</span><span class="op">)</span></code></pre></div>
<p><strong>rtemis</strong> uses a large number of packages under the hood. Since you would not need to use all of them, they are not installed by default. Each time an <strong>rtemis</strong> function is called, a dependency check is run and a message is printed if any packages need to be installed.</p>
<p>For this short tutorial, start by installing <strong>ranger</strong>, if it is not already installed on your system:</p>
<div class="sourceCode" id="cb1785"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></code></pre></div>
<p>Load <strong>rtemis</strong>:</p>
<div class="sourceCode" id="cb1786"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rtemis.lambdamd.org">rtemis</a></span><span class="op">)</span></code></pre></div>
<pre><code>  .:rtemis 0.8.1: Welcome, egenn
  [x86_64-apple-darwin17.0 (64-bit): Defaulting to 4/4 available cores]
  Documentation &amp; vignettes: https://rtemis.lambdamd.org</code></pre>
</div>
<div id="data-input-for-supervised-learning" class="section level2" number="29.2">
<h2>
<span class="header-section-number">29.2</span> Data Input for Supervised Learning<a class="anchor" aria-label="anchor" href="#data-input-for-supervised-learning"><i class="fas fa-link"></i></a>
</h2>
<p>All <strong>rtemis</strong> supervised learning functions begin with <code>s.</code> (“supervised”).<br>
They accept the same first four arguments:<br><code>x</code>, <code>y</code>, <code>x.test</code>, <code>y.test</code><br>
but are flexible and allow you to also provide combined (x, y) and (x.test, y.test) data frames, as explained below.</p>
<div id="scenario-1-x.train-y.train-x.test-y.test" class="section level3" number="29.2.1">
<h3>
<span class="header-section-number">29.2.1</span> Scenario 1 (<code>x.train, y.train, x.test, y.test</code>)<a class="anchor" aria-label="anchor" href="#scenario-1-x.train-y.train-x.test-y.test"><i class="fas fa-link"></i></a>
</h3>
<p>In the most straightforward case, provide each featureset and outcome individually:</p>
<ul>
<li>
<code>x</code>: Training set features</li>
<li>
<code>y</code>: Training set outcome</li>
<li>
<code>x.test</code>: Testing set features (Optional)</li>
<li>
<code>y.test</code>: Testing set outcome (Optional)</li>
</ul>
<div class="sourceCode" id="cb1788"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/rnormmat.html">rnormmat</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">10</span>, seed <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span>
<span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">%*%</span> <span class="va">w</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/resample.html">resample</a></span><span class="op">(</span><span class="va">y</span>, seed <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Resampling Parameters</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    n.resamples: 10 
      resampler: strat.sub 
   stratify.var: y 
        train.p: 0.75 
   strat.n.bins: 4 

</span><span style="color: #555555;">[2020-11-09 01:08:41</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Created 10 stratified subsamples 
</span></code></pre>
<div class="sourceCode" id="cb1789"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x.train</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span>
<span class="va">x.test</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span>
<span class="va">y.train</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span><span class="op">]</span>
<span class="va">y.test</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb1790"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/s.GLM.html">s.GLM</a></span><span class="op">(</span><span class="va">x.train</span>, <span class="va">y.train</span>, <span class="va">x.test</span>, <span class="va">y.test</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:41</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] Hello,</span><span> </span><span style="color: #555555;">egenn</span><span> 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Regression Input Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   Training features: </span><span style="font-weight: bold;">147 x 10 
</span><span>    Training outcome: </span><span style="font-weight: bold;">147 x 1 
</span><span>    Testing features: </span><span style="font-weight: bold;">53 x 10 
</span><span>     Testing outcome: </span><span style="font-weight: bold;">53 x 1 
</span><span>
</span><span style="color: #555555;">[2020-11-09 01:08:42</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] </span><span>Training GLM... 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">GLM Regression Training Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    MSE = 0.84 (91.88%)
   RMSE = 0.92 (71.51%)
    MAE = 0.75 (69.80%)
      r = 0.96 (p = 5.9e-81)
    rho = 0.95 (p = 0.00)
   R sq = </span><span style="color: #00BBBB;font-weight: bold;">0.92</span><span>

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">GLM Regression Testing Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    MSE = 1.22 (89.03%)
   RMSE = 1.10 (66.88%)
    MAE = 0.90 (66.66%)
      r = 0.94 (p = 2.5e-26)
    rho = 0.95 (p = 0.00)
   R sq = </span><span style="color: #00BBBB;font-weight: bold;">0.89</span><span>
</span></code></pre>
<img src="87-Supervised_files/figure-html/unnamed-chunk-7-1.png" width="480"><pre class="fansi fansi-output"><code>
<span style="color: #555555;">[2020-11-09 01:08:42</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] Run completed in 0.03 minutes (Real: 1.65; User: 1.22; System: 0.08)</span><span> 
</span></code></pre>
</div>
<div id="scenario-2-x.train-x.test" class="section level3" number="29.2.2">
<h3>
<span class="header-section-number">29.2.2</span> Scenario 2: (<code>x.train, x.test</code>)<a class="anchor" aria-label="anchor" href="#scenario-2-x.train-x.test"><i class="fas fa-link"></i></a>
</h3>
<p>You can provide training and testing sets as a single data.frame each, where the last column is the outcome. Now <code>x</code> is the full training data and <code>y</code> the full testing data:</p>
<ul>
<li>
<code>x</code>: data.frame(x.train, y.train)</li>
<li>
<code>y</code>: data.frame(x.test, y.test)</li>
</ul>
<div class="sourceCode" id="cb1791"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/rnormmat.html">rnormmat</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">10</span>, seed <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span>
<span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">%*%</span> <span class="va">w</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/resample.html">resample</a></span><span class="op">(</span><span class="va">dat</span>, seed <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Input contains more than one columns; will stratify on last 
</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Resampling Parameters</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    n.resamples: 10 
      resampler: strat.sub 
   stratify.var: y 
        train.p: 0.75 
   strat.n.bins: 4 

</span><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Created 10 stratified subsamples 
</span></code></pre>
<div class="sourceCode" id="cb1792"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span>
<span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb1793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/s.GLM.html">s.GLM</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] Hello,</span><span> </span><span style="color: #555555;">egenn</span><span> 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Regression Input Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   Training features: </span><span style="font-weight: bold;">147 x 10 
</span><span>    Training outcome: </span><span style="font-weight: bold;">147 x 1 
</span><span>    Testing features: </span><span style="font-weight: bold;">53 x 10 
</span><span>     Testing outcome: </span><span style="font-weight: bold;">53 x 1 
</span><span>
</span><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] </span><span>Training GLM... 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">GLM Regression Training Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    MSE = 0.84 (91.88%)
   RMSE = 0.92 (71.51%)
    MAE = 0.75 (69.80%)
      r = 0.96 (p = 5.9e-81)
    rho = 0.95 (p = 0.00)
   R sq = </span><span style="color: #00BBBB;font-weight: bold;">0.92</span><span>

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">GLM Regression Testing Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    MSE = 1.22 (89.03%)
   RMSE = 1.10 (66.88%)
    MAE = 0.90 (66.66%)
      r = 0.94 (p = 2.5e-26)
    rho = 0.95 (p = 0.00)
   R sq = </span><span style="color: #00BBBB;font-weight: bold;">0.89</span><span>
</span></code></pre>
<img src="87-Supervised_files/figure-html/unnamed-chunk-9-1.png" width="480"><pre class="fansi fansi-output"><code>
<span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] Run completed in 2.6e-03 minutes (Real: 0.16; User: 0.10; System: 0.02)</span><span> 
</span></code></pre>
<p>The <code><a href="https://rdrr.io/pkg/rtemis/man/dataPrepare.html">dataPrepare()</a></code> function will check data dimensions and determine whether data was input as separate feature and outcome sets or combined and ensure the correct number of cases and features was provided.</p>
<p>In either scenario, Regression will be performed if the outcome is numeric and Classification if the outcome is a factor.</p>
</div>
</div>
<div id="regression" class="section level2" number="29.3">
<h2>
<span class="header-section-number">29.3</span> Regression<a class="anchor" aria-label="anchor" href="#regression"><i class="fas fa-link"></i></a>
</h2>
<div id="check-data-with-checkdata" class="section level3" number="29.3.1">
<h3>
<span class="header-section-number">29.3.1</span> Check Data with <code>checkData()</code><a class="anchor" aria-label="anchor" href="#check-data-with-checkdata"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1794"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/rnormmat.html">rnormmat</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">50</span>, seed <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span>
<span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">%*%</span> <span class="va">w</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/resample.html">resample</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Input contains more than one columns; will stratify on last 
</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Resampling Parameters</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    n.resamples: 10 
      resampler: strat.sub 
   stratify.var: y 
        train.p: 0.75 
   strat.n.bins: 4 

</span><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Created 10 stratified subsamples 
</span></code></pre>
<div class="sourceCode" id="cb1795"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span>
<span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">-</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb1796"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/checkData.html">checkData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code>  Dataset: <span style="color: #00BBBB;font-weight: bold;">x</span><span> 

  </span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>  </span><span style="font-weight: bold;">500</span><span> cases with </span><span style="font-weight: bold;">50</span><span> features: 
  * </span><span style="font-weight: bold;">50</span><span> continuous features 
  * </span><span style="font-weight: bold;">0</span><span> integer features 
  * </span><span style="font-weight: bold;">0</span><span> categorical features
  * </span><span style="font-weight: bold;">0</span><span> constant features 
  * </span><span style="font-weight: bold;">0</span><span> duplicated cases 
  * </span><span style="font-weight: bold;">0</span><span> features include 'NA' values

  </span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Recommendations</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span style="color: #00BB00;font-weight: bold;">  * Everything looks good
</span><span>
</span></code></pre>
</div>
<div id="single-model" class="section level3" number="29.3.2">
<h3>
<span class="header-section-number">29.3.2</span> Single Model<a class="anchor" aria-label="anchor" href="#single-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1797"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/s.GLM.html">s.GLM</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] Hello,</span><span> </span><span style="color: #555555;">egenn</span><span> 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Regression Input Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   Training features: </span><span style="font-weight: bold;">374 x 50 
</span><span>    Training outcome: </span><span style="font-weight: bold;">374 x 1 
</span><span>    Testing features: </span><span style="font-weight: bold;">126 x 50 
</span><span>     Testing outcome: </span><span style="font-weight: bold;">126 x 1 
</span><span>
</span><span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] </span><span>Training GLM... 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">GLM Regression Training Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    MSE = 1.02 (97.81%)
   RMSE = 1.01 (85.18%)
    MAE = 0.81 (84.62%)
      r = 0.99 (p = 1.3e-310)
    rho = 0.99 (p = 0.00)
   R sq = </span><span style="color: #00BBBB;font-weight: bold;">0.98</span><span>

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">GLM Regression Testing Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    MSE = 0.98 (97.85%)
   RMSE = 0.99 (85.35%)
    MAE = 0.76 (85.57%)
      r = 0.99 (p = 2.7e-105)
    rho = 0.98 (p = 0.00)
   R sq = </span><span style="color: #00BBBB;font-weight: bold;">0.98</span><span>
</span></code></pre>
<img src="87-Supervised_files/figure-html/unnamed-chunk-11-1.png" width="480"><pre class="fansi fansi-output"><code>
<span style="color: #555555;">[2020-11-09 01:08:43</span><span style="color: #555555;font-weight: bold;"> s.GLM</span><span style="color: #555555;">] Run completed in 3.1e-03 minutes (Real: 0.19; User: 0.12; System: 0.03)</span><span> 
</span></code></pre>
</div>
<div id="crossvalidated-model" class="section level3" number="29.3.3">
<h3>
<span class="header-section-number">29.3.3</span> Crossvalidated Model<a class="anchor" aria-label="anchor" href="#crossvalidated-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1798"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/elevate.html">elevate</a></span><span class="op">(</span><span class="va">dat</span>, mod <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:44</span><span style="color: #555555;font-weight: bold;"> elevate</span><span style="color: #555555;">] Hello,</span><span> </span><span style="color: #555555;">egenn</span><span> 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Regression Input Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   Training features: </span><span style="font-weight: bold;">500 x 50 
</span><span>    Training outcome: </span><span style="font-weight: bold;">500 x 1 
</span><span>
</span><span style="color: #555555;">[2020-11-09 01:08:44</span><span style="color: #555555;font-weight: bold;"> resLearn</span><span style="color: #555555;">] </span><span>Training Generalized Linear Model on 10 stratified subsamples... 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">elevate </span><span style="color: #00BBBB;font-weight: bold;">GLM</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   N repeats = </span><span style="color: #00BBBB;font-weight: bold;">1</span><span> 
   N resamples = </span><span style="color: #00BBBB;font-weight: bold;">10</span><span> 
   Resampler = </span><span style="color: #00BBBB;font-weight: bold;">strat.sub</span><span> 
   Mean MSE of 10 resamples in each repeat = </span><span style="color: #00BBBB;font-weight: bold;">1.22</span><span>
   Mean MSE reduction in each repeat =  </span><span style="color: #00BBBB;font-weight: bold;">97.50%
</span><span>
</span></code></pre>
<img src="87-Supervised_files/figure-html/unnamed-chunk-12-1.png" width="480"><pre class="fansi fansi-output"><code>
<span style="color: #555555;">[2020-11-09 01:08:45</span><span style="color: #555555;font-weight: bold;"> elevate</span><span style="color: #555555;">] Run completed in 0.02 minutes (Real: 1.02; User: 0.72; System: 0.11)</span><span> 
</span></code></pre>
<p>Use the <code>describe()</code> function to get a summary in (plain) English:</p>
<div class="sourceCode" id="cb1799"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">describe</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>Regression was performed using Generalized Linear Model. Model generalizability was assessed using 10 stratified subsamples. The mean R-squared across all resamples was 0.97.</code></pre>
<div class="sourceCode" id="cb1801"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-14-1.png" width="480"></div>
</div>
</div>
<div id="classification-1" class="section level2" number="29.4">
<h2>
<span class="header-section-number">29.4</span> Classification<a class="anchor" aria-label="anchor" href="#classification-1"><i class="fas fa-link"></i></a>
</h2>
<div id="check-data" class="section level3" number="29.4.1">
<h3>
<span class="header-section-number">29.4.1</span> Check Data<a class="anchor" aria-label="anchor" href="#check-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1802"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Sonar</span>, package <span class="op">=</span> <span class="st">'mlbench'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/checkData.html">checkData</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code>  Dataset: <span style="color: #00BBBB;font-weight: bold;">Sonar</span><span> 

  </span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>  </span><span style="font-weight: bold;">208</span><span> cases with </span><span style="font-weight: bold;">61</span><span> features: 
  * </span><span style="font-weight: bold;">60</span><span> continuous features 
  * </span><span style="font-weight: bold;">0</span><span> integer features 
  * </span><span style="font-weight: bold;">1</span><span> categorical feature, which is not ordered
  * </span><span style="font-weight: bold;">0</span><span> constant features 
  * </span><span style="font-weight: bold;">0</span><span> duplicated cases 
  * </span><span style="font-weight: bold;">0</span><span> features include 'NA' values

  </span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Recommendations</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span style="color: #00BB00;font-weight: bold;">  * Everything looks good
</span><span>
</span></code></pre>
<div class="sourceCode" id="cb1803"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/resample.html">resample</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Input contains more than one columns; will stratify on last 
</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Resampling Parameters</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>    n.resamples: 10 
      resampler: strat.sub 
   stratify.var: y 
        train.p: 0.75 
   strat.n.bins: 4 
</span><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> strat.sub</span><span style="color: #555555;">] </span><span>Using max n bins possible = 2 

</span><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> resample</span><span style="color: #555555;">] </span><span>Created 10 stratified subsamples 
</span></code></pre>
<div class="sourceCode" id="cb1804"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sonar.train</span> <span class="op">&lt;-</span> <span class="va">Sonar</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span>
<span class="va">sonar.test</span> <span class="op">&lt;-</span> <span class="va">Sonar</span><span class="op">[</span><span class="op">-</span><span class="va">res</span><span class="op">$</span><span class="va">Subsample_1</span>, <span class="op">]</span></code></pre></div>
</div>
<div id="single-model-1" class="section level3" number="29.4.2">
<h3>
<span class="header-section-number">29.4.2</span> Single model<a class="anchor" aria-label="anchor" href="#single-model-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1805"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/s.RANGER.html">s.RANGER</a></span><span class="op">(</span><span class="va">sonar.train</span>, <span class="va">sonar.test</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> s.RANGER</span><span style="color: #555555;">] Hello,</span><span> </span><span style="color: #555555;">egenn</span><span> 

</span><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> dataPrepare</span><span style="color: #555555;">] </span><span>Imbalanced classes: using Inverse Probability Weighting 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Classification Input Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   Training features: </span><span style="font-weight: bold;">155 x 60 
</span><span>    Training outcome: </span><span style="font-weight: bold;">155 x 1 
</span><span>    Testing features: </span><span style="font-weight: bold;">53 x 60 
</span><span>     Testing outcome: </span><span style="font-weight: bold;">53 x 1 
</span><span>
</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Parameters</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   n.trees: 1000 
      mtry: NULL 

</span><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> s.RANGER</span><span style="color: #555555;">] </span><span>Training Random Forest (ranger) Classification with 1000 trees... 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">RANGER Classification Training Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span style="font-weight: bold;">                   Reference</span><span> 
</span><span style="font-weight: bold;">        Estimated</span><span>  </span><span style="color: #00BBBB;font-weight: bold;">M   R   </span><span>
</span><span style="color: #00BBBB;font-weight: bold;">                M</span><span>  83   0
</span><span style="color: #00BBBB;font-weight: bold;">                R</span><span>   0  72

                   </span><span style="color: #00BBBB;font-weight: bold;">Overall  </span><span>
      Sensitivity  1      
      Specificity  1      
Balanced Accuracy  1      
              PPV  1      
              NPV  1      
               F1  1      
         Accuracy  1      
              AUC  1      

  Positive Class:  </span><span style="color: #00BBBB;font-weight: bold;">M</span><span> 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">RANGER Classification Testing Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span style="font-weight: bold;">                   Reference</span><span> 
</span><span style="font-weight: bold;">        Estimated</span><span>  </span><span style="color: #00BBBB;font-weight: bold;">M   R   </span><span>
</span><span style="color: #00BBBB;font-weight: bold;">                M</span><span>  25  12
</span><span style="color: #00BBBB;font-weight: bold;">                R</span><span>   3  13

                   </span><span style="color: #00BBBB;font-weight: bold;">Overall  </span><span>
      Sensitivity  0.8929 
      Specificity  0.5200 
Balanced Accuracy  0.7064 
              PPV  0.6757 
              NPV  0.8125 
               F1  0.7692 
         Accuracy  0.7170 
              AUC  0.8479 

  Positive Class:  </span><span style="color: #00BBBB;font-weight: bold;">M</span><span> 
</span></code></pre>
<img src="87-Supervised_files/figure-html/unnamed-chunk-16-1.png" width="480"><pre class="fansi fansi-output"><code>
<span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> s.RANGER</span><span style="color: #555555;">] Run completed in 0.01 minutes (Real: 0.32; User: 0.43; System: 0.04)</span><span> 
</span></code></pre>
</div>
<div id="crossvalidated-model-1" class="section level3" number="29.4.3">
<h3>
<span class="header-section-number">29.4.3</span> Crossvalidated Model<a class="anchor" aria-label="anchor" href="#crossvalidated-model-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1806"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/elevate.html">elevate</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> elevate</span><span style="color: #555555;">] Hello,</span><span> </span><span style="color: #555555;">egenn</span><span> 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">Classification Input Summary</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   Training features: </span><span style="font-weight: bold;">208 x 60 
</span><span>    Training outcome: </span><span style="font-weight: bold;">208 x 1 
</span><span>
</span><span style="color: #555555;">[2020-11-09 01:08:47</span><span style="color: #555555;font-weight: bold;"> resLearn</span><span style="color: #555555;">] </span><span>Training Random Forest (ranger) on 10 stratified subsamples... 

</span><span style="color: #555555;font-weight: bold;">[[ </span><span style="font-weight: bold;">elevate </span><span style="color: #00BBBB;font-weight: bold;">RANGER</span><span style="color: #555555;font-weight: bold;"> ]]
</span><span>   N repeats = </span><span style="color: #00BBBB;font-weight: bold;">1</span><span> 
   N resamples = </span><span style="color: #00BBBB;font-weight: bold;">10</span><span> 
   Resampler = </span><span style="color: #00BBBB;font-weight: bold;">strat.sub</span><span> 
   Mean Balanced Accuracy of 10 test sets in each repeat = </span><span style="color: #00BBBB;font-weight: bold;">0.83</span><span>
</span></code></pre>
<img src="87-Supervised_files/figure-html/unnamed-chunk-17-1.png" width="480"><pre class="fansi fansi-output"><code>
<span style="color: #555555;">[2020-11-09 01:08:50</span><span style="color: #555555;font-weight: bold;"> elevate</span><span style="color: #555555;">] Run completed in 0.04 minutes (Real: 2.67; User: 3.87; System: 0.16)</span><span> 
</span></code></pre>
<div class="sourceCode" id="cb1807"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">describe</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>Classification was performed using Random Forest (ranger). Model generalizability was assessed using 10 stratified subsamples. The mean Balanced Accuracy across all resamples was 0.83.</code></pre>
<div class="sourceCode" id="cb1809"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-19-1.png" width="480"></div>
<div class="sourceCode" id="cb1810"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">plotROC</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-20-1.png" width="480"></div>
<div class="sourceCode" id="cb1811"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">plotPR</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-21-1.png" width="480"></div>
</div>
<div id="evaluation-of-a-binary-classifier" class="section level3" number="29.4.4">
<h3>
<span class="header-section-number">29.4.4</span> Evaluation of a binary classifier<a class="anchor" aria-label="anchor" href="#evaluation-of-a-binary-classifier"><i class="fas fa-link"></i></a>
</h3>
<div class="figure" style="text-align: center">
<span id="fig:Classification"></span>
<img src="Classification.png" alt="Evaluation metrics for a binary classifier" width="100%"><p class="caption">
Figure 29.1: Evaluation metrics for a binary classifier
</p>
</div>
</div>
</div>
<div id="understanding-overfitting" class="section level2" number="29.5">
<h2>
<span class="header-section-number">29.5</span> Understanding Overfitting<a class="anchor" aria-label="anchor" href="#understanding-overfitting"><i class="fas fa-link"></i></a>
</h2>
<p>Overfitting occurs when a model fits noise in the outcome. To make this clear, consider the following example:</p>
<p>Assume a random variable <strong>x</strong>:</p>
<div class="sourceCode" id="cb1812"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>and a data-generating function <code>fn()</code>:</p>
<div class="sourceCode" id="cb1813"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">12</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">5</span></code></pre></div>
<p>The true y is therefore equal to <code>fn(x)</code>:</p>
<div class="sourceCode" id="cb1814"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y_true</span> <span class="op">&lt;-</span> <span class="fu">fn</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p>However, assume y is recorded with some noise, in this case gaussian:</p>
<div class="sourceCode" id="cb1815"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y_noise</span> <span class="op">&lt;-</span> <span class="fu">fn</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y_true</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We plot:</p>
<div class="sourceCode" id="cb1816"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/mplot3.xy.html">mplot3.xy</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>y_noise <span class="op">=</span> <span class="va">y_noise</span>, y_true <span class="op">=</span> <span class="va">y_true</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-26-1.png" width="480"></div>
<p>We want to find a model that best approximates <code>y_true</code>, but we only know <code>y_noise</code>.</p>
<p>A maximally overfitted model would model noise perfectly:</p>
<div class="sourceCode" id="cb1817"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/mplot3.xy.html">mplot3.xy</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Overfitted_model <span class="op">=</span> <span class="va">y_noise</span>, Ideal_model <span class="op">=</span> <span class="va">y_true</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-27-1.png" width="480"></div>
<p>An example of an SVM set up to overfit heavily:</p>
<div class="sourceCode" id="cb1818"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/mplot3.xy.html">mplot3.xy</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y_noise</span>, fit <span class="op">=</span> <span class="st">"svm"</span>,
          fit.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>kernel <span class="op">=</span> <span class="st">"radial"</span>, cost <span class="op">=</span> <span class="fl">100</span>, gamma <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-28-1.png" width="480"></div>
<p>An example of a good approximation of <code>fn</code> using a GAM with penalized splines:</p>
<div class="sourceCode" id="cb1819"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/mplot3.xy.html">mplot3.xy</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y_noise</span>, fit <span class="op">=</span> <span class="st">"gam"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="87-Supervised_files/figure-html/unnamed-chunk-29-1.png" width="480"></div>
</div>
<div id="rtemis-documentation" class="section level2" number="29.6">
<h2>
<span class="header-section-number">29.6</span> <strong>rtemis</strong> Documentation<a class="anchor" aria-label="anchor" href="#rtemis-documentation"><i class="fas fa-link"></i></a>
</h2>
<p>For more information on using <strong>rtemis</strong>, see the <a href="https://rtemis.lambdamd.prg">rtemis online documentation and vignettes</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="resampling.html"><span class="header-section-number">28</span> Resampling</a></div>
<div class="next"><a href="unsupervised.html"><span class="header-section-number">30</span> Unsupervised Learning</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#supervised"><span class="header-section-number">29</span> Supervised Learning</a></li>
<li><a class="nav-link" href="#installation-1"><span class="header-section-number">29.1</span> Installation</a></li>
<li>
<a class="nav-link" href="#data-input-for-supervised-learning"><span class="header-section-number">29.2</span> Data Input for Supervised Learning</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#scenario-1-x.train-y.train-x.test-y.test"><span class="header-section-number">29.2.1</span> Scenario 1 (x.train, y.train, x.test, y.test)</a></li>
<li><a class="nav-link" href="#scenario-2-x.train-x.test"><span class="header-section-number">29.2.2</span> Scenario 2: (x.train, x.test)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#regression"><span class="header-section-number">29.3</span> Regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#check-data-with-checkdata"><span class="header-section-number">29.3.1</span> Check Data with checkData()</a></li>
<li><a class="nav-link" href="#single-model"><span class="header-section-number">29.3.2</span> Single Model</a></li>
<li><a class="nav-link" href="#crossvalidated-model"><span class="header-section-number">29.3.3</span> Crossvalidated Model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#classification-1"><span class="header-section-number">29.4</span> Classification</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#check-data"><span class="header-section-number">29.4.1</span> Check Data</a></li>
<li><a class="nav-link" href="#single-model-1"><span class="header-section-number">29.4.2</span> Single model</a></li>
<li><a class="nav-link" href="#crossvalidated-model-1"><span class="header-section-number">29.4.3</span> Crossvalidated Model</a></li>
<li><a class="nav-link" href="#evaluation-of-a-binary-classifier"><span class="header-section-number">29.4.4</span> Evaluation of a binary classifier</a></li>
</ul>
</li>
<li><a class="nav-link" href="#understanding-overfitting"><span class="header-section-number">29.5</span> Understanding Overfitting</a></li>
<li><a class="nav-link" href="#rtemis-documentation"><span class="header-section-number">29.6</span> rtemis Documentation</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Programming for Data Science in R</strong>" was written by Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD. It was last built on 2021-07-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
