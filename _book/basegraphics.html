<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 22 Base Graphics | Programming for Data Science in R</title>
<meta name="author" content="Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><script src="libs/d3-3.5.6/d3.min.js"></script><link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet">
<script src="libs/profvis-0.3.6.9000/profvis.js"></script><script src="libs/profvis-0.3.6.9000/scroll.js"></script><link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet">
<script src="libs/highlight-6.2.0/highlight.js"></script><script src="libs/profvis-binding-0.3.7/profvis.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163213745-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-163213745-1');
    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="bootstrap.lambdamd.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Programming for Data Science in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">PDSR</a></li>
<li><a class="" href="preface.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="Rsetup.html"><span class="header-section-number">3</span> R setup, Packages &amp; Docs</a></li>
<li><a class="" href="basicops.html"><span class="header-section-number">4</span> Basic operations</a></li>
<li><a class="" href="types.html"><span class="header-section-number">5</span> Data Types</a></li>
<li><a class="" href="structures.html"><span class="header-section-number">6</span> Data Structures</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">7</span> Factors</a></li>
<li><a class="" href="indexing.html"><span class="header-section-number">8</span> Indexing - Subsetting - Slicing</a></li>
<li><a class="" href="vectorization.html"><span class="header-section-number">9</span> Vectorized Operations</a></li>
<li><a class="" href="dataio.html"><span class="header-section-number">10</span> Data Input/Output</a></li>
<li><a class="" href="controlflow.html"><span class="header-section-number">11</span> Control flow</a></li>
<li><a class="" href="loopfns.html"><span class="header-section-number">12</span> Loop Functions</a></li>
<li><a class="" href="summarize.html"><span class="header-section-number">13</span> Summarizing Data</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">14</span> Functions</a></li>
<li><a class="" href="dataframes.html"><span class="header-section-number">15</span> Working with data frames</a></li>
<li><a class="" href="datatrans.html"><span class="header-section-number">16</span> Data Transformations</a></li>
<li><a class="" href="stringops.html"><span class="header-section-number">17</span> String Operations</a></li>
<li><a class="" href="datetime.html"><span class="header-section-number">18</span> Date and Time</a></li>
<li><a class="" href="missingdata.html"><span class="header-section-number">19</span> Handling Missing data</a></li>
<li><a class="" href="classes.html"><span class="header-section-number">20</span> Classes and Object-Oriented Programming</a></li>
<li><a class="" href="datatable.html"><span class="header-section-number">21</span> Efficient data analysis with data.table</a></li>
<li><a class="active" href="basegraphics.html"><span class="header-section-number">22</span> Base Graphics</a></li>
<li><a class="" href="graphics3x.html"><span class="header-section-number">23</span> 3x Graphics</a></li>
<li><a class="" href="colors.html"><span class="header-section-number">24</span> Colors in R</a></li>
<li><a class="" href="profiling.html"><span class="header-section-number">25</span> Timing &amp; Profiling</a></li>
<li><a class="" href="optim.html"><span class="header-section-number">26</span> Optimization with optim()</a></li>
<li><a class="" href="glm.html"><span class="header-section-number">27</span> Introduction to the GLM</a></li>
<li><a class="" href="resampling.html"><span class="header-section-number">28</span> Resampling</a></li>
<li><a class="" href="supervised.html"><span class="header-section-number">29</span> Supervised Learning</a></li>
<li><a class="" href="unsupervised.html"><span class="header-section-number">30</span> Unsupervised Learning</a></li>
<li><a class="" href="git.html"><span class="header-section-number">31</span> Git &amp; GitHub: the basics</a></li>
<li><a class="" href="shell.html"><span class="header-section-number">32</span> Introduction to the system shell</a></li>
<li><a class="" href="resources.html"><span class="header-section-number">33</span> Resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="basegraphics" class="section level1" number="22">
<h1>
<span class="header-section-number">22</span> Base Graphics<a class="anchor" aria-label="anchor" href="#basegraphics"><i class="fas fa-link"></i></a>
</h1>
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<p>R has powerful graphical capabilities built in to the core language. This chapter is an introduction to what is known as base graphics which is provided by the <strong>graphics</strong> built-in package. Their defaults produce minimalist plots, but they can be customized extensively. In this chapter we shall begin with default plots and demonstrate some of the more common/useful ways to customize them.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">Plot type</th>
<th align="left">Command</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">Scatterplot</td>
<td align="left"><code><a href="https://rdrr.io/r/graphics/plot.default.html">plot(x, y)</a></code></td>
</tr>
<tr class="even">
<td align="right">Line plot</td>
<td align="left"><code><a href="https://rdrr.io/r/graphics/plot.default.html">plot(x, y, type = 'l')</a></code></td>
</tr>
<tr class="odd">
<td align="right">Histogram</td>
<td align="left"><code><a href="https://rdrr.io/r/graphics/hist.html">hist(x)</a></code></td>
</tr>
<tr class="even">
<td align="right">Density plot</td>
<td align="left"><code><a href="https://rdrr.io/r/graphics/plot.default.html">plot(density(x))</a></code></td>
</tr>
<tr class="odd">
<td align="right">Barplot</td>
<td align="left"><code><a href="https://rdrr.io/r/graphics/barplot.html">barplot(x)</a></code></td>
</tr>
<tr class="even">
<td align="right">Boxplot</td>
<td align="left"><code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot(x)</a></code></td>
</tr>
<tr class="odd">
<td align="right">Heatmap</td>
<td align="left"><code><a href="https://rdrr.io/r/stats/heatmap.html">heatmap(x)</a></code></td>
</tr>
</tbody>
</table></div>
<p>R documentation for each of the above commands provides extensive coverage of graphical parameters. <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> gives the main documentation file for a long list of graphical parameters. These can be set either with the <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> command before using any plotting command.</p>
<p>Let’s create some synthetic data:</p>
<div class="sourceCode" id="cb1519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span>
<span class="va">y_true</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="op">+</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span><span class="op">*</span><span class="fl">1.5</span></code></pre></div>
<div id="scatter-plot" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> Scatter plot<a class="anchor" aria-label="anchor" href="#scatter-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Input: 2 <strong>numeric vectors</strong></p>
<p>A 2D scatterplot displays of two numeric vectors as X and Y coordinates.</p>
<div class="sourceCode" id="cb1520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-4-1.png" width="480"></div>
<div id="col-point-color" class="section level3" number="22.1.1">
<h3>
<span class="header-section-number">22.1.1</span> <strong><code>col</code></strong>: point color<a class="anchor" aria-label="anchor" href="#col-point-color"><i class="fas fa-link"></i></a>
</h3>
<p>See <a href="colors.html#colors">Colors in R</a> to learn about the different ways to define colors in R.</p>
<p>Some common ways include:</p>
<ul>
<li>By name using one of 657 names given by <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code>, e.g. “red,” “magenta,” “blue,” “navy,” “cyan”</li>
<li>By RGB code</li>
</ul>
<div class="sourceCode" id="cb1521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="st">"slateblue"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-5-1.png" width="480"></div>
</div>
<div id="bty-box-type" class="section level3" number="22.1.2">
<h3>
<span class="header-section-number">22.1.2</span> <strong><code>bty</code></strong>: box type<a class="anchor" aria-label="anchor" href="#bty-box-type"><i class="fas fa-link"></i></a>
</h3>
<p>There are 7 bty options: “o” “l,” “7,” “c,” “u,” or “]” and “none.”
They produce a box that resembles the corresponding symbol.
“none” draws no box but allows the axes to show:</p>
<div class="sourceCode" id="cb1522"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-6-1.png" width="480"></div>
<div class="sourceCode" id="cb1523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-7-1.png" width="480"></div>
</div>
<div id="pch-point-character" class="section level3" number="22.1.3">
<h3>
<span class="header-section-number">22.1.3</span> <strong><code>pch</code></strong>: point character<a class="anchor" aria-label="anchor" href="#pch-point-character"><i class="fas fa-link"></i></a>
</h3>
<p>The default point character is a circle as seen above. This helps visualize overlapping points (especially for devices that do not support transparency).</p>
<p>There are 25 point characters, designated by integers 1 through 25.</p>
<p>Here’s a preview of all 25 <code>pch</code> options.
<code>pch</code> types 21 through 25 can be filled by a color specified by <code>bg</code>.</p>
<div class="sourceCode" id="cb1524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">25</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, bg <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-8-1.png" width="480"></div>
<p>Let’s use a solid disc:</p>
<div class="sourceCode" id="cb1525"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-9-1.png" width="480"></div>
<p>We cannot tell how many points are overlapping in the middle and therefore it’s a good idea to make the points a little transparent.</p>
<p>There are different ways to add transparency (see <a href="colors.html#colors">Colors</a>). The easiest way is probably to use <code><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor()</a></code>. In the context of colors, <code>alpha</code> refers to transparency: <code>a = 1</code> is opaque and <code>a = 0</code> is completely transparent (therefore use a value greater than 0).</p>
<div class="sourceCode" id="cb1526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,
     bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>,
     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"slateblue"</span>, alpha.f <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-10-1.png" width="480"></div>
</div>
<div id="grid" class="section level3" number="22.1.4">
<h3>
<span class="header-section-number">22.1.4</span> grid<a class="anchor" aria-label="anchor" href="#grid"><i class="fas fa-link"></i></a>
</h3>
<p>We can add a grid behind the plot area using the <code>panel.first</code> argument, which accepts a graphical expression (a function that draws something), which will be evaluated before plotting the points on the graph (therefore appears behind the points).</p>
<div class="sourceCode" id="cb1527"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,
     bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>,
     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"slateblue"</span>, alpha.f <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,
     panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">'gray90'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-11-1.png" width="480"></div>
</div>
<div id="main-xlab-ylab-title-and-axes-labels" class="section level3" number="22.1.5">
<h3>
<span class="header-section-number">22.1.5</span> <strong><code>main</code></strong>, <strong><code>xlab</code></strong>, <strong><code>ylab</code></strong>: Title and axes labels<a class="anchor" aria-label="anchor" href="#main-xlab-ylab-title-and-axes-labels"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,
     bty <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>,
     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"slateblue"</span>, alpha.f <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,
     panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">'gray90'</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"y vs. x"</span>,
     xlab <span class="op">=</span> <span class="st">"Variable x (xunits)"</span>,
     ylab <span class="op">=</span> <span class="st">"Variable y (yunits)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-12-1.png" width="480"></div>
<p>Note that depending on where you intend to display the plot, you may leave the title blank and instead place it in the figure caption along with an explanation of the data (e.g. in a journal article)</p>
</div>
</div>
<div id="histogram" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> Histogram<a class="anchor" aria-label="anchor" href="#histogram"><i class="fas fa-link"></i></a>
</h2>
<p>Input: <strong>numeric vector</strong></p>
<p>A histogram displays an approximation of the distribution of a numeric vector. First the data is binned and then the number of elements that falls in each bin is counted. The histogram plot draws bars for each bin whose heights corresponds to the count of elements in the corresponding interval.</p>
<div class="sourceCode" id="cb1529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-13-1.png" width="480"></div>
<div id="col-bar-color" class="section level3" number="22.2.1">
<h3>
<span class="header-section-number">22.2.1</span> <strong><code>col</code></strong>: bar color<a class="anchor" aria-label="anchor" href="#col-bar-color"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"slategrey"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-14-1.png" width="480"></div>
</div>
<div id="border-border-color" class="section level3" number="22.2.2">
<h3>
<span class="header-section-number">22.2.2</span> <strong><code>border</code></strong>: border color<a class="anchor" aria-label="anchor" href="#border-border-color"><i class="fas fa-link"></i></a>
</h3>
<p>Setting border color to the same as the background gives a clean look:</p>
<div class="sourceCode" id="cb1531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"slategrey"</span>, border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-15-1.png" width="480"></div>
</div>
<div id="breaks-number-or-value-of-breakpoints" class="section level3" number="22.2.3">
<h3>
<span class="header-section-number">22.2.3</span> <code>breaks</code>: number or value of breakpoints<a class="anchor" aria-label="anchor" href="#breaks-number-or-value-of-breakpoints"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>breaks</code> argument can be used to define the breakpoints to use for the binning of the values of the input to <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code>. See the documentation in <code><a href="https://rdrr.io/r/graphics/hist.html">?hist</a></code> for the full range of options. An easy way to control the number of bins is to pass an integer to the <code>breaks</code> argument. Depending on the length of x and its distribution, it may or may not be possible to use the exact number requested, but the closest possible number will be automatically chosen.</p>
<div class="sourceCode" id="cb1532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"slategrey"</span>, border <span class="op">=</span> <span class="st">"white"</span>,
     breaks <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-16-1.png" width="480"></div>
</div>
</div>
<div id="density-plot" class="section level2" number="22.3">
<h2>
<span class="header-section-number">22.3</span> Density plot<a class="anchor" aria-label="anchor" href="#density-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Input: numeric vector</p>
<p>A density plot is a different way to display an approximation of the distribution of a numeric vector. The <code><a href="https://rdrr.io/r/stats/density.html">density()</a></code> function estimates the density of x and can be passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> directly:</p>
<div class="sourceCode" id="cb1533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-17-1.png" width="480"></div>
<p>You can use <code>main = NA</code> or <code>main = ""</code> to suppress printing a title.</p>
<div class="sourceCode" id="cb1534"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>,
     bty <span class="op">=</span> <span class="st">"n"</span>,
     main <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-18-1.png" width="480"></div>
</div>
<div id="barplot" class="section level2" number="22.4">
<h2>
<span class="header-section-number">22.4</span> Barplot<a class="anchor" aria-label="anchor" href="#barplot"><i class="fas fa-link"></i></a>
</h2>
<p>Input: <strong>vector</strong> or <strong>matrix</strong></p>
<p>Let’s look at the VADeaths built-in dataset which describes death rater per 1000 population per year broken down by age range and population group.</p>
<div id="single-vector" class="section level3" number="22.4.1">
<h3>
<span class="header-section-number">22.4.1</span> Single vector<a class="anchor" aria-label="anchor" href="#single-vector"><i class="fas fa-link"></i></a>
</h3>
<p>We can plot a single column or row. Note how R automatically gets the corresponding dimension names:</p>
<div class="sourceCode" id="cb1535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-19-1.png" width="480"></div>
<div class="sourceCode" id="cb1536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-20-1.png" width="480"></div>
<div id="col-and-border-bar-fill-and-border-color" class="section level4" number="22.4.1.1">
<h4>
<span class="header-section-number">22.4.1.1</span> <strong><code>col</code></strong> and <strong><code>border</code></strong>: bar fill and border color<a class="anchor" aria-label="anchor" href="#col-and-border-bar-fill-and-border-color"><i class="fas fa-link"></i></a>
</h4>
<p>As in most plotting functions, color is controlled by the <strong><code>col</code></strong> argument. <strong><code>border</code></strong> can be set to any color separately, or to <code>NA</code> to omit, which gives a clean look:</p>
<div class="sourceCode" id="cb1537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
        col <span class="op">=</span> <span class="st">"aquamarine3"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-21-1.png" width="480"></div>
</div>
</div>
<div id="matrix" class="section level3" number="22.4.2">
<h3>
<span class="header-section-number">22.4.2</span> Matrix<a class="anchor" aria-label="anchor" href="#matrix"><i class="fas fa-link"></i></a>
</h3>
<p>We can draw barplots of multiple columns at the same time by passing a matrix input. The grouping on the x-axis is based on the columns. By default, data from different rows is stacked. The argument <code>legend.text</code> can be used to add a legend with the row labels:</p>
<div class="sourceCode" id="cb1538"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>, legend.text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-22-1.png" width="480"></div>
<p>Alternatively, we can draw groups of bars beside each other with the argument <code>beside = TRUE</code>:</p>
<div class="sourceCode" id="cb1539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>, beside <span class="op">=</span> <span class="cn">TRUE</span>,
        legend.text <span class="op">=</span> <span class="cn">TRUE</span>, args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-23-1.png" width="672"></div>
<p>To use custom colors, we pass a vector of length equal to the number of bars within each group. These will get recycled across groups, giving a consistent color coding.<br>
Here, we use the <code><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor()</a></code> function again to produce 5 shades of navy.</p>
<div class="sourceCode" id="cb1540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"navy"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">VADeaths</span>,
        col <span class="op">=</span> <span class="va">col</span>,
        border <span class="op">=</span> <span class="cn">NA</span>,
        beside <span class="op">=</span> <span class="cn">TRUE</span>,
        legend.text <span class="op">=</span> <span class="cn">TRUE</span>, args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
</div>
<div id="formula-interface" class="section level3" number="22.4.3">
<h3>
<span class="header-section-number">22.4.3</span> Formula interface<a class="anchor" aria-label="anchor" href="#formula-interface"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="boxplot" class="section level2" number="22.5">
<h2>
<span class="header-section-number">22.5</span> Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"><i class="fas fa-link"></i></a>
</h2>
<p>Input: One or more <strong>vectors</strong> of any length</p>
<p>A boxplot is another way to visualize the distribution of one or more vectors. Each vector does not need to be of the same length. For example if you are plotting lab results of a patient and control group, they do not have to contain the same number of individuals.</p>
<p>There are two ways to use the <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> function. Either pass two separate vectors of data (whet)</p>
<p><code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> makes it easy to plot your data from different objects. It can accept:</p>
<ul>
<li>individual vectors</li>
<li>columns of a matrix, columns/elements of a data.frame, elements of a list</li>
<li>formula interface of the form <code>variable ~ factor</code>
</li>
</ul>
<div id="single-vector-1" class="section level3" number="22.5.1">
<h3>
<span class="header-section-number">22.5.1</span> Single vector<a class="anchor" aria-label="anchor" href="#single-vector-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-25-1.png" width="480"></div>
</div>
<div id="anatomy-of-a-boxplot" class="section level3" number="22.5.2">
<h3>
<span class="header-section-number">22.5.2</span> Anatomy of a boxplot<a class="anchor" aria-label="anchor" href="#anatomy-of-a-boxplot"><i class="fas fa-link"></i></a>
</h3>
<p>A boxplot shows:</p>
<ul>
<li>the median</li>
<li>first and third quartiles</li>
<li>outliers (defined as <code>x &lt; Q1 - 1.5 * IQR | x &gt; Q3 + 1.5 * IQR</code>)</li>
<li>range after excluding outliers</li>
</ul>
<div class="figure">
<span id="fig:boxanat"></span>
<img src="79-BaseGraphics_files/figure-html/boxanat-1.png" alt="Boxplot anatomy" width="480"><p class="caption">
Figure 22.1: Boxplot anatomy
</p>
</div>
<p>Some synthetic data:</p>
<div class="sourceCode" id="cb1542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, gamma <span class="op">=</span> <span class="va">gamma</span><span class="op">)</span></code></pre></div>
</div>
<div id="multiple-vectors" class="section level3" number="22.5.3">
<h3>
<span class="header-section-number">22.5.3</span> Multiple vectors<a class="anchor" aria-label="anchor" href="#multiple-vectors"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-27-1.png" width="480"></div>
</div>
<div id="list" class="section level3" number="22.5.4">
<h3>
<span class="header-section-number">22.5.4</span> List<a class="anchor" aria-label="anchor" href="#list"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">dl</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-28-1.png" width="480"></div>
</div>
<div id="matrix-1" class="section level3" number="22.5.5">
<h3>
<span class="header-section-number">22.5.5</span> Matrix<a class="anchor" aria-label="anchor" href="#matrix-1"><i class="fas fa-link"></i></a>
</h3>
<p>Passing a matrix to <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> draws one boxplot per column:</p>
<div class="sourceCode" id="cb1545"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-29-1.png" width="480"></div>
</div>
<div id="formula-interface-1" class="section level3" number="22.5.6">
<h3>
<span class="header-section-number">22.5.6</span> Formula interface<a class="anchor" aria-label="anchor" href="#formula-interface-1"><i class="fas fa-link"></i></a>
</h3>
<p>The formula interface can be used to group any vector by a factor of the same length.</p>
<p>Let’s use the built-in <code>sleep</code> dataset which shows the effect of two different drugs in increasing hours of sleep compared to a control group.</p>
<div class="sourceCode" id="cb1546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">sleep</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-30-1.png" width="480"></div>
<p>The <strong><code>col</code></strong> and <strong><code>border</code></strong> arguments work as expected. Here we define two custom colors using their hexadecimal RGB code and use the solid version for the border and a 50% transparent version for the fill. Note that we do not need two separate colors to produce an unambiguous plot since they are clearly labeled in the y-axis. It is often considered desirable/preferred to use the minimum number of different colors that is necessary. (Color coding like the following could be useful if for example data from the two groups were used on a different plot, like a scatterplot, in a multi-panel figure).</p>
<div class="sourceCode" id="cb1547"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">border</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#18A3AC"</span>, <span class="st">"#F48024"</span><span class="op">)</span>
<span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"#18A3AC"</span>, <span class="fl">.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"#F48024"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">sleep</span>,
        col <span class="op">=</span> <span class="va">col</span>, border <span class="op">=</span> <span class="va">border</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-31-1.png" width="480"></div>
</div>
<div id="names-group-labels" class="section level3" number="22.5.7">
<h3>
<span class="header-section-number">22.5.7</span> <strong><code>names</code></strong>: group labels<a class="anchor" aria-label="anchor" href="#names-group-labels"><i class="fas fa-link"></i></a>
</h3>
<p>The x-axis group names can be defined with the <code>names</code> argument:</p>
<div class="sourceCode" id="cb1548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">sleep</span>,
        col <span class="op">=</span> <span class="va">col</span>, border <span class="op">=</span> <span class="va">border</span>,
        names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Drug A"</span>, <span class="st">"Drug B"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-32-1.png" width="480"></div>
</div>
</div>
<div id="heatmap" class="section level2" number="22.6">
<h2>
<span class="header-section-number">22.6</span> Heatmap<a class="anchor" aria-label="anchor" href="#heatmap"><i class="fas fa-link"></i></a>
</h2>
<p>Input: <strong>matrix</strong></p>
<p>A heatmap is a 2D matrix-like plot with x- and y-axis labels and a value in each cell. It can be used to display many different types of data. A common usage in data science is to plot the correlation matrix of a set of numerical features. In many cases, the rows and/or columns of a heatmap can be reordered based on hierarchical clustering.</p>
<div class="sourceCode" id="cb1549"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="va">x_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p>By default, the <code><a href="https://rdrr.io/r/stats/heatmap.html">heatmap()</a></code> function draws marginal dendrograms and rearranges rows and columns. We can prevent that by setting <code>Rowv</code> and <code>Colv</code> to <code>NA</code>:</p>
<div class="sourceCode" id="cb1550"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="va">x_cor</span>, Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-34-1.png" width="480"></div>
<p>To allow clustering and row and column reordering, use the defaults:</p>
<div class="sourceCode" id="cb1551"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="va">x_cor</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-35-1.png" width="480"></div>
</div>
<div id="graphical-parameters" class="section level2" number="22.7">
<h2>
<span class="header-section-number">22.7</span> Graphical parameters<a class="anchor" aria-label="anchor" href="#graphical-parameters"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>par</code> function allows setting or querying graphical parameters of the base graphics system. Have a look at its documentation (<code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code>).<br>
Some graphical parameters can only be set with a call to <code>par</code> prior to using a base plotting function. However, many parameters can also be passed using the <code>...</code> construct of each base plotting function.</p>
<p>Some common base graphical parameters:</p>
<ul>
<li>
<em>pch</em>: Point character</li>
<li>
<em>col</em>: Color</li>
<li>
<em>cex</em>: Character expansion, i.e. relative size</li>
<li>
<em>bty</em>: Box type</li>
<li>
<em>xlab</em>: x-axis label</li>
<li>
<em>ylab</em>: y-axis label</li>
<li>
<em>main</em>: Main title</li>
</ul>
<p>Always make sure that your plotting characters, axis labels and titles are legible. You must avoid, at all costs, ever using a huge graph with tiny letters spread over an entire slide in a presentation.</p>
<ul>
<li>
<em>cex</em>: Character expansion for the plotting characters</li>
<li>
<em>cex.axis</em>: cex for axis annotation</li>
<li>
<em>cex.lab</em>: cex for x and y labels</li>
<li>
<em>cex.main</em>: cex for main title</li>
</ul>
<p>Note: All of these can be set either with a call to <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> prior to plotting or passed as arguments in a plotting command, like <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<p>There is one important distinction: <code>cex</code> set with <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> (which defaults to 1), sets the baseline and all other <code>cex</code> parameters multiply it. However, <code>cex</code> set within <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> still multiplies <code>cex</code> set with <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>, but only affects the plotting character size.</p>
</div>
<div id="multipanel-plots" class="section level2" number="22.8">
<h2>
<span class="header-section-number">22.8</span> Multipanel plots<a class="anchor" aria-label="anchor" href="#multipanel-plots"><i class="fas fa-link"></i></a>
</h2>
<p>There are different ways to create multipanel plots, but probably the most straightforward is to use either the <code>mfrow</code> or the <code>mfcol</code> argument of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>.</p>
<div class="sourceCode" id="cb1552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></code></pre></div>
<p>Both <code>mfrow</code> and <code>mfcol</code> accept an integer vector of length 2 indicating number of rows and number of columns, respectively. With <code>mfrow</code>, the plots are drawn row-wise and with <code>mfcol</code> they are drawn column-wise. Remember to reset <code>mfrow</code> or <code>mfcol</code> back to <code><a href="https://rdrr.io/r/base/c.html">c(1, 1)</a></code></p>
<p>For example, let’s plot a 2-by-3 panel of plots, drawn row-wise:</p>
<div class="sourceCode" id="cb1553"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">z</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-37-1.png" width="672"></div>
<div class="sourceCode" id="cb1554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="datatable.html"><span class="header-section-number">21</span> Efficient data analysis with data.table</a></div>
<div class="next"><a href="graphics3x.html"><span class="header-section-number">23</span> 3x Graphics</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#basegraphics"><span class="header-section-number">22</span> Base Graphics</a></li>
<li>
<a class="nav-link" href="#scatter-plot"><span class="header-section-number">22.1</span> Scatter plot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#col-point-color"><span class="header-section-number">22.1.1</span> col: point color</a></li>
<li><a class="nav-link" href="#bty-box-type"><span class="header-section-number">22.1.2</span> bty: box type</a></li>
<li><a class="nav-link" href="#pch-point-character"><span class="header-section-number">22.1.3</span> pch: point character</a></li>
<li><a class="nav-link" href="#grid"><span class="header-section-number">22.1.4</span> grid</a></li>
<li><a class="nav-link" href="#main-xlab-ylab-title-and-axes-labels"><span class="header-section-number">22.1.5</span> main, xlab, ylab: Title and axes labels</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#histogram"><span class="header-section-number">22.2</span> Histogram</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#col-bar-color"><span class="header-section-number">22.2.1</span> col: bar color</a></li>
<li><a class="nav-link" href="#border-border-color"><span class="header-section-number">22.2.2</span> border: border color</a></li>
<li><a class="nav-link" href="#breaks-number-or-value-of-breakpoints"><span class="header-section-number">22.2.3</span> breaks: number or value of breakpoints</a></li>
</ul>
</li>
<li><a class="nav-link" href="#density-plot"><span class="header-section-number">22.3</span> Density plot</a></li>
<li>
<a class="nav-link" href="#barplot"><span class="header-section-number">22.4</span> Barplot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#single-vector"><span class="header-section-number">22.4.1</span> Single vector</a></li>
<li><a class="nav-link" href="#matrix"><span class="header-section-number">22.4.2</span> Matrix</a></li>
<li><a class="nav-link" href="#formula-interface"><span class="header-section-number">22.4.3</span> Formula interface</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#boxplot"><span class="header-section-number">22.5</span> Boxplot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#single-vector-1"><span class="header-section-number">22.5.1</span> Single vector</a></li>
<li><a class="nav-link" href="#anatomy-of-a-boxplot"><span class="header-section-number">22.5.2</span> Anatomy of a boxplot</a></li>
<li><a class="nav-link" href="#multiple-vectors"><span class="header-section-number">22.5.3</span> Multiple vectors</a></li>
<li><a class="nav-link" href="#list"><span class="header-section-number">22.5.4</span> List</a></li>
<li><a class="nav-link" href="#matrix-1"><span class="header-section-number">22.5.5</span> Matrix</a></li>
<li><a class="nav-link" href="#formula-interface-1"><span class="header-section-number">22.5.6</span> Formula interface</a></li>
<li><a class="nav-link" href="#names-group-labels"><span class="header-section-number">22.5.7</span> names: group labels</a></li>
</ul>
</li>
<li><a class="nav-link" href="#heatmap"><span class="header-section-number">22.6</span> Heatmap</a></li>
<li><a class="nav-link" href="#graphical-parameters"><span class="header-section-number">22.7</span> Graphical parameters</a></li>
<li><a class="nav-link" href="#multipanel-plots"><span class="header-section-number">22.8</span> Multipanel plots</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Programming for Data Science in R</strong>" was written by Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD. It was last built on 2021-07-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
