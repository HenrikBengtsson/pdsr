<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 27 Introduction to the GLM | Programming for Data Science in R</title>
<meta name="author" content="Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><script src="libs/d3-3.5.6/d3.min.js"></script><link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet">
<script src="libs/profvis-0.3.6.9000/profvis.js"></script><script src="libs/profvis-0.3.6.9000/scroll.js"></script><link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet">
<script src="libs/highlight-6.2.0/highlight.js"></script><script src="libs/profvis-binding-0.3.7/profvis.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163213745-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-163213745-1');
    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="bootstrap.lambdamd.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Programming for Data Science in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">PDSR</a></li>
<li><a class="" href="preface.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="Rsetup.html"><span class="header-section-number">3</span> R setup, Packages &amp; Docs</a></li>
<li><a class="" href="basicops.html"><span class="header-section-number">4</span> Basic operations</a></li>
<li><a class="" href="types.html"><span class="header-section-number">5</span> Data Types</a></li>
<li><a class="" href="structures.html"><span class="header-section-number">6</span> Data Structures</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">7</span> Factors</a></li>
<li><a class="" href="indexing.html"><span class="header-section-number">8</span> Indexing - Subsetting - Slicing</a></li>
<li><a class="" href="vectorization.html"><span class="header-section-number">9</span> Vectorized Operations</a></li>
<li><a class="" href="dataio.html"><span class="header-section-number">10</span> Data Input/Output</a></li>
<li><a class="" href="controlflow.html"><span class="header-section-number">11</span> Control flow</a></li>
<li><a class="" href="loopfns.html"><span class="header-section-number">12</span> Loop Functions</a></li>
<li><a class="" href="summarize.html"><span class="header-section-number">13</span> Summarizing Data</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">14</span> Functions</a></li>
<li><a class="" href="dataframes.html"><span class="header-section-number">15</span> Working with data frames</a></li>
<li><a class="" href="datatrans.html"><span class="header-section-number">16</span> Data Transformations</a></li>
<li><a class="" href="stringops.html"><span class="header-section-number">17</span> String Operations</a></li>
<li><a class="" href="datetime.html"><span class="header-section-number">18</span> Date and Time</a></li>
<li><a class="" href="missingdata.html"><span class="header-section-number">19</span> Handling Missing data</a></li>
<li><a class="" href="classes.html"><span class="header-section-number">20</span> Classes and Object-Oriented Programming</a></li>
<li><a class="" href="datatable.html"><span class="header-section-number">21</span> Efficient data analysis with data.table</a></li>
<li><a class="" href="basegraphics.html"><span class="header-section-number">22</span> Base Graphics</a></li>
<li><a class="" href="graphics3x.html"><span class="header-section-number">23</span> 3x Graphics</a></li>
<li><a class="" href="colors.html"><span class="header-section-number">24</span> Colors in R</a></li>
<li><a class="" href="profiling.html"><span class="header-section-number">25</span> Timing &amp; Profiling</a></li>
<li><a class="" href="optim.html"><span class="header-section-number">26</span> Optimization with optim()</a></li>
<li><a class="active" href="glm.html"><span class="header-section-number">27</span> Introduction to the GLM</a></li>
<li><a class="" href="resampling.html"><span class="header-section-number">28</span> Resampling</a></li>
<li><a class="" href="supervised.html"><span class="header-section-number">29</span> Supervised Learning</a></li>
<li><a class="" href="unsupervised.html"><span class="header-section-number">30</span> Unsupervised Learning</a></li>
<li><a class="" href="git.html"><span class="header-section-number">31</span> Git &amp; GitHub: the basics</a></li>
<li><a class="" href="shell.html"><span class="header-section-number">32</span> Introduction to the system shell</a></li>
<li><a class="" href="resources.html"><span class="header-section-number">33</span> Resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="glm" class="section level1" number="27">
<h1>
<span class="header-section-number">27</span> Introduction to the GLM<a class="anchor" aria-label="anchor" href="#glm"><i class="fas fa-link"></i></a>
</h1>
<pre><code>##   .:rtemis 0.8.1: Welcome, egenn
##   [x86_64-apple-darwin17.0 (64-bit): Defaulting to 4/4 available cores]
##   Documentation &amp; vignettes: https://rtemis.lambdamd.org
##   Learn R: https://class.lambdamd.org/pdsr</code></pre>
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<div id="generalized-linear-model-glm" class="section level2" number="27.1">
<h2>
<span class="header-section-number">27.1</span> Generalized Linear Model (GLM)<a class="anchor" aria-label="anchor" href="#generalized-linear-model-glm"><i class="fas fa-link"></i></a>
</h2>
<p>The Generalized Linear Model is one of the most common and important models in statistics.<br>
Let’s look at an example using the GLM for regression. We will use the <code>mtcars</code> builtin dataset to predict horsepower (<code>hp</code>) of 32 cars from 10 other features:</p>
<div class="sourceCode" id="cb1701"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></code></pre></div>
<pre><code>'data.frame':   32 obs. of  11 variables:
 $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
 $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
 $ disp: num  160 160 108 258 360 ...
 $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
 $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
 $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
 $ qsec: num  16.5 17 18.6 19.4 17 ...
 $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
 $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
 $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
 $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<div class="sourceCode" id="cb1703"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">hp</span> <span class="op">~</span> <span class="va">.</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>
<span class="va">mod</span></code></pre></div>
<pre><code>
Call:  glm(formula = hp ~ ., family = "gaussian", data = mtcars)

Coefficients:
(Intercept)          mpg          cyl         disp         drat           wt  
     79.048       -2.063        8.204        0.439       -4.619      -27.660  
       qsec           vs           am         gear         carb  
     -1.784       25.813        9.486        7.216       18.749  

Degrees of Freedom: 31 Total (i.e. Null);  21 Residual
Null Deviance:      145700 
Residual Deviance: 14160    AIC: 309.8</code></pre>
<div class="sourceCode" id="cb1705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "glm" "lm" </code></pre>
<p>The <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function accepts a formula that defines the model.<br>
The formula <code>hp ~ .</code> means “regress hp on all other variables.” The <code>family</code> argument defines we are performing regression and the <code>data</code> argument points to the data frame where the covariates used in the formula are found.</p>
<p>For a gaussian output, we can also use the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function. There are minor differences in the output created, but the model is the same:</p>
<div class="sourceCode" id="cb1707"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">hp</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>
<span class="va">mod</span></code></pre></div>
<pre><code>
Call:
lm(formula = hp ~ ., data = mtcars)

Coefficients:
(Intercept)          mpg          cyl         disp         drat           wt  
     79.048       -2.063        8.204        0.439       -4.619      -27.660  
       qsec           vs           am         gear         carb  
     -1.784       25.813        9.486        7.216       18.749  </code></pre>
<div class="sourceCode" id="cb1709"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "lm"</code></pre>
<div id="summary-1" class="section level3" number="27.1.1">
<h3>
<span class="header-section-number">27.1.1</span> Summary<a class="anchor" aria-label="anchor" href="#summary-1"><i class="fas fa-link"></i></a>
</h3>
<p>Get summary of the model using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb1711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = hp ~ ., data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.681 -15.558   0.799  18.106  34.718 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  79.0484   184.5041   0.428  0.67270   
mpg          -2.0631     2.0906  -0.987  0.33496   
cyl           8.2037    10.0861   0.813  0.42513   
disp          0.4390     0.1492   2.942  0.00778 **
drat         -4.6185    16.0829  -0.287  0.77680   
wt          -27.6600    19.2704  -1.435  0.16591   
qsec         -1.7844     7.3639  -0.242  0.81089   
vs           25.8129    19.8512   1.300  0.20758   
am            9.4863    20.7599   0.457  0.65240   
gear          7.2164    14.6160   0.494  0.62662   
carb         18.7487     7.0288   2.667  0.01441 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 25.97 on 21 degrees of freedom
Multiple R-squared:  0.9028,    Adjusted R-squared:  0.8565 
F-statistic:  19.5 on 10 and 21 DF,  p-value: 1.898e-08</code></pre>
<p>Note how R prints stars next to covariates whose p-values falls within certain limits, described right below the table of estimates.<br>
Above, for example, the p-value for <code>disp</code> falls between 0.001 and 0.01 and therefore gets highlighted with 2 stars.</p>
</div>
<div id="coefficients" class="section level3" number="27.1.2">
<h3>
<span class="header-section-number">27.1.2</span> Coefficients<a class="anchor" aria-label="anchor" href="#coefficients"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1713"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>(Intercept)         mpg         cyl        disp        drat          wt 
 79.0483879  -2.0630545   8.2037204   0.4390024  -4.6185488 -27.6600472 
       qsec          vs          am        gear        carb 
 -1.7843654  25.8128774   9.4862914   7.2164047  18.7486691 </code></pre>
<div class="sourceCode" id="cb1715"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># or</span>
<span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span></code></pre></div>
<pre><code>(Intercept)         mpg         cyl        disp        drat          wt 
 79.0483879  -2.0630545   8.2037204   0.4390024  -4.6185488 -27.6600472 
       qsec          vs          am        gear        carb 
 -1.7843654  25.8128774   9.4862914   7.2164047  18.7486691 </code></pre>
</div>
<div id="fitted-values" class="section level3" number="27.1.3">
<h3>
<span class="header-section-number">27.1.3</span> Fitted values<a class="anchor" aria-label="anchor" href="#fitted-values"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1717"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
          148.68122           140.62866            79.99158           125.75448 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
          183.21756           111.38490           228.02497            77.13692 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
           72.71717           146.00088           147.81854           152.01285 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
          159.20364           161.43931           236.24493           226.12625 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
          210.31169            48.04587            83.55415            50.29692 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
           65.46675           171.23732           165.49280           216.59542 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
          188.81358            67.04615            84.64992           110.35672 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
          253.68881           188.34908           300.28196            93.42896 </code></pre>
<div class="sourceCode" id="cb1719"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># or</span>
<span class="va">mod</span><span class="op">$</span><span class="va">fitted.values</span></code></pre></div>
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
          148.68122           140.62866            79.99158           125.75448 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
          183.21756           111.38490           228.02497            77.13692 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
           72.71717           146.00088           147.81854           152.01285 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
          159.20364           161.43931           236.24493           226.12625 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
          210.31169            48.04587            83.55415            50.29692 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
           65.46675           171.23732           165.49280           216.59542 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
          188.81358            67.04615            84.64992           110.35672 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
          253.68881           188.34908           300.28196            93.42896 </code></pre>
</div>
<div id="residuals" class="section level3" number="27.1.4">
<h3>
<span class="header-section-number">27.1.4</span> Residuals<a class="anchor" aria-label="anchor" href="#residuals"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
         -38.681220          -30.628664           13.008418          -15.754483 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
          -8.217565           -6.384902           16.975025          -15.136925 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
          22.282827          -23.000881          -24.818538           27.987149 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
          20.796356           18.560690          -31.244931          -11.126253 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
          19.688306           17.954127          -31.554152           14.703084 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
          31.533250          -21.237322          -15.492798           28.404576 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
         -13.813582           -1.046152            6.350078            2.643283 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
          10.311194          -13.349075           34.718037           15.571042 </code></pre>
<div class="sourceCode" id="cb1723"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># or</span>
<span class="va">mod</span><span class="op">$</span><span class="va">residuals</span></code></pre></div>
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
         -38.681220          -30.628664           13.008418          -15.754483 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
          -8.217565           -6.384902           16.975025          -15.136925 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
          22.282827          -23.000881          -24.818538           27.987149 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
          20.796356           18.560690          -31.244931          -11.126253 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
          19.688306           17.954127          -31.554152           14.703084 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
          31.533250          -21.237322          -15.492798           28.404576 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
         -13.813582           -1.046152            6.350078            2.643283 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
          10.311194          -13.349075           34.718037           15.571042 </code></pre>
</div>
<div id="p-values" class="section level3" number="27.1.5">
<h3>
<span class="header-section-number">27.1.5</span> p-values<a class="anchor" aria-label="anchor" href="#p-values"><i class="fas fa-link"></i></a>
</h3>
<p>To extract the p-values of the intercept and each coefficient, we use <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> on <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>. The final (4th) column lists the p-values:</p>
<div class="sourceCode" id="cb1725"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>               Estimate  Std. Error    t value    Pr(&gt;|t|)
(Intercept)  79.0483879 184.5040756  0.4284371 0.672695339
mpg          -2.0630545   2.0905650 -0.9868407 0.334955314
cyl           8.2037204  10.0861425  0.8133655 0.425134929
disp          0.4390024   0.1492007  2.9423609 0.007779725
drat         -4.6185488  16.0829171 -0.2871711 0.776795845
wt          -27.6600472  19.2703681 -1.4353668 0.165910518
qsec         -1.7843654   7.3639133 -0.2423121 0.810889101
vs           25.8128774  19.8512410  1.3003156 0.207583411
am            9.4862914  20.7599371  0.4569518 0.652397317
gear          7.2164047  14.6160152  0.4937327 0.626619355
carb         18.7486691   7.0287674  2.6674192 0.014412403</code></pre>
</div>
<div id="plot-linear-fit" class="section level3" number="27.1.6">
<h3>
<span class="header-section-number">27.1.6</span> Plot linear fit<a class="anchor" aria-label="anchor" href="#plot-linear-fit"><i class="fas fa-link"></i></a>
</h3>
<p>You use <code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code> to add a line on top of a scatterplot drawn with <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.<br><code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code> accepts <code>x</code> and <code>y</code> vectors of coordinates:</p>
<div class="sourceCode" id="cb1727"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">.73</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>
<span class="va">xy.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">fitted</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"#18A3AC99"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xy.fit</span>, col <span class="op">=</span> <span class="st">"#178CCB"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="85-GLM_files/figure-html/unnamed-chunk-11-1.png" width="432"></div>
<p>In <strong>rtemis</strong>, you can use argument <code>fit</code> to use any supported algorithm (see <code><a href="https://rdrr.io/pkg/rtemis/man/modSelect.html">modSelect()</a></code>) to estimate the fit:</p>
<div class="sourceCode" id="cb1728"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rtemis/man/mplot3.xy.html">mplot3.xy</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fit <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="85-GLM_files/figure-html/unnamed-chunk-12-1.png" width="432"></div>
</div>
<div id="classification" class="section level3" number="27.1.7">
<h3>
<span class="header-section-number">27.1.7</span> Classification<a class="anchor" aria-label="anchor" href="#classification"><i class="fas fa-link"></i></a>
</h3>
<p>For classification, you use <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> with <code>family = binomial</code></p>
<div class="sourceCode" id="cb1729"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">PimaIndiansDiabetes2</span>, package <span class="op">=</span> <span class="st">'mlbench'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">PimaIndiansDiabetes2</span><span class="op">)</span></code></pre></div>
<pre><code>'data.frame':   768 obs. of  9 variables:
 $ pregnant: num  6 1 8 1 0 5 3 10 2 8 ...
 $ glucose : num  148 85 183 89 137 116 78 115 197 125 ...
 $ pressure: num  72 66 64 66 40 74 50 NA 70 96 ...
 $ triceps : num  35 29 NA 23 35 NA 32 NA 45 NA ...
 $ insulin : num  NA NA NA 94 168 NA 88 NA 543 NA ...
 $ mass    : num  33.6 26.6 23.3 28.1 43.1 25.6 31 35.3 30.5 NA ...
 $ pedigree: num  0.627 0.351 0.672 0.167 2.288 ...
 $ age     : num  50 31 32 21 33 30 26 29 53 54 ...
 $ diabetes: Factor w/ 2 levels "neg","pos": 2 1 2 1 2 1 2 1 2 2 ...</code></pre>
<div class="sourceCode" id="cb1731"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diabetes_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">PimaIndiansDiabetes2</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="va">diabetes_mod</span></code></pre></div>
<pre><code>
Call:  glm(formula = diabetes ~ ., family = "binomial", data = PimaIndiansDiabetes2)

Coefficients:
(Intercept)     pregnant      glucose     pressure      triceps      insulin  
 -1.004e+01    8.216e-02    3.827e-02   -1.420e-03    1.122e-02   -8.253e-04  
       mass     pedigree          age  
  7.054e-02    1.141e+00    3.395e-02  

Degrees of Freedom: 391 Total (i.e. Null);  383 Residual
  (376 observations deleted due to missingness)
Null Deviance:      498.1 
Residual Deviance: 344  AIC: 362</code></pre>
<div class="sourceCode" id="cb1733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">diabetes_mod</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
glm(formula = diabetes ~ ., family = "binomial", data = PimaIndiansDiabetes2)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.7823  -0.6603  -0.3642   0.6409   2.5612  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.004e+01  1.218e+00  -8.246  &lt; 2e-16 ***
pregnant     8.216e-02  5.543e-02   1.482  0.13825    
glucose      3.827e-02  5.768e-03   6.635 3.24e-11 ***
pressure    -1.420e-03  1.183e-02  -0.120  0.90446    
triceps      1.122e-02  1.708e-02   0.657  0.51128    
insulin     -8.253e-04  1.306e-03  -0.632  0.52757    
mass         7.054e-02  2.734e-02   2.580  0.00989 ** 
pedigree     1.141e+00  4.274e-01   2.669  0.00760 ** 
age          3.395e-02  1.838e-02   1.847  0.06474 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 498.10  on 391  degrees of freedom
Residual deviance: 344.02  on 383  degrees of freedom
  (376 observations deleted due to missingness)
AIC: 362.02

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div id="mass-univariate-analysis" class="section level2" number="27.2">
<h2>
<span class="header-section-number">27.2</span> Mass-univariate analysis<a class="anchor" aria-label="anchor" href="#mass-univariate-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>There are many cases where we have a large number of predictors and, along with any other number of tests or models, we may want to regress our outcome of interest on each covariate, one at a time.</p>
<p>Let’s create some synthetic data with 1000 cases and 100 covariates<br>
The outcome is generated using just 4 of those 100 covariates and has added noise.</p>
<div class="sourceCode" id="cb1735"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">n_col</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">n_row</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">n_col</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_row</span><span class="op">)</span><span class="op">)</span>,
                   col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Feature_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">n_col</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 1000  100</code></pre>
<div class="sourceCode" id="cb1737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">.7</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">10</span><span class="op">]</span> <span class="op">+</span> <span class="fl">.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">20</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">30</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">50</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></code></pre></div>
<p>Let’s fit a linear model regressing y on each column of x using <code>lm</code>:</p>
<div class="sourceCode" id="cb1738"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.xy.massuni</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mod.xy.massuni</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode" id="cb1740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">mod.xy.massuni</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"mod"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To extract p-values for each model, we must find where exactly to look.<br>
Let’s look into the first model:</p>
<div class="sourceCode" id="cb1741"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">ms1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.xy.massuni</span><span class="op">$</span><span class="va">mod1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x[, i])

Residuals:
    Min      1Q  Median      3Q     Max 
-8.5402 -1.4881 -0.0618  1.4968  5.8152 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.61800    0.06878   8.985   &lt;2e-16 ***
x[, i]       0.08346    0.06634   1.258    0.209    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.174 on 998 degrees of freedom
Multiple R-squared:  0.001584,  Adjusted R-squared:  0.0005831 
F-statistic: 1.583 on 1 and 998 DF,  p-value: 0.2086</code></pre>
<div class="sourceCode" id="cb1743"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ms1</span><span class="op">$</span><span class="va">coefficients</span></code></pre></div>
<pre><code>              Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 0.61800326 0.06878142 8.985032 1.266204e-18
x[, i]      0.08346393 0.06634074 1.258110 2.086464e-01</code></pre>
<p>The p-values for each feature is stored in row 1, column 4 fo the coefficients matrix. Let’s extract all of them:</p>
<div class="sourceCode" id="cb1745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.xy.massuni.pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">mod.xy.massuni</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Let’s see which variable are significant at the 0.05:</p>
<div class="sourceCode" id="cb1746"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mod.xy.massuni.pvals</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span></code></pre></div>
<pre><code> mod5 mod10 mod12 mod20 mod28 mod30 mod42 mod50 mod61 mod65 mod72 mod82 mod85 
    5    10    12    20    28    30    42    50    61    65    72    82    85 
mod91 mod94 mod99 
   91    94    99 </code></pre>
<p>…and which are significant at the 0.01 level:</p>
<div class="sourceCode" id="cb1748"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mod.xy.massuni.pvals</span> <span class="op">&lt;</span> <span class="fl">.01</span><span class="op">)</span></code></pre></div>
<pre><code>mod10 mod20 mod28 mod30 mod50 
   10    20    28    30    50 </code></pre>
</div>
<div id="multiple-comparison-correction" class="section level2" number="27.3">
<h2>
<span class="header-section-number">27.3</span> Multiple comparison correction<a class="anchor" aria-label="anchor" href="#multiple-comparison-correction"><i class="fas fa-link"></i></a>
</h2>
<p>We’ve performed a large number of tests and before reporting the results, we need to control for <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">multiple comparisons</a>.<br>
To do that, we use R’s <code><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust()</a></code> function. It adjusts a vector of p-values to account for multiple comparisons using one of multiple methods. The default, and recommended, is the <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm method</a>. It ensures that <code>FWER &lt; α</code>, i.e. controls the <a href="https://en.wikipedia.org/wiki/Family-wise_error_rate">family-wise error rate</a>, a.k.a. the probability of making one or more false discoveries (Type I errors)</p>
<div class="sourceCode" id="cb1750"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.xy.massuni.pvals.holm_adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="va">mod.xy.massuni.pvals</span><span class="op">)</span></code></pre></div>
<p>Now, let’s see which features’ p-values survive the magical .05 threshold:</p>
<div class="sourceCode" id="cb1751"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">mod.xy.massuni.pvals.holm_adjusted</span> <span class="op">&lt;</span> <span class="fl">.05</span><span class="op">)</span></code></pre></div>
<pre><code>mod10 mod20 mod30 mod50 
   10    20    30    50 </code></pre>
<p>These are indeed the correct features (not surprisingly, still reassuringly).</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="optim.html"><span class="header-section-number">26</span> Optimization with optim()</a></div>
<div class="next"><a href="resampling.html"><span class="header-section-number">28</span> Resampling</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#glm"><span class="header-section-number">27</span> Introduction to the GLM</a></li>
<li>
<a class="nav-link" href="#generalized-linear-model-glm"><span class="header-section-number">27.1</span> Generalized Linear Model (GLM)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summary-1"><span class="header-section-number">27.1.1</span> Summary</a></li>
<li><a class="nav-link" href="#coefficients"><span class="header-section-number">27.1.2</span> Coefficients</a></li>
<li><a class="nav-link" href="#fitted-values"><span class="header-section-number">27.1.3</span> Fitted values</a></li>
<li><a class="nav-link" href="#residuals"><span class="header-section-number">27.1.4</span> Residuals</a></li>
<li><a class="nav-link" href="#p-values"><span class="header-section-number">27.1.5</span> p-values</a></li>
<li><a class="nav-link" href="#plot-linear-fit"><span class="header-section-number">27.1.6</span> Plot linear fit</a></li>
<li><a class="nav-link" href="#classification"><span class="header-section-number">27.1.7</span> Classification</a></li>
</ul>
</li>
<li><a class="nav-link" href="#mass-univariate-analysis"><span class="header-section-number">27.2</span> Mass-univariate analysis</a></li>
<li><a class="nav-link" href="#multiple-comparison-correction"><span class="header-section-number">27.3</span> Multiple comparison correction</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Programming for Data Science in R</strong>" was written by Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD. It was last built on 2021-07-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
