<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>7 Factors | Programming for Data Science in R</title>

    <meta name="author" content="Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD" />
  
   <meta name="description" content="7 Factors | Programming for Data Science in R is a project to build an online resource for (Bio)statisticians / Epidemiologists / (Health) Data Scientists" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="7 Factors | Programming for Data Science in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="7 Factors | Programming for Data Science in R is a project to build an online resource for (Bio)statisticians / Epidemiologists / (Health) Data Scientists" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Factors | Programming for Data Science in R" />
  
  <meta name="twitter:description" content="7 Factors | Programming for Data Science in R is a project to build an online resource for (Bio)statisticians / Epidemiologists / (Health) Data Scientists" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.3.1/transition.js"></script>
    <script src="libs/bs3compat-0.3.1/tabs.js"></script>
    <script src="libs/bs3compat-0.3.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
    <script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
    <script src="libs/d3-3.5.6/d3.min.js"></script>
    <link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
    <script src="libs/profvis-0.3.6.9000/profvis.js"></script>
    <script src="libs/profvis-0.3.6.9000/scroll.js"></script>
    <link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
    <script src="libs/highlight-6.2.0/highlight.js"></script>
    <script src="libs/profvis-binding-0.3.7/profvis.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127457544-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-127457544-1');
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="bootstrap.lambdamd.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Programming for Data Science in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="factors" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Factors</h1>
<p>Factors in R are used to store <strong>categorical variables</strong> and therefore have many important uses in statistics / data science / machine learning.</p>
<p>For example, factors can be used to store information on sex, race, diagnosis, treatment
group, etc.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:FigRFactors"></span>
<img src="R_factors.png" alt="Factors in R - Best to read through this chapter first and then refer back to this figure" width="80%" />
<p class="caption">
Figure 7.1: Factors in R - Best to read through this chapter first and then refer back to this figure
</p>
</div>
<p>If you are new to R and to factors, read the “Factors (introductory)” section.</p>
<div id="factors-introductory" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Factors (introductory)</h2>
<div class="rmdnote">
<p>
Factors in R are a special type of vector.
</p>
<ul>
<li>
<p>
Each element can take a value from a set of values known as the factor’s levels
</p>
</li>
<li>
<p>
A factor’s levels are stored in a particular order, which affects how that factor is treated by some functions.
</p>
</li>
<li>
<p>
You can specify whether the order of the levels defines a quantitative relationship such that level1 &lt; level2, etc.
</p>
</li>
</ul>
</div>
<p>You can create a factor by passing a numeric or character vector to <code>factor()</code> or to <code>as.factor()</code>.<br />
The difference is that <code>as.factor()</code> does not accept any arguments while <code>factor()</code> does.</p>
<p>Let’s start with a character vector that includes three unique values - “a”, “b”, and “c”:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="factors.html#cb416-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb416-2"><a href="factors.html#cb416-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] &quot;a&quot; &quot;c&quot; &quot;b&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
<p>Assume that “a”, “b”, and “c” define three different groups and we want to convert this
character vector to a factor.<br />
<code>as.factor()</code> and <code>factor()</code> without any arguments produce the same output:</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="factors.html#cb418-1" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(x)</span>
<span id="cb418-2"><a href="factors.html#cb418-2" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code>[1] a c b b a a b c
Levels: a b c</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="factors.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(xf)</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="factors.html#cb422-1" aria-hidden="true" tabindex="-1"></a>xftoo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x)</span>
<span id="cb422-2"><a href="factors.html#cb422-2" aria-hidden="true" tabindex="-1"></a>xftoo</span></code></pre></div>
<pre><code>[1] a c b b a a b c
Levels: a b c</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="factors.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(xftoo)</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<p>Notice that when a factor is printed in the R console:</p>
<ul>
<li>The elements are printed without double quotes around them, differentiating them from character
vectors.</li>
<li>The factor levels are printed below the vector values.</li>
</ul>
<p><code>table()</code> is a very useful function for factors - it gives the counts for each level:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="factors.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(xf)</span></code></pre></div>
<pre><code>xf
a b c 
3 3 2 </code></pre>
<p>Let’s look at a different example. We define a factor to identify cases and controls:</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="factors.html#cb428-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>))</span>
<span id="cb428-2"><a href="factors.html#cb428-2" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<pre><code>[1] case    control control case    control
Levels: case control</code></pre>
<p>By default, the levels are ordered alphabeticaly.</p>
<div id="set-the-order-of-factor-levels" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Set the order of factor levels</h3>
<p>You can define the order of the factor levels with the <code>level</code> argument of the <code>factor()</code> function.</p>
<p>(For example, the first factor level is used as the baseline in some statistical operations, e.g. <code>glm()</code>, in which case the “control” level should be first.)</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="factors.html#cb430-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>),</span>
<span id="cb430-2"><a href="factors.html#cb430-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>))</span>
<span id="cb430-3"><a href="factors.html#cb430-3" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<pre><code>[1] case    control control case    control
Levels: control case</code></pre>
<p>The <code>levels</code> argument can include values not present in the input data vector. This may be used for example when some known categories are not present in your sample, but may be added in the future,
or you want specifically show they are absent in a table or a plot, etc.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="factors.html#cb432-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;Type I&quot;</span>, <span class="st">&quot;Type III&quot;</span>, <span class="st">&quot;Type III&quot;</span>, <span class="st">&quot;Type I&quot;</span>),</span>
<span id="cb432-2"><a href="factors.html#cb432-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Type I&quot;</span>, <span class="st">&quot;Type II&quot;</span>, <span class="st">&quot;Type III&quot;</span>))</span>
<span id="cb432-3"><a href="factors.html#cb432-3" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<pre><code>[1] Type I   Type III Type III Type I  
Levels: Type I Type II Type III</code></pre>
<p>On the other hand, if the <code>levels</code> argument is specified and does not include one or more of the values present in the input data vector, the corresponding elements become <code>NA</code>:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="factors.html#cb434-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;undefined&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;undefined&quot;</span>),</span>
<span id="cb434-2"><a href="factors.html#cb434-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;case&quot;</span>))</span>
<span id="cb434-3"><a href="factors.html#cb434-3" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<pre><code>[1] case    control &lt;NA&gt;    control case    control &lt;NA&gt;   
Levels: control case</code></pre>
</div>
<div id="define-level-labels" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Define level labels</h3>
<p>You can define level names or labels other than the values in the input vector using
the <code>labels</code> argument:</p>
<p>Assume you started with the following character vector</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="factors.html#cb436-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>)</span></code></pre></div>
<p>You can attach different labels to each level rather than default to “female” and “male”
by passing a character vector to the <code>labels</code> arguments:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="factors.html#cb437-1" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))</span>
<span id="cb437-2"><a href="factors.html#cb437-2" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code>[1] F F M F M
Levels: F M</code></pre>
<p>The order of names in the <code>labels</code> argument must match the order of levels. In the above example, the levels default to <code>c("female", "male")</code> because they are sorted alphabeticaly if not specified.
Otherwise, we can specify both the <code>levels</code> and <code>labels</code> arguments to define both order of levels and provide new labels:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="factors.html#cb439-1" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>))</span>
<span id="cb439-2"><a href="factors.html#cb439-2" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code>[1] F F M F M
Levels: M F</code></pre>
</div>
<div id="change-level-labels-of-existing-factor" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Change level labels of existing factor</h3>
<p>We can change the level labels of a factor object</p>
<ul>
<li>using the <code>factor()</code> command in the same way we create a factor from a character or other vector</li>
<li>using the <code>levels()</code> command</li>
</ul>
<p>Start with a factor of two groups and change labels using the <code>factor()</code> command:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="factors.html#cb441-1" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;GroupA&quot;</span>, <span class="st">&quot;GroupB&quot;</span>, <span class="st">&quot;GroupB&quot;</span>, <span class="st">&quot;GroupA&quot;</span>))</span>
<span id="cb441-2"><a href="factors.html#cb441-2" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(xf, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span>
<span id="cb441-3"><a href="factors.html#cb441-3" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code>[1] A B B A
Levels: A B</code></pre>
<p>Start with the same factor and change labels using the <code>levels()</code> command.</p>
<p>This is similar to using <code>colnames()</code> on a data.frame and is much faster than using <code>factor()</code> as above:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="factors.html#cb443-1" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;GroupA&quot;</span>, <span class="st">&quot;GroupB&quot;</span>, <span class="st">&quot;GroupB&quot;</span>, <span class="st">&quot;GroupA&quot;</span>))</span>
<span id="cb443-2"><a href="factors.html#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(xf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)</span>
<span id="cb443-3"><a href="factors.html#cb443-3" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code>[1] A B B A
Levels: A B</code></pre>
<div class="rmdcaution">
<p>
The <code>levels()</code> command changes the names of the levels. It cannot be used to change the order of levels, which must be done with <code>factor()</code>
</p>
</div>
</div>
</div>
<div id="factors-advanced" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Factors (advanced)</h2>
<div class="rmdnote">
<p>
A factor is a vector A factor contains three crucial pieces of information:
</p>
<ol style="list-style-type: decimal">
<li>
<p>
The underlying <strong>integer vector</strong>
</p>
</li>
<li>
<p>
The <strong>mapping of integers to labels</strong>
</p>
</li>
<li>
<p>
Whether the factor is <strong>ordered</strong>
</p>
</li>
</ol>
</div>
<p>Let’s unpack these.</p>
<p>Begin with a simple factor:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="factors.html#cb445-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;male&quot;</span>))</span>
<span id="cb445-2"><a href="factors.html#cb445-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] female female female male   male  
Levels: female male</code></pre>
<p>Internally, the command sees there are two distinct labels, female and male, and defaults to assigning integer numbers alphabetically, in this case female has been mapped to ‘1’ and male to ‘2’.</p>
<p>Printing a factor prints the vector of labels followed by the levels, i.e. the unique labels.</p>
<div id="the-underlying-integer-vector" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> The underlying <strong>integer vector</strong></h3>
<p>Each level is assigned an integer. (Internally, this is the “data” that forms the elements of a factor vector). You don’t see these integers unless you convert the factor to numeric (<code>as.numeric()</code>) or look at the (truncated) output of <code>str()</code></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="factors.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(x)</span></code></pre></div>
<pre><code>[1] 1 1 1 2 2</code></pre>
</div>
<div id="the-mapping-of-integers-to-labels" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> The <strong>mapping of integers to labels</strong></h3>
<p>This defines which integer is mapped to which label, i.e. whether 1 is mapped to male or female. You can store the same information regardless which one you choose to call 1 and 2.</p>
<p>To get the mapping you can use <code>levels()</code>. It prints the labels in order:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="factors.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(x)</span></code></pre></div>
<pre><code>[1] &quot;female&quot; &quot;male&quot;  </code></pre>
<p>Again, this means that female is mapped to 1 and male is mapped to 2.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="factors.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code> Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 1 2 2</code></pre>
<p>The above tells you that x is a factor,<br />
it has two levels labeled as “female” and “male”, in that order, i.e. female is level 1 and male is level 2.<br />
The last part shows that the first five elements (in this case the whole vector) consists of three elements of level 1 (female) followed by 2 elements of level 2 (male)</p>
<div id="setting-new-level-labels" class="section level4" number="7.2.2.1">
<h4><span class="header-section-number">7.2.2.1</span> Setting new level labels</h4>
<p>You can use the <code>levels()</code> command with an assignment to assign new labels to a factor (same syntax to how you use <code>rownames()</code> or <code>colnames()</code> to assign new row or column names to a matrix or data frame)</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="factors.html#cb453-1" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;patient_status_positive&quot;</span>, <span class="st">&quot;patient_status_negative&quot;</span>), <span class="dv">10</span>, T),</span>
<span id="cb453-2"><a href="factors.html#cb453-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;patient_status_positive&quot;</span>, <span class="st">&quot;patient_status_negative&quot;</span>))</span>
<span id="cb453-3"><a href="factors.html#cb453-3" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code> [1] patient_status_negative patient_status_positive patient_status_positive
 [4] patient_status_positive patient_status_positive patient_status_positive
 [7] patient_status_negative patient_status_positive patient_status_positive
[10] patient_status_positive
Levels: patient_status_positive patient_status_negative</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="factors.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(xf)</span></code></pre></div>
<pre><code>[1] &quot;patient_status_positive&quot; &quot;patient_status_negative&quot;</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="factors.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(xf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;positive&quot;</span>, <span class="st">&quot;negative&quot;</span>)</span>
<span id="cb457-2"><a href="factors.html#cb457-2" aria-hidden="true" tabindex="-1"></a>xf</span></code></pre></div>
<pre><code> [1] negative positive positive positive positive positive negative positive
 [9] positive positive
Levels: positive negative</code></pre>
</div>
<div id="defining-the-mapping-of-labels-to-integers" class="section level4" number="7.2.2.2">
<h4><span class="header-section-number">7.2.2.2</span> Defining the mapping of labels to integers</h4>
<p>If you want to define the mapping of labels to their integer representation (and not default to them sorted alphabeticaly), you use the <code>levels</code> arguments of the <code>factor()</code> function.</p>
<p>The vector passed to the <code>levels</code> arguments must include at least all unique values passed to <code>factor()</code>, otherwise you will get <code>NA</code> values</p>
<p>Without defining <code>levels</code> they are assigned alphabeticaly:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="factors.html#cb459-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>, <span class="st">&quot;delta&quot;</span>))</span>
<span id="cb459-2"><a href="factors.html#cb459-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] alpha alpha gamma delta delta
Levels: alpha delta gamma</code></pre>
<p>Define <code>levels</code>:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="factors.html#cb461-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>, <span class="st">&quot;delta&quot;</span>),</span>
<span id="cb461-2"><a href="factors.html#cb461-2" aria-hidden="true" tabindex="-1"></a> <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>))</span>
<span id="cb461-3"><a href="factors.html#cb461-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] alpha alpha gamma delta delta
Levels: alpha gamma delta</code></pre>
<p>The <code>table</code> command has a number of useful applications, in it simplest form, it tabulates number of elements with each unique value found in a vector:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="factors.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x)</span></code></pre></div>
<pre><code>x
alpha gamma delta 
    2     1     2 </code></pre>
<p>If you forget (or choose to exclude) a level, all occurences are replaced by <code>NA</code>:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="factors.html#cb465-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>, <span class="st">&quot;delta&quot;</span>),</span>
<span id="cb465-2"><a href="factors.html#cb465-2" aria-hidden="true" tabindex="-1"></a> <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;gamma&quot;</span>))</span>
<span id="cb465-3"><a href="factors.html#cb465-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] alpha alpha gamma &lt;NA&gt;  &lt;NA&gt; 
Levels: alpha gamma</code></pre>
<p>If you know that more levels exist, even if no examples are present in your sample, you can includes these extra levels:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="factors.html#cb467-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>, <span class="st">&quot;delta&quot;</span>),</span>
<span id="cb467-2"><a href="factors.html#cb467-2" aria-hidden="true" tabindex="-1"></a> <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>))</span>
<span id="cb467-3"><a href="factors.html#cb467-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] alpha alpha gamma delta delta
Levels: alpha beta gamma delta</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="factors.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x)</span></code></pre></div>
<pre><code>x
alpha  beta gamma delta 
    2     0     1     2 </code></pre>
</div>
</div>
<div id="is-the-factor-ordered" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Is the factor <strong>ordered</strong></h3>
<p>We looked at how you can define the order of levels using the <code>levels</code> argument in <code>factor()</code>, which affects the integer mapping to each label.</p>
<p>This can affect how some applications treat the different levels.</p>
<p>On top of the order of the mapping, you can further define if there is a <em>quantitative relationship</em> among levels of the form <code>level 1 &lt; level 2 &lt; ... &lt; level n</code>. This, in turn, can affect how the factor is treated by some functions, like some functions that fit statistical models.</p>
<div class="rmdnote">
<p>
All factors’ levels appear in some order or other.
</p>
<p>
An <strong>ordered factor</strong> indicates that its levels have a quantitative relationship of the form <code>level 1 &lt; level 2 &lt; … &lt; level n</code>.
</p>
</div>
<p>First an unordered factor:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="factors.html#cb471-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;large&quot;</span>), <span class="dv">10</span>, <span class="cn">TRUE</span>)</span>
<span id="cb471-2"><a href="factors.html#cb471-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat)</span>
<span id="cb471-3"><a href="factors.html#cb471-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code> [1] small  medium large  large  medium small  large  large  small  medium
Levels: large medium small</code></pre>
<p>To make the above into an ordered factor, we need to define the order of the levels with the <code>levels</code> arguments and also specify that it is ordered with the <code>ordered</code> argument:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="factors.html#cb473-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat,</span>
<span id="cb473-2"><a href="factors.html#cb473-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;large&quot;</span>),</span>
<span id="cb473-3"><a href="factors.html#cb473-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb473-4"><a href="factors.html#cb473-4" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code> [1] small  medium large  large  medium small  large  large  small  medium
Levels: small &lt; medium &lt; large</code></pre>
<p>Note how the levels now include the <code>&lt;</code> sign between levels to indicate the ordering.</p>
</div>
<div id="change-order-of-levels-or-labels" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Change order of levels or labels</h3>
<p>We’ve seen how to create a factor with defined order of levels and how to change level labels already. Because these are prone to serious accidents, let’s look at them again, together.</p>
<p><strong>To change the order of levels</strong> of an existing factor use <code>factor()</code>:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="factors.html#cb475-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;target&quot;</span>, <span class="st">&quot;target&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;control&quot;</span>))</span>
<span id="cb475-2"><a href="factors.html#cb475-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] target  target  control control control
Levels: control target</code></pre>
<p>Change the order so that target is first (i.e. corresponds to 1:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="factors.html#cb477-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;target&quot;</span>, <span class="st">&quot;control&quot;</span>))</span>
<span id="cb477-2"><a href="factors.html#cb477-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] target  target  control control control
Levels: target control</code></pre>
<p><strong>To change the labels of the levels</strong> use <code>levels()</code>:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="factors.html#cb479-1" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] target  target  control control control
Levels: target control</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="factors.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;hit&quot;</span>, <span class="st">&quot;decoy&quot;</span>)</span>
<span id="cb481-2"><a href="factors.html#cb481-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>[1] hit   hit   decoy decoy decoy
Levels: hit decoy</code></pre>
<div class="rmdcaution">
<p>
Changing the levels of a factor with <code>levels()</code> does not change the internal integer representation but changes every element’s label.
</p>
</div>
</div>
<div id="fatal-error-to-avoid" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Fatal error to avoid</h3>
<p>Example scenario: You receive a dataset for classification where the outcome is a factor of 1s and 0s:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="factors.html#cb483-1" aria-hidden="true" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb483-2"><a href="factors.html#cb483-2" aria-hidden="true" tabindex="-1"></a>outcome</span></code></pre></div>
<pre><code>[1] 1 1 0 0 0 1 0
Levels: 0 1</code></pre>
<p>Some classification procedures expect the first level to be the ‘positive’ outcome, so you decide to reorder the levels.</p>
<p>You mistakenly use <code>levels()</code> instead of <code>factor(x, levels=c(...))</code> hoping to achieve this.</p>
<p>You end up flipping all the outcome values.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="factors.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>)</span>
<span id="cb485-2"><a href="factors.html#cb485-2" aria-hidden="true" tabindex="-1"></a>outcome</span></code></pre></div>
<pre><code>[1] 0 0 1 1 1 0 1
Levels: 1 0</code></pre>
<p>All zeros became ones and ones became zeros.</p>
<p>Your model does the exact opposite of what you intended.</p>
</div>
<div id="factor-to-numeric" class="section level3" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Factor to numeric</h3>
<p>While it often makes sense to have factors with words for labels, they can be any character and that includes numbers (i.e. numbers which are treated as labels)</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="factors.html#cb487-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">9</span>))</span>
<span id="cb487-2"><a href="factors.html#cb487-2" aria-hidden="true" tabindex="-1"></a>f</span></code></pre></div>
<pre><code>[1] 3 7 7 9 3 3 9
Levels: 3 7 9</code></pre>
<p>This behaves just like any other factor with all the rules we learned above.</p>
<p>There is a very easy trap to fall into, if you ever decide to convert such a factor to numeric.</p>
<p>The first thing that usually comes to mind is to use <code>as.numeric()</code>.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="factors.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># !don&#39;t do this!</span></span>
<span id="cb489-2"><a href="factors.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(f)</span></code></pre></div>
<pre><code>[1] 1 2 2 3 1 1 3</code></pre>
<p>But! We already know this will return the integer index, it will not return the labels as numbers.</p>
<p>By understanding the internal representation of the factor, i.e. that a factor is an integer vector indexing a set of labels, you can convert labels to numeric exactly by indexing the set of labels:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="factors.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(f)[f]</span></code></pre></div>
<pre><code>[1] &quot;3&quot; &quot;7&quot; &quot;7&quot; &quot;9&quot; &quot;3&quot; &quot;3&quot; &quot;9&quot;</code></pre>
<p>The above suggests that used as an index within the brackets, <code>f</code> is coerced to integer, therefore to understand the above:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="factors.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(f)</span></code></pre></div>
<pre><code>[1] &quot;3&quot; &quot;7&quot; &quot;9&quot;</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="factors.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(f)[<span class="fu">as.integer</span>(f)]</span></code></pre></div>
<pre><code>[1] &quot;3&quot; &quot;7&quot; &quot;7&quot; &quot;9&quot; &quot;3&quot; &quot;3&quot; &quot;9&quot;</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="factors.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as</span></span>
<span id="cb497-2"><a href="factors.html#cb497-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(f)[f]</span></code></pre></div>
<pre><code>[1] &quot;3&quot; &quot;7&quot; &quot;7&quot; &quot;9&quot; &quot;3&quot; &quot;3&quot; &quot;9&quot;</code></pre>
<p>A different way around this that may be less confusing is to simply convert the factor to character and then to numeric:</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="factors.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(f))</span></code></pre></div>
<pre><code>[1] 3 7 7 9 3 3 9</code></pre>
</div>
</div>
<div id="summary" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Summary</h2>
<div class="rmdnote">
<ul>
<li>
<p>
Factors in R are <strong>integer vectors</strong> with labels.
</p>
</li>
<li>
<p>
A factor’s internal integer values range from 1 to the number of levels, i.e. categories.
</p>
</li>
<li>
<p>
Each integer corresponds to a label.
</p>
</li>
<li>
<p>
<strong>To set order of levels</strong>: <code>factor(x, levels = levels_in_desired_order)</code> to order levels
</p>
</li>
<li>
<p>
<strong>To change labels</strong>: <code>levels(x) &lt;- newlabels</code> or <code>factor(x, labels = newlabels)</code>
</p>
</li>
</ul>
</div>
<div class="rmdnote">
<p>
To avoid confusion, do not use numbers as level labels, if possible.
</p>
</div>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Programming for Data Science in R</strong>" was written by Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD. It was last built on 2021-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
