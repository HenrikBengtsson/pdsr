# Factors

Factors are used to store categorical data and they have many important uses in statistics and data science.


```{block, type="Note"}
Factors in R are integer vectors with values from 1 to the total number of levels, where each integer has a label.
```

You can create a factor by passing a vector to `factor()` or `as.factor()`:

```{r}
x <- c("a", "c", "d", "b", "a", "a", "d", "c")
xf <- factor(x)
xf
xftoo <- as.factor(x)
xftoo
```

The difference is that `as.factor()` does not accept any arguments


You can get the levels of a factor using `levels()`:

```{r}
levels(x)
```

```{block, type="Note"}
In R, a factor is stored as vector of integers indexing a set of levels.
```

`str` on a factor outputs:

* the number of levels
* the levels, in order
* the vector as an integer index of the levels

```{r}
str(x)
```

## Defining the levels of a factor

When you create a factor with `factor()`, you can use the `levels` argument to define the order of levels.  

If you do not use the `levels` argument, the levels will default to the unique values of the input vector sorted alphabetically.

The vector passed to the `levels` arguments must include all unique values passed to `factor()`, otherwise you will get `NA` values

```{r}
(x <- factor(c("alpha", "alpha", "beta", "delta", "delta")))
table(x)
(x <- factor(c("alpha", "alpha", "beta", "delta", "delta"),
            levels = c("alpha", "beta", "gamma", "delta")))
class(x)
table(x)
```

```{r}
levels(x)
```

To change the ***order of the levels***, without changing the actual values in the vector (the data itself):

```{r}
xr <- factor(as.character(x), levels = c("delta", "gamma", "beta", "alpha"))
xr
```

```{block, type="Warning"}
Be very careful: Setting new levels with `levels()` ***changes levels and all vector values***
```

```{r}
xe <- x
levels(xe) <- c("a", "b", "c", "d")
xe
```

## Ordered factors

The order of a factor's levels affects their internal integer representation.

This, in turn, affects their order in some application - like plotting categorical variables in ggplot2, or defining which outcome is the 'positive' case in classification in some ML packages.  

An **ordered factor** is a separate concept, where you are defining that there is a meaningful order, usually quantitative, to the levels - like "low < mid < high", or "grade 1 < grade 2 < grade 3 < grade 4".

```{r}
x <- factor(c("low", "low", "high", "low", "mid", 
              "mid", "high", "low", "high", "mid"),
            levels = c("low", "mid", "high"),
            ordered = TRUE)
x
class(x)
```

## Integer coercion

Factors can be converted to integers which denote which level each element represents.

```{r}
x <- factor(c("mango", "tangerine", "banana", "mango", "banana"),
            levels = c("mango", "banana", "tangerine"))
class(x)
typeof(x)
is.numeric(x)
is.factor(x)
as.numeric(x)
as.integer(x)
as.double(x)
as.character(x)
```