<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>26 Base Graphics | Programming for Data Science in R</title>

    <meta name="author" content="Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD" />
  
   <meta name="description" content="26 Base Graphics | Programming for Data Science in R is a project to build an online resource for (Bio)statisticians / Epidemiologists / (Health) Data Scientists" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="26 Base Graphics | Programming for Data Science in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="26 Base Graphics | Programming for Data Science in R is a project to build an online resource for (Bio)statisticians / Epidemiologists / (Health) Data Scientists" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="26 Base Graphics | Programming for Data Science in R" />
  
  <meta name="twitter:description" content="26 Base Graphics | Programming for Data Science in R is a project to build an online resource for (Bio)statisticians / Epidemiologists / (Health) Data Scientists" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.3.1/transition.js"></script>
    <script src="libs/bs3compat-0.3.1/tabs.js"></script>
    <script src="libs/bs3compat-0.3.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
    <script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
    <script src="libs/d3-3.5.6/d3.min.js"></script>
    <link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
    <script src="libs/profvis-0.3.6.9000/profvis.js"></script>
    <script src="libs/profvis-0.3.6.9000/scroll.js"></script>
    <link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
    <script src="libs/highlight-6.2.0/highlight.js"></script>
    <script src="libs/profvis-binding-0.3.7/profvis.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163213745-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-163213745-1');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="bootstrap.lambdamd.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Programming for Data Science in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="basegraphics" class="section level1" number="26">
<h1><span class="header-section-number">26</span> Base Graphics</h1>
<STYLE type='text/css' scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</STYLE>
<p>R has powerful graphical capabilities built in to the core language. This chapter is an introduction to what is known as base graphics which is provided by the <strong>graphics</strong> built-in package. Their defaults produce minimalist plots, but they can be customized extensively. In this chapter we shall begin with default plots and demonstrate some of the more common/useful ways to customize them.</p>
<table>
<thead>
<tr class="header">
<th align="right">Plot type</th>
<th align="left">Command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Scatterplot</td>
<td align="left"><code>plot(x, y)</code></td>
</tr>
<tr class="even">
<td align="right">Line plot</td>
<td align="left"><code>plot(x, y, type = 'l')</code></td>
</tr>
<tr class="odd">
<td align="right">Histogram</td>
<td align="left"><code>hist(x)</code></td>
</tr>
<tr class="even">
<td align="right">Density plot</td>
<td align="left"><code>plot(density(x))</code></td>
</tr>
<tr class="odd">
<td align="right">Barplot</td>
<td align="left"><code>barplot(x)</code></td>
</tr>
<tr class="even">
<td align="right">Boxplot</td>
<td align="left"><code>boxplot(x)</code></td>
</tr>
<tr class="odd">
<td align="right">Heatmap</td>
<td align="left"><code>heatmap(x)</code></td>
</tr>
<tr class="even">
<td align="right">Mosaic plot</td>
<td align="left"><code>mosaicplot(table(x))</code></td>
</tr>
</tbody>
</table>
<p>R documentation for each of the above commands provides extensive coverage of graphical parameters. <code>?par</code> gives the main documentation file for a long list of graphical parameters. These can be set either with the <code>par()</code> command before using any plotting command.</p>
<p>Let’s create some synthetic data:</p>
<div class="sourceCode" id="cb1700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1700-1"><a href="basegraphics.html#cb1700-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb1700-2"><a href="basegraphics.html#cb1700-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">300</span>)</span>
<span id="cb1700-3"><a href="basegraphics.html#cb1700-3" aria-hidden="true" tabindex="-1"></a>y_true <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb1700-4"><a href="basegraphics.html#cb1700-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">300</span>)<span class="sc">*</span><span class="fl">1.5</span></span></code></pre></div>
<div id="scatter-plot" class="section level2" number="26.1">
<h2><span class="header-section-number">26.1</span> Scatter plot</h2>
<p>Input: 2 <strong>numeric vectors</strong></p>
<p>A 2D scatterplot displays points using two numeric vectors as X and Y coordinates.</p>
<div class="sourceCode" id="cb1701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1701-1"><a href="basegraphics.html#cb1701-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-4-1.png" width="480" /></p>
<div id="col-point-color" class="section level3" number="26.1.1">
<h3><span class="header-section-number">26.1.1</span> <strong><code>col</code></strong>: point color</h3>
<p>See <a href="colors.html#colors">Colors in R</a> to learn about the different ways to define colors in R.</p>
<p>Some common ways include:</p>
<ul>
<li>By name using one of 657 names given by <code>colors()</code>, e.g. “red”, “magenta”, “blue”, “navy”, “cyan”</li>
<li>By RGB code</li>
</ul>
<div class="sourceCode" id="cb1702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1702-1"><a href="basegraphics.html#cb1702-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-5-1.png" width="480" /></p>
</div>
<div id="bty-box-type" class="section level3" number="26.1.2">
<h3><span class="header-section-number">26.1.2</span> <strong><code>bty</code></strong>: box type</h3>
<p>There are 7 bty options: “o” “l”, “7”, “c”, “u”, or “]” and “none”.
They produce a box that resembles the corresponding symbol.
“none” draws no box but allows the axes to show:</p>
<div class="sourceCode" id="cb1703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1703-1"><a href="basegraphics.html#cb1703-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">bty =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-6-1.png" width="480" /></p>
<div class="sourceCode" id="cb1704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1704-1"><a href="basegraphics.html#cb1704-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">bty =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-7-1.png" width="480" /></p>
</div>
<div id="pch-point-character" class="section level3" number="26.1.3">
<h3><span class="header-section-number">26.1.3</span> <strong><code>pch</code></strong>: point character</h3>
<p>The default point character is a circle as seen above. This helps visualize overlapping points (especially for devices that do not support transparency).</p>
<p>There are 25 point characters, designated by integers 1 through 25.</p>
<p>Here’s a preview of all 25 <code>pch</code> options.
<code>pch</code> types 21 through 25 can be filled by a color specified by <code>bg</code>.</p>
<div class="sourceCode" id="cb1705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1705-1"><a href="basegraphics.html#cb1705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">25</span>), <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">bg =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-8-1.png" width="480" /></p>
<p>Let’s use a solid disc:</p>
<div class="sourceCode" id="cb1706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1706-1"><a href="basegraphics.html#cb1706-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-9-1.png" width="480" /></p>
<p>We cannot tell how many points are overlapping in the middle and therefore it’s a good idea to make the points a little transparent.</p>
<p>There are different ways to add transparency (see <a href="colors.html#colors">Colors</a>). The easiest way is probably to use <code>adjustcolor()</code>. In the context of colors, <code>alpha</code> refers to transparency: <code>a = 1</code> is opaque and <code>a = 0</code> is completely transparent (therefore use a value greater than 0).</p>
<div class="sourceCode" id="cb1707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1707-1"><a href="basegraphics.html#cb1707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y,</span>
<span id="cb1707-2"><a href="basegraphics.html#cb1707-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb1707-3"><a href="basegraphics.html#cb1707-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="at">alpha.f =</span> .<span class="dv">5</span>))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-10-1.png" width="480" /></p>
</div>
<div id="grid" class="section level3" number="26.1.4">
<h3><span class="header-section-number">26.1.4</span> grid</h3>
<p>We can add a grid behind the plot area using the <code>panel.first</code> argument, which accepts a graphical expression (a function that draws something), which will be evaluated before plotting the points on the graph (therefore appears behind the points).</p>
<div class="sourceCode" id="cb1708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1708-1"><a href="basegraphics.html#cb1708-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y,</span>
<span id="cb1708-2"><a href="basegraphics.html#cb1708-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb1708-3"><a href="basegraphics.html#cb1708-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="at">alpha.f =</span> .<span class="dv">5</span>),</span>
<span id="cb1708-4"><a href="basegraphics.html#cb1708-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&#39;gray90&#39;</span>))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-11-1.png" width="480" /></p>
</div>
<div id="main-xlab-ylab-title-and-axes-labels" class="section level3" number="26.1.5">
<h3><span class="header-section-number">26.1.5</span> <strong><code>main</code></strong>, <strong><code>xlab</code></strong>, <strong><code>ylab</code></strong>: Title and axes labels</h3>
<div class="sourceCode" id="cb1709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1709-1"><a href="basegraphics.html#cb1709-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y,</span>
<span id="cb1709-2"><a href="basegraphics.html#cb1709-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb1709-3"><a href="basegraphics.html#cb1709-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="at">alpha.f =</span> .<span class="dv">5</span>),</span>
<span id="cb1709-4"><a href="basegraphics.html#cb1709-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&#39;gray90&#39;</span>),</span>
<span id="cb1709-5"><a href="basegraphics.html#cb1709-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;y vs. x&quot;</span>,</span>
<span id="cb1709-6"><a href="basegraphics.html#cb1709-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Variable x (xunits)&quot;</span>,</span>
<span id="cb1709-7"><a href="basegraphics.html#cb1709-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Variable y (yunits)&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-12-1.png" width="480" /></p>
<p>Note that depending on where you intend to display the plot, you may leave the title blank and instead place it in the figure caption along with an explanation of the data (e.g. in a journal article)</p>
</div>
</div>
<div id="histogram" class="section level2" number="26.2">
<h2><span class="header-section-number">26.2</span> Histogram</h2>
<p>Input: <strong>numeric vector</strong></p>
<p>A histogram displays an approximation of the distribution of a numeric vector. First the data is binned and then the number of elements that falls in each bin is counted. The histogram plot draws bars for each bin whose heights corresponds to the count of elements in the corresponding interval.</p>
<div class="sourceCode" id="cb1710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1710-1"><a href="basegraphics.html#cb1710-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-13-1.png" width="480" /></p>
<div id="col-bar-color" class="section level3" number="26.2.1">
<h3><span class="header-section-number">26.2.1</span> <strong><code>col</code></strong>: bar color</h3>
<div class="sourceCode" id="cb1711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1711-1"><a href="basegraphics.html#cb1711-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">col =</span> <span class="st">&quot;slategrey&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-14-1.png" width="480" /></p>
</div>
<div id="border-border-color" class="section level3" number="26.2.2">
<h3><span class="header-section-number">26.2.2</span> <strong><code>border</code></strong>: border color</h3>
<p>Setting border color to the same as the background gives a clean look:</p>
<div class="sourceCode" id="cb1712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1712-1"><a href="basegraphics.html#cb1712-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">col =</span> <span class="st">&quot;slategrey&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-15-1.png" width="480" /></p>
</div>
<div id="breaks-number-or-value-of-breakpoints" class="section level3" number="26.2.3">
<h3><span class="header-section-number">26.2.3</span> <code>breaks</code>: number or value of breakpoints</h3>
<p>The <code>breaks</code> argument can be used to define the breakpoints to use for the binning of the values of the input to <code>hist()</code>. See the documentation in <code>?hist</code> for the full range of options. An easy way to control the number of bins is to pass an integer to the <code>breaks</code> argument. Depending on the length of x and its distribution, it may or may not be possible to use the exact number requested, but the closest possible number will be automatically chosen.</p>
<div class="sourceCode" id="cb1713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1713-1"><a href="basegraphics.html#cb1713-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">col =</span> <span class="st">&quot;slategrey&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb1713-2"><a href="basegraphics.html#cb1713-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-16-1.png" width="480" /></p>
</div>
</div>
<div id="density-plot" class="section level2" number="26.3">
<h2><span class="header-section-number">26.3</span> Density plot</h2>
<p>Input: numeric vector</p>
<p>A density plot is a different way to display an approximation of the distribution of a numeric vector. The <code>density()</code> function estimates the density of x and can be passed to <code>plot()</code> directly:</p>
<div class="sourceCode" id="cb1714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1714-1"><a href="basegraphics.html#cb1714-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-17-1.png" width="480" /></p>
<p>You can use <code>main = NA</code> or <code>main = ""</code> to suppress printing a title.</p>
<div class="sourceCode" id="cb1715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1715-1"><a href="basegraphics.html#cb1715-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb1715-2"><a href="basegraphics.html#cb1715-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb1715-3"><a href="basegraphics.html#cb1715-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-18-1.png" width="480" /></p>
</div>
<div id="barplot" class="section level2" number="26.4">
<h2><span class="header-section-number">26.4</span> Barplot</h2>
<p>Input: <strong>vector</strong> or <strong>matrix</strong></p>
<p>Let’s look at the VADeaths built-in dataset which describes death rater per 1000 population per year broken down by age range and population group.</p>
<div id="single-vector" class="section level3" number="26.4.1">
<h3><span class="header-section-number">26.4.1</span> Single vector</h3>
<p>We can plot a single column or row. Note how R automatically gets the corresponding dimension names. For this example we use the builtin VADeaths dataset, which is a matrix.</p>
<div class="sourceCode" id="cb1716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1716-1"><a href="basegraphics.html#cb1716-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(VADeaths[, <span class="dv">1</span>])</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-19-1.png" width="576" /></p>
<div class="sourceCode" id="cb1717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1717-1"><a href="basegraphics.html#cb1717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(VADeaths[<span class="dv">1</span>, ])</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-20-1.png" width="576" /></p>
<div id="col-and-border-bar-fill-and-border-color" class="section level4" number="26.4.1.1">
<h4><span class="header-section-number">26.4.1.1</span> <strong><code>col</code></strong> and <strong><code>border</code></strong>: bar fill and border color</h4>
<p>As in most plotting functions, color is controlled by the <strong><code>col</code></strong> argument. <strong><code>border</code></strong> can be set to any color separately, or to <code>NA</code> to omit, which gives a clean look:</p>
<div class="sourceCode" id="cb1718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1718-1"><a href="basegraphics.html#cb1718-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(VADeaths[, <span class="dv">1</span>],</span>
<span id="cb1718-2"><a href="basegraphics.html#cb1718-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;aquamarine3&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-21-1.png" width="576" /></p>
</div>
</div>
<div id="matrix" class="section level3" number="26.4.2">
<h3><span class="header-section-number">26.4.2</span> Matrix</h3>
<p>We can draw barplots of multiple columns at the same time by passing a matrix input. The grouping on the x-axis is based on the columns. By default, data from different rows is stacked. The argument <code>legend.text</code> can be used to add a legend with the row labels:</p>
<div class="sourceCode" id="cb1719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1719-1"><a href="basegraphics.html#cb1719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(VADeaths, <span class="at">legend.text =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Alternatively, we can draw groups of bars beside each other with the argument <code>beside = TRUE</code>:</p>
<div class="sourceCode" id="cb1720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1720-1"><a href="basegraphics.html#cb1720-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(VADeaths, <span class="at">beside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1720-2"><a href="basegraphics.html#cb1720-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="cn">TRUE</span>, <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;topright&quot;</span>))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>To use custom colors, we pass a vector of length equal to the number of bars within each group. These will get recycled across groups, giving a consistent color coding.<br />
Here, we use the <code>adjustcolor()</code> function again to produce 5 shades of navy.</p>
<div class="sourceCode" id="cb1721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1721-1"><a href="basegraphics.html#cb1721-1" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(.<span class="dv">2</span>, .<span class="dv">8</span>, <span class="at">length.out =</span> <span class="dv">5</span>), <span class="cf">function</span>(i) <span class="fu">adjustcolor</span>(<span class="st">&quot;navy&quot;</span>, i))</span>
<span id="cb1721-2"><a href="basegraphics.html#cb1721-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(VADeaths,</span>
<span id="cb1721-3"><a href="basegraphics.html#cb1721-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> col,</span>
<span id="cb1721-4"><a href="basegraphics.html#cb1721-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb1721-5"><a href="basegraphics.html#cb1721-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1721-6"><a href="basegraphics.html#cb1721-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="cn">TRUE</span>, <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;topright&quot;</span>))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="formula-interface" class="section level3" number="26.4.3">
<h3><span class="header-section-number">26.4.3</span> Formula interface</h3>
</div>
</div>
<div id="boxplot" class="section level2" number="26.5">
<h2><span class="header-section-number">26.5</span> Boxplot</h2>
<p>Input: One or more <strong>vectors</strong> of any length</p>
<p>A boxplot is another way to visualize the distribution of one or more vectors. Each vector does not need to be of the same length. For example if you are plotting lab results of a patient and control group, they do not have to contain the same number of individuals.</p>
<p>There are two ways to use the <code>boxplot()</code> function. Either pass two separate vectors of data (whet)</p>
<p><code>boxplot()</code> makes it easy to plot your data from different objects. It can accept:</p>
<ul>
<li>individual vectors</li>
<li>columns of a matrix, columns/elements of a data.frame, elements of a list</li>
<li>formula interface of the form <code>variable ~ factor</code></li>
</ul>
<div id="single-vector-1" class="section level3" number="26.5.1">
<h3><span class="header-section-number">26.5.1</span> Single vector</h3>
<div class="sourceCode" id="cb1722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1722-1"><a href="basegraphics.html#cb1722-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="at">mean =</span> <span class="dv">12</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb1722-2"><a href="basegraphics.html#cb1722-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(a)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-25-1.png" width="480" /></p>
</div>
<div id="anatomy-of-a-boxplot" class="section level3" number="26.5.2">
<h3><span class="header-section-number">26.5.2</span> Anatomy of a boxplot</h3>
<p>A boxplot shows:</p>
<ul>
<li>the median</li>
<li>first and third quartiles</li>
<li>outliers (defined as <code>x &lt; Q1 - 1.5 * IQR | x &gt; Q3 + 1.5 * IQR</code>)</li>
<li>range after excluding outliers</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:boxanat"></span>
<img src="79-BaseGraphics_files/figure-html/boxanat-1.png" alt="Boxplot anatomy" width="480" />
<p class="caption">
Figure 26.1: Boxplot anatomy
</p>
</div>
<p>Some synthetic data:</p>
<div class="sourceCode" id="cb1723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1723-1"><a href="basegraphics.html#cb1723-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1723-2"><a href="basegraphics.html#cb1723-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1723-3"><a href="basegraphics.html#cb1723-3" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb1723-4"><a href="basegraphics.html#cb1723-4" aria-hidden="true" tabindex="-1"></a>dl <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, <span class="at">gamma =</span> gamma)</span></code></pre></div>
</div>
<div id="multiple-vectors" class="section level3" number="26.5.3">
<h3><span class="header-section-number">26.5.3</span> Multiple vectors</h3>
<div class="sourceCode" id="cb1724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1724-1"><a href="basegraphics.html#cb1724-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(alpha, beta, gamma)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-27-1.png" width="480" /></p>
</div>
<div id="list" class="section level3" number="26.5.4">
<h3><span class="header-section-number">26.5.4</span> List</h3>
<div class="sourceCode" id="cb1725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1725-1"><a href="basegraphics.html#cb1725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dl)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-28-1.png" width="480" /></p>
</div>
<div id="matrix-1" class="section level3" number="26.5.5">
<h3><span class="header-section-number">26.5.5</span> Matrix</h3>
<p>Passing a matrix to <code>boxplot()</code> draws one boxplot per column:</p>
<div class="sourceCode" id="cb1726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1726-1"><a href="basegraphics.html#cb1726-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">5</span>), <span class="cf">function</span>(i) <span class="fu">rnorm</span>(<span class="dv">20</span>))</span>
<span id="cb1726-2"><a href="basegraphics.html#cb1726-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(mat)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-29-1.png" width="480" /></p>
</div>
<div id="formula-interface-1" class="section level3" number="26.5.6">
<h3><span class="header-section-number">26.5.6</span> Formula interface</h3>
<p>The formula interface can be used to group any vector by a factor of the same length.</p>
<p>Let’s use the built-in <code>sleep</code> dataset which shows the effect of two different drugs in increasing hours of sleep compared to a control group.</p>
<div class="sourceCode" id="cb1727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1727-1"><a href="basegraphics.html#cb1727-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(extra <span class="sc">~</span> group, sleep)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-30-1.png" width="480" /></p>
<p>The <strong><code>col</code></strong> and <strong><code>border</code></strong> arguments work as expected. Here we define two custom colors using their hexadecimal RGB code and use the solid version for the border and a 50% transparent version for the fill. Note that we do not need two separate colors to produce an unambiguous plot since they are clearly labeled in the y-axis. It is often considered desirable/preferred to use the minimum number of different colors that is necessary. (Color coding like the following could be useful if for example data from the two groups were used on a different plot, like a scatterplot, in a multi-panel figure).</p>
<div class="sourceCode" id="cb1728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1728-1"><a href="basegraphics.html#cb1728-1" aria-hidden="true" tabindex="-1"></a>border <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#18A3AC&quot;</span>, <span class="st">&quot;#F48024&quot;</span>)</span>
<span id="cb1728-2"><a href="basegraphics.html#cb1728-2" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">adjustcolor</span>(<span class="st">&quot;#18A3AC&quot;</span>, .<span class="dv">5</span>), <span class="fu">adjustcolor</span>(<span class="st">&quot;#F48024&quot;</span>, .<span class="dv">5</span>))</span>
<span id="cb1728-3"><a href="basegraphics.html#cb1728-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(extra <span class="sc">~</span> group, sleep,</span>
<span id="cb1728-4"><a href="basegraphics.html#cb1728-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> col, <span class="at">border =</span> border)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-31-1.png" width="480" /></p>
</div>
<div id="names-group-labels" class="section level3" number="26.5.7">
<h3><span class="header-section-number">26.5.7</span> <strong><code>names</code></strong>: group labels</h3>
<p>The x-axis group names can be defined with the <code>names</code> argument:</p>
<div class="sourceCode" id="cb1729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1729-1"><a href="basegraphics.html#cb1729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(extra <span class="sc">~</span> group, sleep,</span>
<span id="cb1729-2"><a href="basegraphics.html#cb1729-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> col, <span class="at">border =</span> border,</span>
<span id="cb1729-3"><a href="basegraphics.html#cb1729-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Drug A&quot;</span>, <span class="st">&quot;Drug B&quot;</span>))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-32-1.png" width="480" /></p>
</div>
</div>
<div id="heatmap" class="section level2" number="26.6">
<h2><span class="header-section-number">26.6</span> Heatmap</h2>
<p>Input: <strong>matrix</strong></p>
<p>A heatmap is a 2D matrix-like plot with x- and y-axis labels and a value in each cell. It can be used to display many different types of data. A common usage in data science is to plot the correlation matrix of a set of numerical features. In many cases, the rows and/or columns of a heatmap can be reordered based on hierarchical clustering.</p>
<div class="sourceCode" id="cb1730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1730-1"><a href="basegraphics.html#cb1730-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="cf">function</span>(i) <span class="fu">rnorm</span>(<span class="dv">20</span>))</span>
<span id="cb1730-2"><a href="basegraphics.html#cb1730-2" aria-hidden="true" tabindex="-1"></a>x_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(x)</span></code></pre></div>
<p>By default, the <code>heatmap()</code> function draws marginal dendrograms and rearranges rows and columns. We can prevent that by setting <code>Rowv</code> and <code>Colv</code> to <code>NA</code>:</p>
<div class="sourceCode" id="cb1731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1731-1"><a href="basegraphics.html#cb1731-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(x_cor, <span class="at">Rowv =</span> <span class="cn">NA</span>, <span class="at">Colv =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-34-1.png" width="480" /></p>
<p>To allow clustering and row and column reordering, use the defaults:</p>
<div class="sourceCode" id="cb1732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1732-1"><a href="basegraphics.html#cb1732-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(x_cor)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-35-1.png" width="480" /></p>
</div>
<div id="mosaic-plot" class="section level2" number="26.7">
<h2><span class="header-section-number">26.7</span> Mosaic plot</h2>
<p>Mosaic plots are used to visualize contingency tables. They can be informative to look at during data exploration. They are less likely to be included in a research article where the table itself is more likely to be included.</p>
<p>Synthetic data:</p>
<div class="sourceCode" id="cb1733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1733-1"><a href="basegraphics.html#cb1733-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb1733-2"><a href="basegraphics.html#cb1733-2" aria-hidden="true" tabindex="-1"></a>Cohort <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Case&quot;</span>), <span class="dv">500</span>, <span class="cn">TRUE</span>),</span>
<span id="cb1733-3"><a href="basegraphics.html#cb1733-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Case&quot;</span>))</span>
<span id="cb1733-4"><a href="basegraphics.html#cb1733-4" aria-hidden="true" tabindex="-1"></a>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb1733-5"><a href="basegraphics.html#cb1733-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(<span class="fu">seq</span>(Cohort), \(i) <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>), <span class="dv">1</span>,</span>
<span id="cb1733-6"><a href="basegraphics.html#cb1733-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">prob =</span> <span class="cf">if</span> (Cohort[i] <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>) <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>) <span class="cf">else</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))))</span></code></pre></div>
<p>Use <code>mosaicplot()</code> on the output of <code>table()</code>:</p>
<div class="sourceCode" id="cb1734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1734-1"><a href="basegraphics.html#cb1734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(Cohort), <span class="at">main =</span> <span class="st">&quot;Cases vs. Controls&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-37-1.png" width="480" /></p>
<p>We can plot the breakdown of sexes, this time also adding color:</p>
<div class="sourceCode" id="cb1735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1735-1"><a href="basegraphics.html#cb1735-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(Sex), <span class="at">main =</span> <span class="st">&quot;Males vs. Females&quot;</span>,</span>
<span id="cb1735-2"><a href="basegraphics.html#cb1735-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;orchid&quot;</span>, <span class="st">&quot;skyblue&quot;</span>))</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-38-1.png" width="480" /></p>
<p>Cross-tabulating is usually most informatively. We us the same color for the sexes, which will be recycled. We also remove the border for a cleaner look:</p>
<div class="sourceCode" id="cb1736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1736-1"><a href="basegraphics.html#cb1736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(Cohort, Sex),</span>
<span id="cb1736-2"><a href="basegraphics.html#cb1736-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">c</span>(<span class="st">&quot;orchid&quot;</span>, <span class="st">&quot;skyblue&quot;</span>),</span>
<span id="cb1736-3"><a href="basegraphics.html#cb1736-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb1736-4"><a href="basegraphics.html#cb1736-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">&quot;Cohort x Sex&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-39-1.png" width="480" /></p>
</div>
<div id="graphical-parameters" class="section level2" number="26.8">
<h2><span class="header-section-number">26.8</span> Graphical parameters</h2>
<p>The <code>par()</code> function allows setting or querying graphical parameters of the base graphics system. Have a look at its documentation (<code>?par</code>).<br />
Some graphical parameters can only be set with a call to <code>par()</code> prior to using a base plotting function. However, many parameters can also be passed using the <code>...</code> construct of each base plotting function.</p>
<p>Some common base graphical parameters:</p>
<ul>
<li><strong><em>pch</em></strong>: Point character</li>
<li><strong><em>col</em></strong>: Color</li>
<li><strong><em>cex</em></strong>: Character expansion, i.e. relative size</li>
<li><strong><em>bty</em></strong>: Box type</li>
<li><strong><em>xlab</em></strong>: x-axis label</li>
<li><strong><em>ylab</em></strong>: y-axis label</li>
<li><strong><em>main</em></strong>: Main title</li>
<li><strong><em>mar</em></strong>: Plot margins</li>
</ul>
<p>You can see what the current value of these parameters is by calling <code>par()</code> or directly accessing a specific parameter:</p>
<div class="sourceCode" id="cb1737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1737-1"><a href="basegraphics.html#cb1737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>()<span class="sc">$</span>mar</span></code></pre></div>
<pre><code>[1] 5.1 4.1 4.1 2.1</code></pre>
<p><code>mar</code> sets the plot margins. It is a vector of length 4 and each number corresponds to the bottom-left-top-right margin, in that order. Use it to reduce empty white space between plots or add space if labels are getting cropped, for example.</p>
<p>Always make sure that your plotting characters, axis labels and titles are legible. You must avoid, at all costs, ever using a huge graph with tiny letters spread over an entire slide in a presentation.</p>
<ul>
<li><strong><em>cex</em></strong>: Character expansion for the plotting characters</li>
<li><strong><em>cex.axis</em></strong>: cex for axis annotation</li>
<li><strong><em>cex.lab</em></strong>: cex for x and y labels</li>
<li><strong><em>cex.main</em></strong>: cex for main title</li>
</ul>
<p>Note: All of these can be set either with a call to <code>par()</code> prior to plotting or passed as arguments in a plotting command, like <code>plot()</code>.</p>
<p>There is one important distinction: <code>cex</code> set with <code>par()</code> (which defaults to 1), sets the baseline and all other <code>cex</code> parameters multiply it. However, <code>cex</code> set within <code>plot()</code> still multiplies <code>cex</code> set with <code>par()</code>, but only affects the plotting character size.</p>
<div id="save-and-reload-graphical-parameters" class="section level3" number="26.8.1">
<h3><span class="header-section-number">26.8.1</span> Save and reload graphical parameters</h3>
<p>You can make a copy of all current graphical parameters:</p>
<div class="sourceCode" id="cb1739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1739-1"><a href="basegraphics.html#cb1739-1" aria-hidden="true" tabindex="-1"></a>par_default <span class="ot">&lt;-</span> <span class="fu">par</span>()</span></code></pre></div>
<p>There are a few parameters that you cannot control, those are read-only. You can optionally exclude those since you cannot edit them anyway:</p>
<div class="sourceCode" id="cb1740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1740-1"><a href="basegraphics.html#cb1740-1" aria-hidden="true" tabindex="-1"></a>par_default <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> T)</span></code></pre></div>
<p>If you make changes to <code>par()</code> to produce plots and you want to recover the parameters you saved above, you can use reload them by passing them to <code>par()</code>:</p>
<div class="sourceCode" id="cb1741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1741-1"><a href="basegraphics.html#cb1741-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(par_default)</span></code></pre></div>
<p>Alternatively, you can always restart the graphics device using <code>dev.off()</code> and then making a new plot.</p>
<p>Note: here “device” does not refere to a physical device but software graphics interfaces that show a plot to screen or <a href="basegraphics.html#saveplots">save to file</a>.</p>
<div class="sourceCode" id="cb1742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1742-1"><a href="basegraphics.html#cb1742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co"># shuts down graphics device</span></span></code></pre></div>
<pre><code>null device 
          1 </code></pre>
<div class="sourceCode" id="cb1744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1744-1"><a href="basegraphics.html#cb1744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>))</span></code></pre></div>
</div>
</div>
<div id="multipanel-plots" class="section level2" number="26.9">
<h2><span class="header-section-number">26.9</span> Multipanel plots</h2>
<p>There are different ways to create multipanel plots, but probably the most straightforward is to use either the <code>mfrow</code> or the <code>mfcol</code> argument of <code>par()</code>.</p>
<div class="sourceCode" id="cb1745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1745-1"><a href="basegraphics.html#cb1745-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb1745-2"><a href="basegraphics.html#cb1745-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">500</span>)</span>
<span id="cb1745-3"><a href="basegraphics.html#cb1745-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">500</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb1745-4"><a href="basegraphics.html#cb1745-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">500</span>)</span></code></pre></div>
<p>Both <code>mfrow</code> and <code>mfcol</code> accept an integer vector of length 2 indicating number of rows and number of columns, respectively. With <code>mfrow</code>, the plots are drawn row-wise and with <code>mfcol</code> they are drawn column-wise. Remember to reset <code>mfrow</code> or <code>mfcol</code> back to <code>c(1, 1)</code></p>
<p>For example, let’s plot a 2-by-3 panel of plots, drawn row-wise:</p>
<div class="sourceCode" id="cb1746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1746-1"><a href="basegraphics.html#cb1746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1746-2"><a href="basegraphics.html#cb1746-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">col =</span> <span class="st">&quot;#052049bb&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1746-3"><a href="basegraphics.html#cb1746-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">col =</span> <span class="st">&quot;#052049bb&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1746-4"><a href="basegraphics.html#cb1746-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">col =</span> <span class="st">&quot;#052049bb&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1746-5"><a href="basegraphics.html#cb1746-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col =</span> <span class="st">&quot;#05204955&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1746-6"><a href="basegraphics.html#cb1746-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, z, <span class="at">col =</span> <span class="st">&quot;#05204955&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1746-7"><a href="basegraphics.html#cb1746-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, z, <span class="at">col =</span> <span class="st">&quot;#05204955&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="79-BaseGraphics_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb1747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1747-1"><a href="basegraphics.html#cb1747-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="saveplots" class="section level2" number="26.10">
<h2><span class="header-section-number">26.10</span> Saving plots to file</h2>
<p>You can save base graphics to disk using a number of different file formats. To do this, you have to:</p>
<ul>
<li>Open a graphics device - e.g. <code>pdf("path/to/xy_scatter.pdf")</code></li>
<li>Write to it - e.g. <code>plot(x, y)</code></li>
<li>Close graphics device - <code>dev.off()</code></li>
</ul>
<p>The following commands are used to open graphical devices that will save to a file of the corresponding type:</p>
<ul>
<li><code>bmp(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>jpeg(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>png(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>tiff(filename = "path/to/file", width = [in pixels], height = [in pixels])</code></li>
<li><code>svg(filename = "path/to/file", width = [in inches], height = [in inches]</code></li>
<li><code>pdf(file = "path/to/file", width = [in inches], height = [in inches])</code></li>
</ul>
<p>Notice that when writing to a vector graphics format (svg and pdf), you defined width and height in inches, not pixels. Also, you specify <code>file</code> instead of <code>filename</code> in
Notice the difference when writing to PDF: you define a <code>file</code> instead of a <code>filename</code>, and width and height are in <strong><em>inches</em></strong>, not pixels.<br />
It is recommended to save plots in PDF format because it handles vector graphics therefore plots will scale, and it is easy to export to other graphics formats later on if needed.</p>
<div class="sourceCode" id="cb1748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1748-1"><a href="basegraphics.html#cb1748-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;~/Desktop/plot.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb1748-2"><a href="basegraphics.html#cb1748-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb1748-3"><a href="basegraphics.html#cb1748-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb1748-4"><a href="basegraphics.html#cb1748-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#18A3AC66&quot;</span>,</span>
<span id="cb1748-5"><a href="basegraphics.html#cb1748-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.8</span>,</span>
<span id="cb1748-6"><a href="basegraphics.html#cb1748-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="co"># also try &quot;l&quot;</span></span>
<span id="cb1748-7"><a href="basegraphics.html#cb1748-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Sepal Length&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Petal Length&quot;</span>)</span>
<span id="cb1748-8"><a href="basegraphics.html#cb1748-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Programming for Data Science in R</strong>" was written by Efstathios (Stathis) D. Gennatas, MBBS AICSM PhD. It was last built on 2021-11-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
